# Log analysis 

This log is generated when installing janssen with test data load.

------------------------------------------------------------


### Check if required third party pacakges are installed on Ubuntu

```

11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' apache2 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package apache2 was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' curl 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package curl was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' wget 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package wget was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' xz-utils 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package xz-utils was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' unzip 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package unzip was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' rsyslog 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package rsyslog was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' python3-ldap3 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package python3-ldap3 was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' net-tools 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package net-tools was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' python3-requests 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package python3-requests was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' python3-ruamel.yaml 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package python3-ruamel.yaml was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' python3-certifi 2>/dev/null | grep -c "ok installed"
11:33:47 06/21/21 1

11:33:47 06/21/21 Package python3-certifi was installed
11:33:47 06/21/21 Running: dpkg-query -W -f='${Status}' python3-pymysql 2>/dev/null | grep -c "ok installed"
11:33:48 06/21/21 1

11:33:48 06/21/21 Package python3-pymysql was installed
11:33:48 06/21/21 Running: dpkg-query -W -f='${Status}' bzip2 2>/dev/null | grep -c "ok installed"
11:33:48 06/21/21 1

11:33:48 06/21/21 Package bzip2 was installed
11:33:48 06/21/21 Running: a2enmod ssl headers proxy proxy_http proxy_ajp
11:33:48 06/21/21 Considering dependency setenvif for ssl:
Module setenvif already enabled
Considering dependency mime for ssl:
Module mime already enabled
Considering dependency socache_shmcb for ssl:
Module socache_shmcb already enabled
Module ssl already enabled
Module headers already enabled
Module proxy already enabled
Considering dependency proxy for proxy_http:
Module proxy already enabled
Module proxy_http already enabled
Considering dependency proxy for proxy_ajp:
Module proxy already enabled
Module proxy_ajp already enabled

```

11:33:48 06/21/21 Loading json file: /opt/jans/jans-setup/schema/opendj_types.json
11:33:48 06/21/21 Loading json file: /opt/jans/jans-setup/schema/jans_schema.json
11:33:49 06/21/21 Loading json file: /opt/jans/jans-setup/setup_app/data/jetty_app_configuration.json
11:33:49 06/21/21 Determining package for pattern: /opt/dist/jans/oxd-server*.tgz
11:33:49 06/21/21 Determining key generator path
11:33:49 06/21/21 Key generator path was determined as io.jans.as.client.util.KeyExporter
11:33:49 06/21/21 Running: apache2 -v | egrep '^Server version'
11:33:49 06/21/21 Server version: Apache/2.4.41 (Ubuntu)

11:34:39 06/21/21 Checking properties
11:34:39 06/21/21 Running: apache2 -v | egrep '^Server version'
11:34:39 06/21/21 Server version: Apache/2.4.41 (Ubuntu)

11:34:45 06/21/21 Calculating memory setting for applications
11:34:45 06/21/21 Rendering template /opt/jans/jans-setup/templates/system_profile_systemd
11:34:45 06/21/21 Reading file /opt/jans/jans-setup/templates/system_profile_systemd
11:34:45 06/21/21 Writing file /opt/jans/jans-setup/output/system_profile_systemd
11:34:45 06/21/21 Reading file /opt/jans/jans-setup/output/system_profile_systemd
11:34:45 06/21/21 Reading file /etc/profile
11:34:45 06/21/21 Running: /usr/sbin/groupadd jans
11:34:45 06/21/21 Running: /bin/mkdir -p /opt/jans/bin
11:34:45 06/21/21 Running: /bin/mkdir -p /opt/jans/system
11:34:45 06/21/21 Running: /bin/mkdir -p /opt/jans/python
11:34:45 06/21/21 Running: /bin/mkdir -p /etc/jans/conf
11:34:45 06/21/21 Running: /bin/mkdir -p /etc/certs
11:34:45 06/21/21 Running: /bin/chown -R root:jans /etc/certs
11:34:45 06/21/21 Running: /bin/chmod 551 /etc/certs
11:34:45 06/21/21 Running: /bin/chmod ga+w /tmp
11:34:45 06/21/21 Making salt
11:34:45 06/21/21 Writing file /etc/jans/conf/salt
11:34:45 06/21/21 Installing Jre
11:34:45 06/21/21 Installing server JRE amazon-corretto-11.0.8.10.1-linux-x64.tar.gz ...
11:34:45 06/21/21 Extracting amazon-corretto-11.0.8.10.1-linux-x64.tar.gz into /opt/
11:34:45 06/21/21 Running: /usr/bin/tar -xzf /opt/dist/app/amazon-corretto-11.0.8.10.1-linux-x64.tar.gz -C /opt/ --no-xattrs --no-same-owner --no-same-permissions
11:34:48 06/21/21 Running: /bin/ln -sf /opt/amazon-corretto-11.0.8.10.1-linux-x64 /opt/jre
11:34:48 06/21/21 Running: /bin/chmod -R 755 /opt/amazon-corretto-11.0.8.10.1-linux-x64/bin/
11:34:48 06/21/21 Running: /bin/chown -R root:root /opt/amazon-corretto-11.0.8.10.1-linux-x64
11:34:48 06/21/21 Running: /bin/chown -h root:root /opt/jre
11:34:48 06/21/21 Running: /bin/mkdir -p /opt/jre/jre
11:34:48 06/21/21 Running: /bin/ln -s /opt/jre/lib /opt/jre/jre/lib
11:34:48 06/21/21 Running: /usr/bin/sed -i /^#crypto.policy=unlimited/s/^#// /opt/jre/conf/security/java.security
11:34:48 06/21/21 Reading file /opt/jre/conf/security/java.security
11:34:48 06/21/21 Writing file /opt/jre/conf/security/java.security
11:34:48 06/21/21 Running: cp -f /opt/jre/conf/security/java.security /opt/jre/conf/security/java.security.jans-1.0.0-1~
11:34:48 06/21/21 Installing Jetty
11:34:48 06/21/21 Running: /usr/sbin/useradd --system --user-group --shell /bin/bash --create-home --home-dir /home/jetty jetty
11:34:48 06/21/21 Running: /usr/sbin/usermod -a -G jans jetty
11:34:48 06/21/21 Running: /bin/mkdir -p /home/jetty/lib
11:34:48 06/21/21 Running: /bin/mkdir -p /opt/jetty-9.4/temp
11:34:48 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jetty-9.4/temp
11:34:48 06/21/21 Extracting /opt/dist/app/jetty-distribution-9.4.31.v20200723.tar.gz into /opt/jetty
11:34:48 06/21/21 Running: tar -xzf /opt/dist/app/jetty-distribution-9.4.31.v20200723.tar.gz -C /opt/jetty-9.4 --no-xattrs --no-same-owner --no-same-permissions
11:34:49 06/21/21 Running: /bin/ln -sf /opt/jetty-9.4/jetty-distribution-9.4.31.v20200723 /opt/jetty
11:34:49 06/21/21 Running: /bin/chmod -R 755 /opt/jetty-9.4/jetty-distribution-9.4.31.v20200723/bin/
11:34:49 06/21/21 Applying changes to jetty files...
11:34:49 06/21/21 Reading file /opt/jetty/etc/webdefault.xml
11:34:49 06/21/21 Writing file /opt/jetty/etc/webdefault.xml.bak
11:34:49 06/21/21 Created backup of jetty file /opt/jetty/etc/webdefault.xml.bak...
11:34:49 06/21/21 Writing file /opt/jetty/etc/webdefault.xml
11:34:49 06/21/21 Running: cp -f /opt/jetty/etc/webdefault.xml /opt/jetty/etc/webdefault.xml.jans-1.0.0-1~
11:34:49 06/21/21 Wrote updated jetty file /opt/jetty/etc/webdefault.xml...
11:34:49 06/21/21 Reading file /opt/jetty/etc/jetty.xml
11:34:49 06/21/21 Writing file /opt/jetty/etc/jetty.xml.bak
11:34:49 06/21/21 Created backup of jetty file /opt/jetty/etc/jetty.xml.bak...
11:34:49 06/21/21 Writing file /opt/jetty/etc/jetty.xml
11:34:49 06/21/21 Running: cp -f /opt/jetty/etc/jetty.xml /opt/jetty/etc/jetty.xml.jans-1.0.0-1~
11:34:49 06/21/21 Wrote updated jetty file /opt/jetty/etc/jetty.xml...
11:34:49 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jetty-9.4/jetty-distribution-9.4.31.v20200723
11:34:49 06/21/21 Running: /bin/chown -h jetty:jetty /opt/jetty
11:34:49 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty
11:34:49 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jetty
11:34:49 06/21/21 Running: /bin/mkdir -p /var/run/jetty
11:34:49 06/21/21 Running: /bin/chmod -R 775 /var/run/jetty
11:34:49 06/21/21 Running: /bin/chgrp -R jetty /var/run/jetty
11:34:49 06/21/21 Running: rm -rf /opt/jetty/bin/jetty.sh
11:34:49 06/21/21 Copying file /opt/jans/jans-setup/static/system/initd/jetty.sh to /opt/jetty/bin/jetty.sh
11:34:49 06/21/21 Copied /opt/jans/jans-setup/static/system/initd/jetty.sh to /opt/jetty/bin/jetty.sh
11:34:49 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jetty/bin/jetty.sh
11:34:49 06/21/21 Running: /bin/chmod -R 755 /opt/jetty/bin/jetty.sh
11:34:49 06/21/21 Installing Jython
11:34:49 06/21/21 Running: rm -rf /opt*-2.7.2
11:34:49 06/21/21 Running: /opt/jre/bin/java -jar /opt/dist/app/jython-installer-2.7.2.jar -v -s -d /opt/jython-2.7.2 -t standard -e ensurepip
11:34:51 06/21/21 system properties dumped to /tmp/System18365246860318276648.properties
reading jar info
using the console installer
Performing silent installation
specification version: '11'
excluding directory META-INF/
excluding directory extlibs/
excluding directory grammar/
excluding directory org/
excluding directory org/apache/
excluding directory org/apache/commons/
excluding directory org/apache/commons/cli/
excluding directory org/python/
excluding directory org/python/util/
excluding directory org/python/util/install/
excluding directory org/python/util/install/driver/
excluding directory src/
excluding directory src/com/
excluding directory src/com/xhaus/
excluding directory src/com/xhaus/modjy/
excluding directory src/com/ziclix/
excluding directory src/com/ziclix/python/
excluding directory src/com/ziclix/python/sql/
excluding directory src/com/ziclix/python/sql/connect/
excluding directory src/com/ziclix/python/sql/handler/
excluding directory src/com/ziclix/python/sql/pipe/
excluding directory src/com/ziclix/python/sql/pipe/csv/
excluding directory src/com/ziclix/python/sql/pipe/db/
excluding directory src/com/ziclix/python/sql/procedure/
excluding directory src/com/ziclix/python/sql/resource/
excluding directory src/com/ziclix/python/sql/util/
excluding directory src/org/
excluding directory src/org/python/
excluding directory src/org/python/antlr/
excluding directory src/org/python/antlr/adapter/
excluding directory src/org/python/antlr/ast/
excluding directory src/org/python/antlr/base/
excluding directory src/org/python/antlr/op/
excluding directory src/org/python/compiler/
excluding directory src/org/python/core/
excluding directory src/org/python/core/adapter/
excluding directory src/org/python/core/buffer/
excluding directory src/org/python/core/finalization/
excluding directory src/org/python/core/io/
excluding directory src/org/python/core/packagecache/
excluding directory src/org/python/core/stringlib/
excluding directory src/org/python/core/util/
excluding directory src/org/python/expose/
excluding directory src/org/python/expose/generate/
excluding directory src/org/python/indexer/
excluding directory src/org/python/indexer/ast/
excluding directory src/org/python/indexer/demos/
excluding directory src/org/python/indexer/types/
excluding directory src/org/python/jsr223/
excluding directory src/org/python/modules/
excluding directory src/org/python/modules/_collections/
excluding directory src/org/python/modules/_csv/
excluding directory src/org/python/modules/_functools/
excluding directory src/org/python/modules/_io/
excluding directory src/org/python/modules/_json/
excluding directory src/org/python/modules/_jythonlib/
excluding directory src/org/python/modules/_locale/
excluding directory src/org/python/modules/_threading/
excluding directory src/org/python/modules/_weakref/
excluding directory src/org/python/modules/bz2/
excluding directory src/org/python/modules/itertools/
excluding directory src/org/python/modules/jffi/
excluding directory src/org/python/modules/posix/
excluding directory src/org/python/modules/random/
excluding directory src/org/python/modules/sre/
excluding directory src/org/python/modules/thread/
excluding directory src/org/python/modules/time/
excluding directory src/org/python/modules/zipimport/
excluding directory src/org/python/util/
excluding directory src/shell/
excluding directory src/templates/
 10 %
 20 %
 30 %
 40 %
 50 %
 60 %
 70 %
 80 %
 90 %
 100 %
 110 %
 120 %
 130 %
 140 %
 150 %
Generating start scripts ...
 100 %
Congratulations! You successfully installed Jython 2.7.2 to directory /opt/jython-2.7.2.

11:34:51 06/21/21 Running: /bin/ln -sf /opt/jython-2.7.2 /opt/jython
11:34:51 06/21/21 Running: /bin/chown -R root:root /opt/jython-2.7.2
11:34:51 06/21/21 Running: /bin/chown -h root:root /opt/jython
11:34:51 06/21/21 Copying script files
11:34:51 06/21/21 Copying file /opt/jans/jans-setup/static/scripts/logmanager.sh to /opt/jans/bin
11:34:51 06/21/21 Copied /opt/jans/jans-setup/static/scripts/logmanager.sh to /opt/jans/bin
11:34:51 06/21/21 Copying file /opt/jans/jans-setup/static/scripts/testBind.py to /opt/jans/bin
11:34:51 06/21/21 Copied /opt/jans/jans-setup/static/scripts/testBind.py to /opt/jans/bin
11:34:51 06/21/21 Rendering encode.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/encode.py
11:34:51 06/21/21 Writing file /opt/jans/bin/encode.py
11:34:51 06/21/21 Running: cp -f /opt/jans/jans-setup/static/scripts/super_gluu_license_renewer.py /etc/cron.daily/super_gluu_lisence_renewer
11:34:51 06/21/21 Running: /bin/chown root:root /etc/cron.daily/super_gluu_lisence_renewer
11:34:51 06/21/21 Running: /bin/chmod +x /etc/cron.daily/super_gluu_lisence_renewer
11:34:51 06/21/21 Running: cp -f /opt/jans/jans-setup/setup_app/utils/printVersion.py /opt/jans/bin
11:34:51 06/21/21 Running: /bin/ln -s printVersion.py show_version.py
11:34:51 06/21/21 Running: /bin/chmod 700 /opt/jans/bin/show_version.py
11:34:51 06/21/21 Running: /bin/chmod 700 /opt/jans/bin/encode.py
11:34:51 06/21/21 Running: /bin/chmod 700 /opt/jans/bin/logmanager.sh
11:34:51 06/21/21 Running: /bin/chmod 700 /opt/jans/bin/testBind.py
11:34:51 06/21/21 Running: /bin/chmod 700 /opt/jans/bin/printVersion.py
11:34:51 06/21/21 Encoding passwords
11:34:51 06/21/21 Preparing scripts
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/application_session/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/application_session/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type application_session into application_session_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/scim/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/scim/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type scim into scim_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/resource_owner_password_credentials/resource_owner_password_credentials.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/resource_owner_password_credentials/resource_owner_password_credentials.py
11:34:51 06/21/21 Loaded script resource_owner_password_credentials.py with type resource_owner_password_credentials into resource_owner_password_credentials_resource_owner_password_credentials
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/resource_owner_password_credentials/resource_owner_password_credentials_custom_params.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/resource_owner_password_credentials/resource_owner_password_credentials_custom_params.py
11:34:51 06/21/21 Loaded script resource_owner_password_credentials_custom_params.py with type resource_owner_password_credentials into resource_owner_password_credentials_resource_owner_password_credentials_custom_params
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/uma_claims_gathering/uma_claims_gathering.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/uma_claims_gathering/uma_claims_gathering.py
11:34:51 06/21/21 Loaded script uma_claims_gathering.py with type uma_claims_gathering into uma_claims_gathering_uma_claims_gathering
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/cache_refresh/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/cache_refresh/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type cache_refresh into cache_refresh_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/ciba/end_user_notification.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/ciba/end_user_notification.py
11:34:51 06/21/21 Loaded script end_user_notification.py with type ciba into ciba_end_user_notification
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/update_token/sample_script.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/update_token/sample_script.py
11:34:51 06/21/21 Loaded script sample_script.py with type update_token into update_token_sample_script
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/spontaneous_scope/spontaneous_scope.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/spontaneous_scope/spontaneous_scope.py
11:34:51 06/21/21 Loaded script spontaneous_scope.py with type spontaneous_scope into spontaneous_scope_spontaneous_scope
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/update_user/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/update_user/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type update_user into update_user_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/post_authn/post_authn.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/post_authn/post_authn.py
11:34:51 06/21/21 Loaded script post_authn.py with type post_authn into post_authn_post_authn
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/dynamic_scope/work_phone.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/dynamic_scope/work_phone.py
11:34:51 06/21/21 Loaded script work_phone.py with type dynamic_scope into dynamic_scope_work_phone
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/dynamic_scope/session_parameter.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/dynamic_scope/session_parameter.py
11:34:51 06/21/21 Loaded script session_parameter.py with type dynamic_scope into dynamic_scope_session_parameter
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/dynamic_scope/org_name.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/dynamic_scope/org_name.py
11:34:51 06/21/21 Loaded script org_name.py with type dynamic_scope into dynamic_scope_org_name
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/dynamic_scope/memberof_attribute.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/dynamic_scope/memberof_attribute.py
11:34:51 06/21/21 Loaded script memberof_attribute.py with type dynamic_scope into dynamic_scope_memberof_attribute
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/dynamic_scope/dynamic_permission.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/dynamic_scope/dynamic_permission.py
11:34:51 06/21/21 Loaded script dynamic_permission.py with type dynamic_scope into dynamic_scope_dynamic_permission
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/introspection/introspection_custom_params.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/introspection/introspection_custom_params.py
11:34:51 06/21/21 Loaded script introspection_custom_params.py with type introspection into introspection_introspection_custom_params
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/introspection/introspection.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/introspection/introspection.py
11:34:51 06/21/21 Loaded script introspection.py with type introspection into introspection_introspection
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/uma_rpt_policy/uma_rpt_policy.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/uma_rpt_policy/uma_rpt_policy.py
11:34:51 06/21/21 Loaded script uma_rpt_policy.py with type uma_rpt_policy into uma_rpt_policy_uma_rpt_policy
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/uma_rpt_policy/UmaClientAuthzRptPolicy.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/uma_rpt_policy/UmaClientAuthzRptPolicy.py
11:34:51 06/21/21 Loaded script UmaClientAuthzRptPolicy.py with type uma_rpt_policy into uma_rpt_policy_umaclientauthzrptpolicy
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/client_registration/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/client_registration/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type client_registration into client_registration_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/client_registration/Casa.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/client_registration/Casa.py
11:34:51 06/21/21 Loaded script Casa.py with type client_registration into client_registration_casa
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/revoke_token/revoke_token.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/revoke_token/revoke_token.py
11:34:51 06/21/21 Loaded script revoke_token.py with type revoke_token into revoke_token_revoke_token
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/uma_rpt_claims/uma_rpt_claims.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/uma_rpt_claims/uma_rpt_claims.py
11:34:51 06/21/21 Loaded script uma_rpt_claims.py with type uma_rpt_claims into uma_rpt_claims_uma_rpt_claims
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/idp/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/idp/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type idp into idp_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/user_registration/ConfirmRegistrationSampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/user_registration/ConfirmRegistrationSampleScript.py
11:34:51 06/21/21 Loaded script ConfirmRegistrationSampleScript.py with type user_registration into user_registration_confirmregistrationsamplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/user_registration/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/user_registration/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type user_registration into user_registration_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/consent_gathering/ConsentGatheringSample.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/consent_gathering/ConsentGatheringSample.py
11:34:51 06/21/21 Loaded script ConsentGatheringSample.py with type consent_gathering into consent_gathering_consentgatheringsample
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/persistence_extension/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/persistence_extension/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type persistence_extension into persistence_extension_samplescript
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/YubicloudExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/YubicloudExternalAuthenticator.py
11:34:51 06/21/21 Loaded script YubicloudExternalAuthenticator.py with type person_authentication into person_authentication_yubicloudexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/SuperGluuExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/SuperGluuExternalAuthenticator.py
11:34:51 06/21/21 Loaded script SuperGluuExternalAuthenticator.py with type person_authentication into person_authentication_supergluuexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/Fido2ExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/Fido2ExternalAuthenticator.py
11:34:51 06/21/21 Loaded script Fido2ExternalAuthenticator.py with type person_authentication into person_authentication_fido2externalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/BasicLockAccountExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/BasicLockAccountExternalAuthenticator.py
11:34:51 06/21/21 Loaded script BasicLockAccountExternalAuthenticator.py with type person_authentication into person_authentication_basiclockaccountexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/UafExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/UafExternalAuthenticator.py
11:34:51 06/21/21 Loaded script UafExternalAuthenticator.py with type person_authentication into person_authentication_uafexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/UserCertExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/UserCertExternalAuthenticator.py
11:34:51 06/21/21 Loaded script UserCertExternalAuthenticator.py with type person_authentication into person_authentication_usercertexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/Casa.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/Casa.py
11:34:51 06/21/21 Loaded script Casa.py with type person_authentication into person_authentication_casa
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/ThumbSignInExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/ThumbSignInExternalAuthenticator.py
11:34:51 06/21/21 Loaded script ThumbSignInExternalAuthenticator.py with type person_authentication into person_authentication_thumbsigninexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/DuoExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/DuoExternalAuthenticator.py
11:34:51 06/21/21 Loaded script DuoExternalAuthenticator.py with type person_authentication into person_authentication_duoexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/smpp2FA.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/smpp2FA.py
11:34:51 06/21/21 Loaded script smpp2FA.py with type person_authentication into person_authentication_smpp2fa
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/twilio2FA.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/twilio2FA.py
11:34:51 06/21/21 Loaded script twilio2FA.py with type person_authentication into person_authentication_twilio2fa
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/OtpExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/OtpExternalAuthenticator.py
11:34:51 06/21/21 Loaded script OtpExternalAuthenticator.py with type person_authentication into person_authentication_otpexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/U2fExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/U2fExternalAuthenticator.py
11:34:51 06/21/21 Loaded script U2fExternalAuthenticator.py with type person_authentication into person_authentication_u2fexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/person_authentication/BasicExternalAuthenticator.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/person_authentication/BasicExternalAuthenticator.py
11:34:51 06/21/21 Loaded script BasicExternalAuthenticator.py with type person_authentication into person_authentication_basicexternalauthenticator
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/end_session/end_session.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/end_session/end_session.py
11:34:51 06/21/21 Loaded script end_session.py with type end_session into end_session_end_session
11:34:51 06/21/21 Loading file /opt/jans/jans-setup/static/extension/id_generator/SampleScript.py
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/static/extension/id_generator/SampleScript.py
11:34:51 06/21/21 Loaded script SampleScript.py with type id_generator into id_generator_samplescript
11:34:51 06/21/21 Rendering templates
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/python.txt
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/python.txt
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/python.txt
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-ldap.properties
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-ldap.properties
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/jans-ldap.properties
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/opendj-setup.properties
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/opendj-setup.properties
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/opendj-setup.properties
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/hostname
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/hostname
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/hostname
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/base.ldif
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/base.ldif
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/base.ldif
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/attributes.ldif
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/attributes.ldif
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/attributes.ldif
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/scopes.ldif
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/scopes.ldif
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/scopes.ldif
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/network
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/network
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/network
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans.properties
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/jans.properties
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/jans.properties
11:34:51 06/21/21 Rendering configuration templates
11:34:51 06/21/21 Rendering template /opt/jans/jans-setup/templates/configuration.ldif
11:34:51 06/21/21 Reading file /opt/jans/jans-setup/templates/configuration.ldif
11:34:51 06/21/21 Writing file /opt/jans/jans-setup/output/configuration.ldif
11:34:51 06/21/21 Copying hosts and hostname to final destination
11:34:51 06/21/21 Copying file /opt/jans/jans-setup/output/hostname to /etc/hostname
11:34:51 06/21/21 Copied /opt/jans/jans-setup/output/hostname to /etc/hostname
11:34:51 06/21/21 Running: /bin/chmod -f 644 /etc/hostname
11:34:51 06/21/21 Running: /bin/hostname test.dd.jans.io
11:34:51 06/21/21 Reading file /etc/hosts
11:34:51 06/21/21 Running: /bin/chmod -R 644 /etc/hosts
11:34:51 06/21/21 Setting ulimist
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-13~
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-14~
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-15~
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-16~
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-17~
11:34:51 06/21/21 Running: cp -f /etc/security/limits.conf /etc/security/limits.conf.jans-1.0.0-18~
11:34:51 06/21/21 Copying rendered templates to final destination
11:34:51 06/21/21 Copying /opt/jans/jans-setup/output/python.txt to /opt/jans/python/libs/python.txt
11:34:51 06/21/21 Created destination folder /opt/jans/python/libs
11:34:51 06/21/21 Copying /opt/jans/jans-setup/output/jans-ldap.properties to /etc/jans/conf/jans-ldap.properties
11:34:51 06/21/21 Copying /opt/jans/jans-setup/output/jans.properties to /etc/jans/conf/jans.properties
11:34:51 06/21/21 Setting up init scripts
11:34:51 06/21/21 Running: /usr/sbin/update-rc.d apache2 defaults
11:34:51 06/21/21 Running: /usr/sbin/update-rc.d apache2 enable
11:34:52 06/21/21 Running: /usr/sbin/update-rc.d rsyslog defaults
11:34:52 06/21/21 Running: /usr/sbin/update-rc.d rsyslog enable
11:34:52 06/21/21 Installing OpenDJ
11:34:52 06/21/21 Running: /usr/sbin/useradd --system --user-group --shell /bin/bash --create-home --home-dir /opt/opendj ldap
11:34:52 06/21/21 Running: /usr/sbin/usermod -a -G jans ldap
11:34:52 06/21/21 Running: /usr/sbin/usermod -a -G adm ldap
11:34:52 06/21/21 Running OpenDJ Setup
11:34:52 06/21/21 Unzipping /opt/dist/app/opendj-server-legacy-4.4.10.zip in /opt/
11:34:52 06/21/21 Running: /usr/bin/unzip -n -q /opt/dist/app/opendj-server-legacy-4.4.10.zip -d /opt/
11:34:53 06/21/21 Running: /bin/chown -R ldap:ldap /opt/opendj
11:34:53 06/21/21 Running: /bin/chown ldap:ldap /opt/opendj/.pw
11:34:53 06/21/21 Running OpenDJ Setup
11:34:53 06/21/21 Running: /bin/chown ldap:ldap /opt/opendj/opendj-setup.properties
11:34:53 06/21/21 Running: /bin/su ldap -c /opt/opendj/setup --no-prompt --cli --propertiesFilePath /opt/opendj/opendj-setup.properties --acceptLicense
11:35:03 06/21/21 
Configuring Directory Server ..... Done.
Configuring Certificates ..... Done.
Starting Directory Server ...... Done.

To see basic server configuration status and configuration, you can launch /opt/opendj/bin/status


11:35:03 06/21/21 Setting OpenDJ params: {'default.java-home': '/opt/jre', 'start-ds.java-args': '-server -Xms5337m -Xmx5337m'}
11:35:03 06/21/21 Reading file /opt/opendj/config/java.properties
11:35:03 06/21/21 Writing file /opt/opendj/config/java.properties
11:35:03 06/21/21 Running: cp -f /opt/opendj/config/java.properties /opt/opendj/config/java.properties.jans-1.0.0-1~
11:35:03 06/21/21 Stopping opendj server
11:35:03 06/21/21 Running: /opt/opendj/bin/stop-ds
11:35:06 06/21/21 Stopping Server...
[21/Jun/2021:11:35:04 +0000] category=PROTOCOL severity=NOTICE msgID=277 msg=Stopped listening for new connections on LDAP Connection Handler 0.0.0.0 port 1389
[21/Jun/2021:11:35:04 +0000] category=PROTOCOL severity=NOTICE msgID=277 msg=Stopped listening for new connections on Administration Connector 0.0.0.0 port 4444
[21/Jun/2021:11:35:04 +0000] category=PROTOCOL severity=NOTICE msgID=277 msg=Stopped listening for new connections on LDAPS Connection Handler 0.0.0.0 port 1636
[21/Jun/2021:11:35:06 +0000] category=BACKEND severity=NOTICE msgID=370 msg=The backend userRoot is now taken offline
[21/Jun/2021:11:35:06 +0000] category=CORE severity=NOTICE msgID=203 msg=The Directory Server is now stopped

11:35:06 06/21/21 Copying file /opt/jans/jans-setup/static/opendj/systemd/opendj.service to /etc/systemd/system
11:35:06 06/21/21 Copied /opt/jans/jans-setup/static/opendj/systemd/opendj.service to /etc/systemd/system
11:35:06 06/21/21 Running: /usr/bin/systemctl daemon-reload
11:35:06 06/21/21 Copying OpenDJ schema
11:35:06 06/21/21 Copying file /opt/jans/jans-setup/static/opendj/101-jans.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Copied /opt/jans/jans-setup/static/opendj/101-jans.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Copying file /opt/jans/jans-setup/static/opendj/96-eduperson.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Copied /opt/jans/jans-setup/static/opendj/96-eduperson.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Copying file /opt/jans/jans-setup/static/opendj/77-customAttributes.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Copied /opt/jans/jans-setup/static/opendj/77-customAttributes.ldif to /opt/opendj/config/schema
11:35:06 06/21/21 Running: /bin/chmod -R a+rX /opt/opendj
11:35:06 06/21/21 Running: /bin/chown -R ldap:ldap /opt/opendj
11:35:06 06/21/21 Re-starting OpenDj after schema update
11:35:06 06/21/21 Running: /usr/bin/systemctl stop opendj
11:35:06 06/21/21 Run: /usr/bin/systemctl stop opendj with result code: 0
11:35:06 06/21/21 Running: /usr/bin/systemctl start opendj
11:35:11 06/21/21 Run: /usr/bin/systemctl start opendj with result code: 0
11:35:11 06/21/21 Bind to database
11:35:11 06/21/21 Making LDAP Conncetion
11:35:11 06/21/21 Making LDAP Connection to host localhost:1636 with user cn=directory manager
11:35:12 06/21/21 Running: /bin/su ldap -c /opt/opendj/bin/dsconfig --trustAll --no-prompt --hostname localhost --port 4444 --bindDN "cn=directory manager" --bindPasswordFile /opt/opendj/.pw create-backend --backend-name metric --set base-dn:o=metric --type je --set enabled:true --set db-cache-percent:20
11:35:14 06/21/21 Running: /bin/su ldap -c /opt/opendj/bin/dsconfig --trustAll --no-prompt --hostname localhost --port 4444 --bindDN "cn=directory manager" --bindPasswordFile /opt/opendj/.pw create-backend --backend-name site --set base-dn:o=site --type je --set enabled:true --set db-cache-percent:20
11:35:17 06/21/21 Configuring OpenDJ
11:35:17 06/21/21 Changing OpenDJ Configuration for ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=Default Password Policy,cn=Password Policies,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=Default Password Policy,cn=Password Policies,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=File-Based Audit Logger,cn=Loggers,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=LDAP Connection Handler,cn=Connection Handlers,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=JMX Connection Handler,cn=Connection Handlers,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=Access Control Handler,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=LDAPS Connection Handler,cn=Connection Handlers,cn=config
11:35:17 06/21/21 Changing OpenDJ Configuration for cn=Administration Connector,cn=config
11:35:17 06/21/21 Creating OpenDJ uniqueness for mail
11:35:17 06/21/21 Creating OpenDJ uniqueness for uid
11:35:17 06/21/21 Getting OpenDJ certificate
11:35:17 06/21/21 Importing OpenDJ certificate to truststore
11:35:17 06/21/21 Running: /opt/jre/bin/keytool -importcert -noprompt -alias server-cert -file /etc/certs/opendj.crt -keystore /etc/certs/opendj.pkcs12 -storetype PKCS12 -storepass 6kgZi1VUPrJV
11:35:17 06/21/21 Import OpenDJ certificate
11:35:17 06/21/21 Running: /opt/jre/bin/keytool -import -trustcacerts -alias test.dd.jans.io_opendj -file /etc/certs/opendj.crt -keystore /opt/jre/jre/lib/security/cacerts -storepass changeit -noprompt
11:35:18 06/21/21 Creating OpenDJ Indexes
11:35:18 06/21/21 Creating Index ds-cfg-attribute=displayName,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=description,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=owner,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=inum,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=inum,cn=Index,ds-cfg-backend-id=site,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=uniqueIdentifier,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=uuid,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=clnId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansClntSecretExpAt,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=grtId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=authzCode,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=tknCde,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansSectorIdentifier,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansStatus,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansStatus,cn=Index,ds-cfg-backend-id=site,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansState,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansScrTyp,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansScrTyp,cn=Index,ds-cfg-backend-id=site,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=exp,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansLastAccessTime,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansApp,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansReqId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=creationDate,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansStartDate,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansEndDate,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansAppTyp,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansMetricTyp,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansDeviceHashCode,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansDeviceKeyHandle,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=ssnId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=sid,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansExtUid,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansTicket,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansCodeChallenge,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=chlng,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansCodeChallengeHash,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansPublicKeyId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansAttrs,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansConfCode,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansResourceSetId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansUmaScope,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansUsrId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=del,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansExtId,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Creating Index ds-cfg-attribute=jansUsrDN,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:35:18 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/base.ldif, /opt/jans/jans-setup/output/attributes.ldif, /opt/jans/jans-setup/output/scopes.ldif, /opt/jans/jans-setup/output/configuration.ldif, /opt/jans/jans-setup/static/metric/o_metric.ldif, /opt/jans/jans-setup/static/cache-refresh/o_site.ldif 
11:35:18 06/21/21 Importing entries from /opt/jans/jans-setup/output/base.ldif
11:35:18 06/21/21 Querying LDAP for dn o=jans
11:35:18 06/21/21 Adding LDAP dn:o=jans entry:{'description': ['Welcome to oxTrust!'], 'displayName': ['gluu org'], 'jansOrgShortName': ['gluu org'], 'jansThemeColor': ['166309'], 'o': ['jans'], 'objectClass': ['top', 'jansOrganization']}
11:35:18 06/21/21 Querying LDAP for dn ou=people,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=people,o=jans entry:{'objectClass': ['top', 'organizationalunit'], 'ou': ['people']}
11:35:18 06/21/21 Querying LDAP for dn ou=groups,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=groups,o=jans entry:{'objectClass': ['top', 'organizationalunit'], 'ou': ['groups']}
11:35:18 06/21/21 Querying LDAP for dn ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=attributes,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['attributes']}
11:35:18 06/21/21 Querying LDAP for dn ou=scopes,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=scopes,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['scopes']}
11:35:18 06/21/21 Querying LDAP for dn ou=clients,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=clients,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['clients']}
11:35:18 06/21/21 Querying LDAP for dn ou=stat,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=stat,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['stat']}
11:35:18 06/21/21 Querying LDAP for dn ou=sessions,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=sessions,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['sessions']}
11:35:18 06/21/21 Querying LDAP for dn ou=tokens,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=tokens,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['tokens']}
11:35:18 06/21/21 Querying LDAP for dn ou=authorizations,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=authorizations,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['authorizations']}
11:35:18 06/21/21 Querying LDAP for dn ou=scripts,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=scripts,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['scripts']}
11:35:18 06/21/21 Querying LDAP for dn ou=resetPasswordRequests,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=resetPasswordRequests,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['resetPasswordRequests']}
11:35:18 06/21/21 Querying LDAP for dn ou=uma,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=uma,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['uma']}
11:35:18 06/21/21 Querying LDAP for dn ou=resources,ou=uma,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=resources,ou=uma,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['resources']}
11:35:18 06/21/21 Querying LDAP for dn ou=pct,ou=uma,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=pct,ou=uma,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['pct']}
11:35:18 06/21/21 Querying LDAP for dn ou=push,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=push,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['push']}
11:35:18 06/21/21 Querying LDAP for dn ou=application,ou=push,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=application,ou=push,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['application']}
11:35:18 06/21/21 Querying LDAP for dn ou=device,ou=push,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=device,ou=push,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['device']}
11:35:18 06/21/21 Querying LDAP for dn ou=u2f,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=u2f,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['u2f']}
11:35:18 06/21/21 Querying LDAP for dn ou=registration_requests,ou=u2f,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=registration_requests,ou=u2f,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['registration_requests']}
11:35:18 06/21/21 Querying LDAP for dn ou=authentication_requests,ou=u2f,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=authentication_requests,ou=u2f,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['authentication_requests']}
11:35:18 06/21/21 Querying LDAP for dn ou=registered_devices,ou=u2f,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=registered_devices,ou=u2f,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['registered_devices']}
11:35:18 06/21/21 Querying LDAP for dn ou=metric,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=metric,o=jans entry:{'objectClass': ['top', 'organizationalunit'], 'ou': ['metric']}
11:35:18 06/21/21 Querying LDAP for dn ou=sector_identifiers,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=sector_identifiers,o=jans entry:{'objectClass': ['top', 'organizationalunit'], 'ou': ['sector_identifiers']}
11:35:18 06/21/21 Querying LDAP for dn ou=ciba,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=ciba,o=jans entry:{'objectClass': ['top', 'organizationalunit'], 'ou': ['ciba']}
11:35:18 06/21/21 Querying LDAP for dn ou=trustRelationships,o=jans
11:35:18 06/21/21 Adding LDAP dn:ou=trustRelationships,o=jans entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['trustRelationships']}
11:35:18 06/21/21 Importing entries from /opt/jans/jans-setup/output/attributes.ldif
11:35:18 06/21/21 Querying LDAP for dn inum=29DA,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=29DA,ou=attributes,o=jans entry:{'description': ['XRI i-number, persistent non-reassignable identifier'], 'displayName': ['Inum'], 'inum': ['29DA'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['inum'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['inum'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:inum'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.117'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:inum']}
11:35:18 06/21/21 Querying LDAP for dn inum=B4B0,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=B4B0,ou=attributes,o=jans entry:{'description': ['Given name(s) or first name(s) of the End-User.Note that in some cultures, people can have multiple given names;all can be present, with the names being separated by space characters.'], 'displayName': ['First Name'], 'inum': ['B4B0'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['givenName'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['given_name'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:givenName'], 'jansSAML2URI': ['urn:oid:2.5.4.42'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:givenName']}
11:35:18 06/21/21 Querying LDAP for dn inum=42E0,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=42E0,ou=attributes,o=jans entry:{'description': ['A domain issued and managed identifier for the person.Subject - Identifier for the End-User at the Issuer.'], 'displayName': ['Username'], 'inum': ['42E0'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['uid'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['user_name'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:uid'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.1'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:uid']}
11:35:18 06/21/21 Querying LDAP for dn inum=B52A,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=B52A,ou=attributes,o=jans entry:{'description': ['A domain issued and managed identifier for the person.Subject - Identifier for the End-User at the Issuer.'], 'displayName': ['Preferred Username'], 'inum': ['B52A'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansPrefUsrName'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['preferred_username'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:preferredUsername'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.320'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/preferred_username']}
11:35:18 06/21/21 Querying LDAP for dn inum=64A0,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=64A0,ou=attributes,o=jans entry:{'description': ["URL of the End-User's profile page. The contents of this Web page SHOULD be about the End-User."], 'displayName': ['Profile URL'], 'inum': ['64A0'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['profile'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['profile'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:profile'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.321'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/profile']}
11:35:18 06/21/21 Querying LDAP for dn inum=3B47,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=3B47,ou=attributes,o=jans entry:{'description': ["URL of the End-User's Web page or blog."], 'displayName': ['Website URL'], 'inum': ['3B47'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['website'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['website'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:website'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.323'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/website']}
11:35:18 06/21/21 Querying LDAP for dn inum=8F88,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=8F88,ou=attributes,o=jans entry:{'description': ["True if the End-User's e-mail address has been verified; otherwise false"], 'displayName': ['Email Verified'], 'inum': ['8F88'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['emailVerified'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['boolean'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['email_verified'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:emailVerified'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.324'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/email_verified']}
11:35:18 06/21/21 Querying LDAP for dn inum=B17A,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=B17A,ou=attributes,o=jans entry:{'description': ["True if the End-User's phone number has been verified; otherwise false"], 'displayName': ['Phone Number Verified'], 'inum': ['B17A'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['phoneNumberVerified'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['boolean'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['phone_number_verified'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:phoneNumberVerified'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.329'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/phone_number_verified']}
11:35:18 06/21/21 Querying LDAP for dn inum=C8D5,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=C8D5,ou=attributes,o=jans entry:{'description': ["End-User's preferred postal address. The value of the address member is aJSON [RFC4627] structure containing some or all of the members defined inOpenID Connect 1.0 Core Standard Section 5.1.1"], 'displayName': ['OpenID Connect JSON formatted address'], 'inum': ['C8D5'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['address'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['address'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:address'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.330'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/address']}
11:35:18 06/21/21 Querying LDAP for dn inum=BE64,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=BE64,ou=attributes,o=jans entry:{'description': ["Time the End-User's information was last updated. Its value isaJSON number representing the number of seconds from 1970-01-01T0:0:0Z as measured inUTC until the date/time."], 'displayName': ['Last Updated'], 'inum': ['BE64'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['updatedAt'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['generalizedTime'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['updated_at'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:updatedAt'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.331'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/address']}
11:35:18 06/21/21 Querying LDAP for dn inum=3692,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=3692,ou=attributes,o=jans entry:{'description': ['Gender of the person, either male or female'], 'displayName': ['Gender, male or female'], 'inum': ['3692'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['gender'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['gender'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:gender'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.325'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/gender']}
11:35:18 06/21/21 Querying LDAP for dn inum=98FC,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=98FC,ou=attributes,o=jans entry:{'description': ["End-User's birthday, represented as an ISO 8601:2004 [ISO86012004] YYYY-MM-DD format."], 'displayName': ['Birthdate'], 'inum': ['98FC'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['birthdate'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['birthdate'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:birthdate'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.326'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/birthdate']}
11:35:18 06/21/21 Querying LDAP for dn inum=D2E0,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=D2E0,ou=attributes,o=jans entry:{'description': ['memberOf'], 'displayName': ['memberOf'], 'inum': ['D2E0'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['memberOf'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansClaimName': ['member_of'], 'jansMultivaluedAttr': ['true'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:memberOf'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.121'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:memberOf']}
11:35:18 06/21/21 Querying LDAP for dn inum=A901,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=A901,ou=attributes,o=jans entry:{'description': ["String from time zone database representing the End-User's time zone. For example,Europe/Paris or America/Los_Angeles."], 'displayName': ['Time zone info'], 'inum': ['A901'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['zoneinfo'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['zoneinfo'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:zoneinfo'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.327'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/zoneinfo']}
11:35:18 06/21/21 Querying LDAP for dn inum=36D9,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=36D9,ou=attributes,o=jans entry:{'description': ["End-User's locale, represented as a BCP47 (RFC5646) language tag. This is typically anISO 639-1 Alpha-2 [ISO6391] language code in lowercase and an ISO 3166-1 Alpha-2country code in uppercase, separated by a dash. For example, en-US or fr-CA. As a compatibility note,some implementations have used an underscore as the separator rather than a dash, for example, en_US;Relying Parties MAY choose to accept this locale syntax as well."], 'displayName': ['Locale'], 'inum': ['36D9'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['locale'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['locale'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:locale'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.328'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/locale']}
11:35:18 06/21/21 Querying LDAP for dn inum=8A11,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=8A11,ou=attributes,o=jans entry:{'description': ['Secret Question'], 'displayName': ['Secret Question'], 'inum': ['8A11'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['secretQuestion'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:secretQuestion'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.306'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:secretQuestion']}
11:35:18 06/21/21 Querying LDAP for dn inum=C703,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=C703,ou=attributes,o=jans entry:{'description': ['Secret Answer'], 'displayName': ['Secret Answer'], 'inum': ['C703'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['secretAnswer'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:secretAnswer'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.305'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:secretAnswer']}
11:35:18 06/21/21 Querying LDAP for dn inum=6493,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=6493,ou=attributes,o=jans entry:{'description': ['Preferred Language'], 'displayName': ['Preferred Language'], 'inum': ['6493'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['preferredLanguage'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin', 'whitePages'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:preferredLanguage'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.39'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:preferredLanguage']}
11:35:18 06/21/21 Querying LDAP for dn inum=CAE3,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=CAE3,ou=attributes,o=jans entry:{'description': ['Primary Email Address'], 'displayName': ['Email'], 'inum': ['CAE3'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['mail'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['email'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:mail'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.3'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:mail']}
11:35:18 06/21/21 Querying LDAP for dn inum=A0E8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=A0E8,ou=attributes,o=jans entry:{'description': ['Middle name(s) of the End-User. Note that in some cultures,people can have multiple middle names; all can be present, with the namesbeingseparated by space characters. Also note that in some cultures,middle names are not used.'], 'displayName': ['Middle Name'], 'inum': ['A0E8'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['middleName'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['middle_name'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:middleName'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.318'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/middle_username']}
11:35:18 06/21/21 Querying LDAP for dn inum=5EC6,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=5EC6,ou=attributes,o=jans entry:{'description': ['Casual name of the End-User that may or may not be the same asthe given_name.For instance, a nickname value of Mike might be returned alongside a given_name value of Michael.'], 'displayName': ['Nickname'], 'inum': ['5EC6'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['nickname'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['nickname'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:nickname'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.319'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/nickname']}
11:35:18 06/21/21 Querying LDAP for dn inum=0C85,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=0C85,ou=attributes,o=jans entry:{'description': ['Last Name', 'Surname(s) or last name(s) of the End-User. Note that in somecultures, people can have multiple family names or no family name; all canbepresent, with the names being separated by space characters.'], 'displayName': ['Last Name'], 'inum': ['0C85'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['sn'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['family_name'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:sn'], 'jansSAML2URI': ['urn:oid:2.5.4.4'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:sn']}
11:35:18 06/21/21 Querying LDAP for dn inum=BCA8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=BCA8,ou=attributes,o=jans entry:{'description': ['TransientId'], 'displayName': ['TransientId'], 'inum': ['BCA8'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['transientId'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:transientId'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.312'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['mace:shibboleth:1.0:nameIdentifier']}
11:35:18 06/21/21 Querying LDAP for dn inum=BCB8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=BCB8,ou=attributes,o=jans entry:{'description': ['PersistentId'], 'displayName': ['PersistentId'], 'inum': ['BCB8'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['persistentId'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:persistentId'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.291'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['mace:shibboleth:1.0:nameIdentifier']}
11:35:18 06/21/21 Querying LDAP for dn inum=BCE8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=BCE8,ou=attributes,o=jans entry:{'description': ['Country'], 'displayName': ['Country'], 'inum': ['BCE8'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['c'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['country'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:c'], 'jansSAML2URI': ['urn:oid:2.5.4.6'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:c']}
11:35:18 06/21/21 Querying LDAP for dn inum=2B29,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=2B29,ou=attributes,o=jans entry:{'description': ["End-User's full name in displayable formincluding all name parts, possibly including titles andsuffixes, ordered according to the End-User's locale and preferences."], 'displayName': ['Display Name'], 'inum': ['2B29'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['displayName'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['name'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:displayName'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.241'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:displayName']}
11:35:18 06/21/21 Querying LDAP for dn inum=EC3A,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=EC3A,ou=attributes,o=jans entry:{'description': ["URL of the End-User's profile picture"], 'displayName': ['Picture URL'], 'inum': ['EC3A'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['picture'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['picture'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:picture'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.322'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/picture']}
11:35:18 06/21/21 Querying LDAP for dn inum=D03E,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=D03E,ou=attributes,o=jans entry:{'description': ['Organization'], 'displayName': ['Organization'], 'inum': ['D03E'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['o'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansClaimName': ['o'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:o'], 'jansSAML2URI': ['urn:oid:2.5.4.10'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:o']}
11:35:18 06/21/21 Querying LDAP for dn inum=AAEE,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=AAEE,ou=attributes,o=jans entry:{'description': ['User secret string'], 'displayName': ['Password'], 'inum': ['AAEE'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['userPassword'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:userPassword'], 'jansSAML2URI': ['urn:oid:2.5.4.35'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:userPassword']}
11:35:18 06/21/21 Querying LDAP for dn inum=C001,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=C001,ou=attributes,o=jans entry:{'description': ['Organizational Title'], 'displayName': ['Title'], 'inum': ['C001'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['title'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:title'], 'jansSAML2URI': ['urn:oid:2.5.4.12'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:title']}
11:35:18 06/21/21 Querying LDAP for dn inum=4502,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=4502,ou=attributes,o=jans entry:{'description': ['Vehicle License Plate Number'], 'displayName': ['License Plate'], 'inum': ['4502'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['carLicense'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:carLicense'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.1'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:carLicense']}
11:35:18 06/21/21 Querying LDAP for dn inum=BD22,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=BD22,ou=attributes,o=jans entry:{'description': ['Fax Telephone Number'], 'displayName': ['Fax Number'], 'inum': ['BD22'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['facsimileTelephoneNumber'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:facsimileTelephoneNumber'], 'jansSAML2URI': ['urn:oid:2.5.4.23'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:facsimileTelephoneNumber']}
11:35:18 06/21/21 Querying LDAP for dn inum=08E2,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=08E2,ou=attributes,o=jans entry:{'description': ['Organizational Department'], 'displayName': ['Department'], 'inum': ['08E2'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['departmentNumber'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:departmentNumber'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.2'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:departmentNumber']}
11:35:18 06/21/21 Querying LDAP for dn inum=3D44,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=3D44,ou=attributes,o=jans entry:{'description': ['Employee Type'], 'displayName': ['Employee Type'], 'inum': ['3D44'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['employeeType'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:employeeType'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.4'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:employeeType']}
11:35:18 06/21/21 Querying LDAP for dn inum=D054,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=D054,ou=attributes,o=jans entry:{'description': ['Name search keywords'], 'displayName': ['Name search keywords'], 'inum': ['D054'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['cn'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:cn'], 'jansSAML2URI': ['urn:oid:2.5.4.3'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:cn']}
11:35:18 06/21/21 Querying LDAP for dn inum=6DA6,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=6DA6,ou=attributes,o=jans entry:{'description': ['Mobile Telephone Number'], 'displayName': ['Mobile Telephone Number'], 'inum': ['6DA6'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['mobile'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['phone_mobile_number'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:mobile'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.41'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:mobile']}
11:35:18 06/21/21 Querying LDAP for dn inum=0C18,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=0C18,ou=attributes,o=jans entry:{'description': ['Home Telephone Number'], 'displayName': ['Home Telephone Number'], 'inum': ['0C18'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['telephoneNumber'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['phone_number'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:telephoneNumber'], 'jansSAML2URI': ['urn:oid:2.5.4.20'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:phone_number']}
11:35:18 06/21/21 Querying LDAP for dn inum=E6B8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=E6B8,ou=attributes,o=jans entry:{'description': ['State or Province'], 'displayName': ['State or Province'], 'inum': ['E6B8'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['st'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['region'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:st'], 'jansSAML2URI': ['urn:oid:2.5.4.8'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:st']}
11:35:18 06/21/21 Querying LDAP for dn inum=42D8,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=42D8,ou=attributes,o=jans entry:{'description': ['Manager'], 'displayName': ['Manager'], 'inum': ['42D8'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['manager'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:manager'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.10'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:manager']}
11:35:18 06/21/21 Querying LDAP for dn inum=6609,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=6609,ou=attributes,o=jans entry:{'description': ['Street'], 'displayName': ['Street'], 'inum': ['6609'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['street'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['street_address'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:street'], 'jansSAML2URI': ['urn:oid:2.5.4.9'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:street']}
11:35:18 06/21/21 Querying LDAP for dn inum=E999,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=E999,ou=attributes,o=jans entry:{'description': ['Postal Box'], 'displayName': ['PO Box'], 'inum': ['E999'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['postOfficeBox'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:postOfficeBox'], 'jansSAML2URI': ['urn:oid:2.5.4.18'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:postOfficeBox']}
11:35:18 06/21/21 Querying LDAP for dn inum=D0C9,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=D0C9,ou=attributes,o=jans entry:{'description': ['Employee Number'], 'displayName': ['Employee Number'], 'inum': ['D0C9'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['employeeNumber'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:employeeNumber'], 'jansSAML2URI': ['urn:oid:2.16.840.1.113730.3.1.3'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:employeeNumber']}
11:35:18 06/21/21 Querying LDAP for dn inum=894A,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=894A,ou=attributes,o=jans entry:{'description': ['Preferred Delivery Method'], 'displayName': ['Preferred Delivery Method'], 'inum': ['894A'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['preferredDeliveryMethod'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:preferredDeliveryMethod'], 'jansSAML2URI': ['urn:oid:2.5.4.28'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:preferredDeliveryMethod']}
11:35:18 06/21/21 Querying LDAP for dn inum=D90B,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=D90B,ou=attributes,o=jans entry:{'description': ['Room Number'], 'displayName': ['Room Number'], 'inum': ['D90B'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['roomNumber'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:roomNumber'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.6'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:roomNumber']}
11:35:18 06/21/21 Querying LDAP for dn inum=AC0B,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=AC0B,ou=attributes,o=jans entry:{'description': ['Secretary'], 'displayName': ['Secretary'], 'inum': ['AC0B'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['secretary'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:secretary'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.21'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:secretary']}
11:35:18 06/21/21 Querying LDAP for dn inum=4649,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=4649,ou=attributes,o=jans entry:{'description': ['User status to allow/disable user access'], 'displayName': ['User Status'], 'inum': ['4649'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansStatus'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:jansStatus'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.97'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:status']}
11:35:18 06/21/21 Querying LDAP for dn inum=27DB,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=27DB,ou=attributes,o=jans entry:{'description': ['Home Address'], 'displayName': ['Home Address'], 'inum': ['27DB'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['homePostalAddress'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['formatted'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:homePostalAddress'], 'jansSAML2URI': ['urn:oid:0.9.2342.19200300.100.1.39'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:homePostalAddress']}
11:35:18 06/21/21 Querying LDAP for dn inum=6EEB,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=6EEB,ou=attributes,o=jans entry:{'description': ['City'], 'displayName': ['City'], 'inum': ['6EEB'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['l'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['locality'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:l'], 'jansSAML2URI': ['urn:oid:2.5.4.7'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:l']}
11:35:18 06/21/21 Querying LDAP for dn inum=2A3D,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=2A3D,ou=attributes,o=jans entry:{'description': ['Postal or Zip Code'], 'displayName': ['Postal Code'], 'inum': ['2A3D'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['postalCode'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansClaimName': ['postal_code'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:postalCode'], 'jansSAML2URI': ['urn:oid:2.5.4.17'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:postalCode']}
11:35:18 06/21/21 Querying LDAP for dn inum=48EE,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=48EE,ou=attributes,o=jans entry:{'description': ['Description'], 'displayName': ['Description'], 'inum': ['48EE'], 'jansAttrEditTyp': ['user', 'admin'], 'jansAttrName': ['description'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['user', 'admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:description'], 'jansSAML2URI': ['urn:oid:2.5.4.13'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:description']}
11:35:18 06/21/21 Querying LDAP for dn inum=4E0C,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=4E0C,ou=attributes,o=jans entry:{'description': ["Specifies the person's relationship(s) to the institutionin broad categories such as student, faculty, staff, alum, etc."], 'displayName': ['eduPersonAffiliation'], 'inum': ['4E0C'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonAffiliation'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonAffiliation'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.1'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.1']}
11:35:18 06/21/21 Querying LDAP for dn inum=E7BC,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=E7BC,ou=attributes,o=jans entry:{'description': ["Person's nickname, or the informal name by which the End-User is accustomedto be hailed. A casual name that may or may not be the same asthe given_name. For instance,a nickname value of Mike might be returned alongside a given_name value of Michael."], 'displayName': ['eduPersonNickName'], 'inum': ['E7BC'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonNickName'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonNickName'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.2'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.2']}
11:35:18 06/21/21 Querying LDAP for dn inum=6366,ou=attributes,o=jans
11:35:18 06/21/21 Adding LDAP dn:inum=6366,ou=attributes,o=jans entry:{'description': ['The distinguished name (DN) of the directory entryrepresentingthe institution with which the person is associated.'], 'displayName': ['eduPersonOrgDN'], 'inum': ['6366'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonOrgDN'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonOrgDN'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.3'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.3']}
11:35:19 06/21/21 Querying LDAP for dn inum=ED0D,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=ED0D,ou=attributes,o=jans entry:{'description': ["The distinguished name(s) (DN) of the directory entriesrepresenting the person's Organizational Unit(s). May be multivalued,as for example, in the case of a faculty member with appointments inmultiple departmentsor a person who is a student in one departmentand an employee in another."], 'displayName': ['eduPersonOrgUnitDN'], 'inum': ['ED0D'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonOrgUnitDN'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonOrgUnitDN'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.4'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.4']}
11:35:19 06/21/21 Querying LDAP for dn inum=91E7,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=91E7,ou=attributes,o=jans entry:{'description': ["Specifies the person's primary relationship to theinstitution in broad categories such as student, faculty, staff,alum, etc. (See controlled vocabulary)."], 'displayName': ['eduPersonPrimaryAffiliation'], 'inum': ['91E7'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonPrimaryAffiliation'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonPrimaryAffiliation'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.5'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.5']}
11:35:19 06/21/21 Querying LDAP for dn inum=096B,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=096B,ou=attributes,o=jans entry:{'description': ['A scoped identifier for a person. It should berepresented in the form "user@scope" where \'user\' is aname-based identifier for the person and where \'scope\'defines a local security domain. Each value of \'scope\' definesa namespace within which the assigned identifiers MUST be unique.Given this rule, if two eduPersonPrincipalName (ePPN) values arethe same at a given point in time, they refer to the same person.'], 'displayName': ['eduPersonPrincipalName'], 'inum': ['096B'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonPrincipalName'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonPrincipalName'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.6'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.6']}
11:35:19 06/21/21 Querying LDAP for dn inum=BF03,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=BF03,ou=attributes,o=jans entry:{'description': ['URI (either URN or URL) that indicates a set of rights to specific resources.'], 'displayName': ['eduPersonEntitlement'], 'inum': ['BF03'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonEntitlement'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonEntitlement'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.7'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.7']}
11:35:19 06/21/21 Querying LDAP for dn inum=0247,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=0247,ou=attributes,o=jans entry:{'description': ["The distinguished name (DN) of the directory entry representingthe person's primary Organizational Unit(s)."], 'displayName': ['eduPersonPrimaryOrgUnitDN'], 'inum': ['0247'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonPrimaryOrgUnitDN'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonPrimaryOrgUnitDN'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.8'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.8']}
11:35:19 06/21/21 Querying LDAP for dn inum=002A,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=002A,ou=attributes,o=jans entry:{'description': ['Specifies the person\'s affiliation within a particular security domainin broad categories such as student, faculty, staff, alum, etc. Thevalues consistof a left and right component separated by an "@" sign. The left component is one ofthe values from the eduPersonAffiliation controlledvocabulary.This right-hand side syntaxof eduPersonScopedAffiliation intentionally matches that used for the right-hand sidevalues for eduPersonPrincipalName since both identify a security domain. Multiple "@" signsare not recommended, but in any case, the first occurrence of the "@" sign starting from theleft is to be taken as the delimiter between components. Thus, user identifier is to the left,security domain to the right of the first "@". This parsing rule conforms to the POSIX "greedy"disambiguation method in regular expression processing.'], 'displayName': ['eduPersonScopedAffiliation'], 'inum': ['002A'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonScopedAffiliation'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonScopedAffiliation'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.9'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.9']}
11:35:19 06/21/21 Querying LDAP for dn inum=8FF3,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=8FF3,ou=attributes,o=jans entry:{'description': ['A persistent, non-reassigned, opaque identifier for a principal.'], 'displayName': ['eduPersonTargetedID'], 'inum': ['8FF3'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonTargetedID'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonTargetedID'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.10'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.10']}
11:35:19 06/21/21 Querying LDAP for dn inum=4B0F,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=4B0F,ou=attributes,o=jans entry:{'description': ['Set of URIs that assert compliance with specific standardsfor identity assurance.'], 'displayName': ['eduPersonAssurance'], 'inum': ['4B0F'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonAssurance'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonAssurance'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.11'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.11']}
11:35:19 06/21/21 Querying LDAP for dn inum=4A0A,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=4A0A,ou=attributes,o=jans entry:{'description': ['Person principal name prior'], 'displayName': ['eduPersonPrincipalNamePrior'], 'inum': ['4A0A'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonPrincipalNamePrior'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonPrincipalNamePrior'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.12'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.12']}
11:35:19 06/21/21 Querying LDAP for dn inum=4A0B,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=4A0B,ou=attributes,o=jans entry:{'description': ['Person unique Id'], 'displayName': ['eduPersonUniqueId'], 'inum': ['4A0B'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonUniqueId'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonUniqueId'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.13'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.13']}
11:35:19 06/21/21 Querying LDAP for dn inum=4A0C,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=4A0C,ou=attributes,o=jans entry:{'description': ['ORCID researcher identifiers belonging to the principal'], 'displayName': ['eduPersonOrcid'], 'inum': ['4A0C'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['eduPersonOrcid'], 'jansAttrOrigin': ['eduPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:eduPersonOrcid'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.5923.1.1.1.16'], 'jansStatus': ['inactive'], 'objectClass': ['top', 'jansAttr'], 'urn': ['oid:1.3.6.1.4.1.5923.1.1.1.16']}
11:35:19 06/21/21 Querying LDAP for dn inum=5039,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=5039,ou=attributes,o=jans entry:{'description': ['jansEnrollmentCode', 'Enrollment code, non-reassignable code'], 'displayName': ['Enrollment code'], 'inum': ['5039'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansEnrollmentCode'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:jansEnrollmentCode'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.239'], 'jansScimCustomAttr': ['true'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:jansEnrollmentCode']}
11:35:19 06/21/21 Querying LDAP for dn inum=42E1,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=42E1,ou=attributes,o=jans entry:{'description': ['IMAP Data'], 'displayName': ['IMAP Data'], 'inum': ['42E1'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['jansIMAPData'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['json'], 'jansAttrViewTyp': ['admin', 'user'], 'jansClaimName': ['imap_data'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:jansIMAPData'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.355'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:jansIMAPData']}
11:35:19 06/21/21 Querying LDAP for dn inum=6049,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=6049,ou=attributes,o=jans entry:{'description': ['jansPermission', 'User permission or role'], 'displayName': ['User Permission'], 'inum': ['6049'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['role'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin'], 'jansClaimName': ['user_permission'], 'jansMultivaluedAttr': ['true'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:role'], 'jansSAML2URI': ['urn:oid:1.3.6.1.4.1.48710.1.3.299'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:jans:dir:attribute-def:role']}
11:35:19 06/21/21 Querying LDAP for dn inum=CACA,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=CACA,ou=attributes,o=jans entry:{'description': ['User certificate'], 'displayName': ['User certificate'], 'inum': ['CACA'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['userCertificate'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['certificate'], 'jansAttrViewTyp': ['admin', 'user'], 'jansSAML1URI': ['urn:mace:dir:attribute-def:userCertificate'], 'jansSAML2URI': ['urn:oid:2.5.4.36'], 'jansStatus': ['active'], 'jansValidation': ['{"minLength":null,"maxLength":2048,"regexp":""}'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:userCertificate']}
11:35:19 06/21/21 Querying LDAP for dn inum=11AA,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=11AA,ou=attributes,o=jans entry:{'description': ['CIBA Device Registration Token'], 'displayName': ['CIBA Device Registration Token'], 'inum': ['11AA'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['jansBackchannelDeviceRegistrationTkn'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:jansBackchannelDeviceRegistrationTkn']}
11:35:19 06/21/21 Querying LDAP for dn inum=11AB,ou=attributes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=11AB,ou=attributes,o=jans entry:{'description': ['CIBA User code'], 'displayName': ['CIBA User code'], 'inum': ['11AB'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['jansBackchannelUsrCode'], 'jansAttrOrigin': ['jansPerson'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr'], 'urn': ['urn:mace:dir:attribute-def:jansBackchannelUsrCode']}
11:35:19 06/21/21 Importing entries from /opt/jans/jans-setup/output/scopes.ldif
11:35:19 06/21/21 Querying LDAP for dn inum=F0C4,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=F0C4,ou=scopes,o=jans entry:{'description': ['Authenticate using OpenID Connect.'], 'displayName': ['authenticate_openid_connect'], 'inum': ['F0C4'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['true'], 'jansId': ['openid'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=43F1,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=43F1,ou=scopes,o=jans entry:{'description': ['View your basic profile info.'], 'displayName': ['view_profile'], 'inum': ['43F1'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=2B29,ou=attributes,o=jans', 'inum=0C85,ou=attributes,o=jans', 'inum=B4B0,ou=attributes,o=jans', 'inum=A0E8,ou=attributes,o=jans', 'inum=5EC6,ou=attributes,o=jans', 'inum=B52A,ou=attributes,o=jans', 'inum=64A0,ou=attributes,o=jans', 'inum=EC3A,ou=attributes,o=jans', 'inum=3B47,ou=attributes,o=jans', 'inum=3692,ou=attributes,o=jans', 'inum=98FC,ou=attributes,o=jans', 'inum=A901,ou=attributes,o=jans', 'inum=36D9,ou=attributes,o=jans', 'inum=BE64,ou=attributes,o=jans', 'inum=6493,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['profile'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=764C,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=764C,ou=scopes,o=jans entry:{'description': ['View your email address.'], 'displayName': ['view_email_address'], 'inum': ['764C'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=8F88,ou=attributes,o=jans', 'inum=CAE3,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['email'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=C17A,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=C17A,ou=scopes,o=jans entry:{'description': ['View your address.'], 'displayName': ['view_address'], 'inum': ['C17A'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=27DB,ou=attributes,o=jans', 'inum=2A3D,ou=attributes,o=jans', 'inum=6609,ou=attributes,o=jans', 'inum=6EEB,ou=attributes,o=jans', 'inum=BCE8,ou=attributes,o=jans', 'inum=D90B,ou=attributes,o=jans', 'inum=E6B8,ou=attributes,o=jans', 'inum=E999,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansGrpClaims': ['true'], 'jansId': ['address'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=D491,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=D491,ou=scopes,o=jans entry:{'description': ['View your phone number.'], 'displayName': ['view_phone_number'], 'inum': ['D491'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=B17A,ou=attributes,o=jans', 'inum=0C18,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['phone'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=341A,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=341A,ou=scopes,o=jans entry:{'description': ['View the client info.'], 'displayName': ['view_client'], 'inum': ['341A'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=2B29,ou=attributes,o=jans', 'inum=29DA,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['clientinfo'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=10B2,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=10B2,ou=scopes,o=jans entry:{'description': ['View your local username in the Janssen Server.'], 'displayName': ['view_username'], 'inum': ['10B2'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=42E0,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['user_name'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=6D99,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=6D99,ou=scopes,o=jans entry:{'description': ['Obtain UMA PAT.'], 'displayName': ['UMA Protection'], 'inum': ['6D99'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['true'], 'jansId': ['uma_protection'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=6D90,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=6D90,ou=scopes,o=jans entry:{'description': ['oxd scope which is required to call oxd API'], 'displayName': ['oxd'], 'inum': ['6D90'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['true'], 'jansId': ['oxd'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=7D90,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=7D90,ou=scopes,o=jans entry:{'description': ['revoke_session scope which is required to be able call /revoke_session endpoint'], 'displayName': ['revoke_session'], 'inum': ['7D90'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['false'], 'jansId': ['revoke_session'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=8A01,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=8A01,ou=scopes,o=jans entry:{'description': ['View your mobile phone number.'], 'displayName': ['view_mobile_phone_number'], 'inum': ['8A01'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansClaim': ['inum=6DA6,ou=attributes,o=jans'], 'jansDefScope': ['false'], 'jansId': ['mobile_phone'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=C4F5,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=C4F5,ou=scopes,o=jans entry:{'description': ['View your user permission and roles.'], 'displayName': ['view_user_permissions_roles'], 'inum': ['C4F5'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['true'], 'jansId': ['permission'], 'jansScopeTyp': ['dynamic'], 'jansScrDn': ['inum=CB5B-3211,ou=scripts,o=jans'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Querying LDAP for dn inum=C4F6,ou=scopes,o=jans
11:35:19 06/21/21 Adding LDAP dn:inum=C4F6,ou=scopes,o=jans entry:{'description': ['This scope value requests that an OAuth 2.0 Refresh Token be issued.'], 'displayName': ['refresh_token'], 'inum': ['C4F6'], 'jansAttrs': ['{"spontaneousClientId":"","spontaneousClientScopes":[],"showInConfigurationEndpoint":true}'], 'jansDefScope': ['true'], 'jansId': ['offline_access'], 'jansScopeTyp': ['openid'], 'objectClass': ['top', 'jansScope']}
11:35:19 06/21/21 Importing entries from /opt/jans/jans-setup/output/configuration.ldif
11:35:19 06/21/21 Querying LDAP for dn ou=configuration,o=jans
11:35:19 06/21/21 Adding LDAP dn:ou=configuration,o=jans entry:{'jansCacheConf': ['{"cacheProviderType": "NATIVE_PERSISTENCE", "memcachedConfiguration": {"servers":"localhost:11211", "maxOperationQueueLength":100000, "bufferSize":32768, "defaultPutExpiration":60, "connectionFactoryType": "DEFAULT"}, "inMemoryConfiguration": {"defaultPutExpiration":60}, "nativePersistenceConfiguration": {"defaultPutExpiration":60, "defaultCleanupBatchSize": 10000}, "redisConfiguration":{"servers":"localhost:6379", "defaultPutExpiration": 60}}'], 'jansDocStoreConf': ['{"documentStoreType":"LOCAL","localConfiguration":{"baseLocation":"/"},"jcaConfiguration":{"serverUrl":"http://localhost:8080/rmi","workspaceName":"default","connectionTimeout":15,"userId":"admin","password":""},"webDavConfiguration":null}'], 'jansDbAuth': ['{"type": "auth", "name": null, "level": 0, "priority": 1, "enabled": false, "version": 0, "config": {"configId": "auth_ldap_server",           "servers": ["localhost:1636"],           "maxConnections": 1000,           "bindDN": "cn=directory manager",           "bindPassword": "4Z9yYHSlcU8rIEnizSz5lA==",           "useSSL": "true",           "baseDNs": ["ou=people,o=jans"],           "primaryKey": "uid",           "localPrimaryKey": "uid",           "useAnonymousBind": false,           "enabled": false} }'], 'jansOrgProfileMgt': ['false'], 'jansScimEnabled': ['false'], 'objectClass': ['top', 'jansAppConf'], 'ou': ['configuration']}
11:35:19 06/21/21 Importing entries from /opt/jans/jans-setup/static/metric/o_metric.ldif
11:35:19 06/21/21 Querying LDAP for dn o=metric
11:35:19 06/21/21 Adding LDAP dn:o=metric entry:{'objectClass': ['top', 'organization'], 'o': ['site']}
11:35:19 06/21/21 Querying LDAP for dn ou=statistic,o=metric
11:35:19 06/21/21 Adding LDAP dn:ou=statistic,o=metric entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['statistic']}
11:35:19 06/21/21 Importing entries from /opt/jans/jans-setup/static/cache-refresh/o_site.ldif
11:35:19 06/21/21 Querying LDAP for dn o=site
11:35:19 06/21/21 Adding LDAP dn:o=site entry:{'objectClass': ['top', 'organization'], 'o': ['site']}
11:35:19 06/21/21 Querying LDAP for dn ou=cache-refresh,o=site
11:35:19 06/21/21 Adding LDAP dn:ou=cache-refresh,o=site entry:{'objectClass': ['top', 'organizationalUnit'], 'ou': ['people']}
11:35:19 06/21/21 Running: /usr/bin/systemctl enable opendj
11:35:19 06/21/21 Run: /usr/bin/systemctl enable opendj with result code: 0
11:35:19 06/21/21 Configuring apache2
11:35:19 06/21/21 Running: /usr/bin/systemctl stop apache2
11:35:19 06/21/21 Run: /usr/bin/systemctl stop apache2 with result code: 0
11:35:19 06/21/21 Rendering template /opt/jans/jans-setup/templates/apache/httpd.conf
11:35:19 06/21/21 Reading file /opt/jans/jans-setup/templates/apache/httpd.conf
11:35:19 06/21/21 Writing file /opt/jans/jans-setup/output/apache/httpd.conf
11:35:19 06/21/21 Rendering template /opt/jans/jans-setup/templates/apache/https_jans.conf
11:35:19 06/21/21 Reading file /opt/jans/jans-setup/templates/apache/https_jans.conf
11:35:19 06/21/21 Writing file /opt/jans/jans-setup/output/apache/https_jans.conf
11:35:19 06/21/21 Rendering template /opt/jans/jans-setup/templates/apache/httpd_2.4.conf
11:35:19 06/21/21 Reading file /opt/jans/jans-setup/templates/apache/httpd_2.4.conf
11:35:19 06/21/21 Writing file /opt/jans/jans-setup/output/apache/httpd_2.4.conf
11:35:19 06/21/21 Rendering template /opt/jans/jans-setup/templates/apache/https_jans.conf
11:35:19 06/21/21 Reading file /opt/jans/jans-setup/templates/apache/https_jans.conf
11:35:19 06/21/21 Writing file /opt/jans/jans-setup/output/apache/https_jans.conf
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/output/apache/https_jans.conf to /etc/apache2/sites-available/https_jans.conf
11:35:19 06/21/21 Copied /opt/jans/jans-setup/output/apache/https_jans.conf to /etc/apache2/sites-available/https_jans.conf
11:35:19 06/21/21 Running: /bin/ln -s /etc/apache2/sites-available/https_jans.conf /etc/apache2/sites-enabled/https_jans.conf
11:35:19 06/21/21 Writing file /var/www/html/index.html
11:35:19 06/21/21 Writing file /etc/apache2/mods-available/alias.conf
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/templates/apache/error_pages/custom_404.html to /var/www/html
11:35:19 06/21/21 Copied /opt/jans/jans-setup/templates/apache/error_pages/custom_404.html to /var/www/html
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/templates/apache/error_pages/custom_502.html to /var/www/html
11:35:19 06/21/21 Copied /opt/jans/jans-setup/templates/apache/error_pages/custom_502.html to /var/www/html
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/templates/apache/error_pages/custom_503.html to /var/www/html
11:35:19 06/21/21 Copied /opt/jans/jans-setup/templates/apache/error_pages/custom_503.html to /var/www/html
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/templates/apache/error_pages/custom_504.html to /var/www/html
11:35:19 06/21/21 Copied /opt/jans/jans-setup/templates/apache/error_pages/custom_504.html to /var/www/html
11:35:19 06/21/21 Copying file /opt/jans/jans-setup/templates/apache/error_pages/custom_500.html to /var/www/html
11:35:19 06/21/21 Copied /opt/jans/jans-setup/templates/apache/error_pages/custom_500.html to /var/www/html
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/authn_file.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/negotiation.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/dir.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/status.conf
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/status.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/dir.conf
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/autoindex.conf
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/autoindex.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/filter.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/deflate.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/deflate.conf
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/authz_user.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/auth_basic.load
11:35:19 06/21/21 Running: /usr/sbin/a2dismod /etc/apache2/mods-enabled/negotiation.conf
11:35:19 06/21/21 Running: /usr/sbin/a2enmod env
11:35:19 06/21/21 Module env already enabled

11:35:19 06/21/21 Running: /usr/sbin/a2enmod proxy_http
11:35:19 06/21/21 Considering dependency proxy for proxy_http:
Module proxy already enabled
Module proxy_http already enabled

11:35:19 06/21/21 Running: /usr/sbin/a2enmod access_compat
11:35:20 06/21/21 Considering dependency authn_core for access_compat:
Module authn_core already enabled
Module access_compat already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod alias
11:35:20 06/21/21 Module alias already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod authn_core
11:35:20 06/21/21 Module authn_core already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod authz_core
11:35:20 06/21/21 Module authz_core already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod authz_host
11:35:20 06/21/21 Considering dependency authz_core for authz_host:
Module authz_core already enabled
Module authz_host already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod headers
11:35:20 06/21/21 Module headers already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod mime
11:35:20 06/21/21 Module mime already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod mpm_event
11:35:20 06/21/21 Considering conflict mpm_worker for mpm_event:
Considering conflict mpm_prefork for mpm_event:
Module mpm_event already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod proxy
11:35:20 06/21/21 Module proxy already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod proxy_ajp
11:35:20 06/21/21 Considering dependency proxy for proxy_ajp:
Module proxy already enabled
Module proxy_ajp already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod security2
11:35:20 06/21/21 Running: /usr/sbin/a2enmod reqtimeout
11:35:20 06/21/21 Module reqtimeout already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod setenvif
11:35:20 06/21/21 Module setenvif already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod socache_shmcb
11:35:20 06/21/21 Module socache_shmcb already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod ssl
11:35:20 06/21/21 Considering dependency setenvif for ssl:
Module setenvif already enabled
Considering dependency mime for ssl:
Module mime already enabled
Considering dependency socache_shmcb for ssl:
Module socache_shmcb already enabled
Module ssl already enabled

11:35:20 06/21/21 Running: /usr/sbin/a2enmod unique_id
11:35:20 06/21/21 Module unique_id already enabled

11:35:20 06/21/21 Generating Certificate for httpd
11:35:20 06/21/21 Running: /usr/bin/openssl genrsa -des3 -out /etc/certs/httpd.key.orig -passout pass:Ep4maz39jt18 2048
11:35:20 06/21/21 Running: /usr/bin/openssl rsa -in /etc/certs/httpd.key.orig -passin pass:Ep4maz39jt18 -out /etc/certs/httpd.key
11:35:20 06/21/21 Running: /usr/bin/openssl req -new -key /etc/certs/httpd.key -out /etc/certs/httpd.csr -subj /C=in/ST=gj/L=ah/O=gluu org/CN=test.dd.jans.io/emailAddress=dhaval@gluu.org
11:35:20 06/21/21 Running: /usr/bin/openssl x509 -req -days 365 -in /etc/certs/httpd.csr -signkey /etc/certs/httpd.key -out /etc/certs/httpd.crt
11:35:20 06/21/21 Running: /bin/chown jetty:jetty /etc/certs/httpd.key.orig
11:35:20 06/21/21 Running: /bin/chmod 700 /etc/certs/httpd.key.orig
11:35:20 06/21/21 Running: /bin/chown jetty:jetty /etc/certs/httpd.key
11:35:20 06/21/21 Running: /bin/chmod 700 /etc/certs/httpd.key
11:35:20 06/21/21 Running: /opt/jre/bin/keytool -import -trustcacerts -alias test.dd.jans.io_httpd -file /etc/certs/httpd.crt -keystore /opt/jre/jre/lib/security/cacerts -storepass changeit -noprompt
11:35:21 06/21/21 Running: /usr/bin/systemctl enable apache2
11:35:21 06/21/21 Run: /usr/bin/systemctl enable apache2 with result code: 0
11:35:21 06/21/21 Running: /usr/bin/systemctl start apache2
11:35:21 06/21/21 Run: /usr/bin/systemctl start apache2 with result code: 0
11:35:21 06/21/21 Installing Jans-Auth
11:35:21 06/21/21 Bind to database
11:35:21 06/21/21 Copying file /opt/jans/jans-setup/static/system/systemd/jans-auth.service to /etc/systemd/system
11:35:21 06/21/21 Copied /opt/jans/jans-setup/static/system/systemd/jans-auth.service to /etc/systemd/system
11:35:21 06/21/21 Copying auth.war into jetty webapps folder...
11:35:21 06/21/21 Installing jetty service jans-auth...
11:35:21 06/21/21 Preparing jans-auth service base folders
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth/custom
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth/custom/pages
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth/custom/i18n
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth/custom/static
11:35:21 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-auth/custom/libs
11:35:21 06/21/21 Preparing jans-auth service base configuration
11:35:21 06/21/21 Running: /opt/jre/bin/java -jar /opt/jetty/start.jar jetty.home=/opt/jetty jetty.base=/opt/jans/jetty/jans-auth --add-to-start=server,deploy,annotations,resources,http,http-forwarded,threadpool,console-capture,jsp,websocket
11:35:22 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jetty/jans-auth
11:35:22 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-auth
11:35:22 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-auth
11:35:22 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-auth
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-auth to /etc/default
11:35:22 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-auth to /etc/default
11:35:22 06/21/21 Running: /bin/chown root:root /etc/default/jans-auth
11:35:22 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-auth_web_resources.xml
11:35:22 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-auth_web_resources.xml
11:35:22 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-auth_web_resources.xml
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-auth_web_resources.xml to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-auth_web_resources.xml to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-auth.xml
11:35:22 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-auth.xml
11:35:22 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-auth.xml
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-auth.xml to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-auth.xml to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Running: /bin/chmod +x /opt/dist/scripts/jans-auth
11:35:22 06/21/21 Creating 'jetty.conf' tmpfiles daemon file
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:22 06/21/21 Copied /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:22 06/21/21 Running: /bin/chown root:root /usr/lib/tmpfiles.d/jetty.conf
11:35:22 06/21/21 Running: /bin/chmod 644 /usr/lib/tmpfiles.d/jetty.conf
11:35:22 06/21/21 Copying file /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-auth
11:35:22 06/21/21 Copied /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-auth
11:35:22 06/21/21 Seeting jetty parameter jetty.httpConfig.sendServerVersion=false for service jans-auth
11:35:22 06/21/21 Reading file /opt/jans/jetty/jans-auth/start.ini
11:35:22 06/21/21 Writing file /opt/jans/jetty/jans-auth/start.ini
11:35:22 06/21/21 Running: cp -f /opt/jans/jetty/jans-auth/start.ini /opt/jans/jetty/jans-auth/start.ini.jans-1.0.0-1~
11:35:22 06/21/21 Copying file /opt/dist/jans/jans-auth.war to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Copied /opt/dist/jans/jans-auth.war to /opt/jans/jetty/jans-auth/webapps
11:35:22 06/21/21 Running: /usr/bin/systemctl enable jans-auth
11:35:22 06/21/21 Run: /usr/bin/systemctl enable jans-auth with result code: 0
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/lib/duo_web.py to /opt/jans/python/libs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/lib/duo_web.py to /opt/jans/python/libs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/duo_creds.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/duo_creds.json to /etc/certs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/gplus_client_secrets.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/gplus_client_secrets.json to /etc/certs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/super_gluu_creds.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/super_gluu_creds.json to /etc/certs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/vericloud_jans_creds.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/vericloud_jans_creds.json to /etc/certs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/cert_creds.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/cert_creds.json to /etc/certs
11:35:22 06/21/21 Copying file /opt/jans/jans-setup/static/auth/conf/otp_configuration.json to /etc/certs
11:35:22 06/21/21 Copied /opt/jans/jans-setup/static/auth/conf/otp_configuration.json to /etc/certs
11:35:22 06/21/21 Checking ID for client oxauth_client_id
11:35:22 06/21/21 Searching database for dn ou=clients,o=jans with filter (&(inum=1001.*)(objectClass=jansClnt))
11:35:22 06/21/21 Client ID for oxauth_client_id was created as 1001.0eda93d4-65d9-456f-888a-92e28f2f12f5
11:35:22 06/21/21 Generating OAuth openid keys
11:35:22 06/21/21 Generating oxAuth OpenID Connect keys
11:35:22 06/21/21 Creating empty JKS keystore
11:35:22 06/21/21 Running: /opt/jre/bin/keytool -genkey -alias dummy -keystore /etc/certs/jans-auth-keys.jks -storepass Gblv8hQoN7U7 -keypass Gblv8hQoN7U7 -dname "CN=Jans Auth CA Certificates"
11:35:23 06/21/21 Running: /opt/jre/bin/keytool -delete -alias dummy -keystore /etc/certs/jans-auth-keys.jks -storepass Gblv8hQoN7U7 -keypass Gblv8hQoN7U7 -dname "CN=Jans Auth CA Certificates"
11:35:23 06/21/21 Running: /opt/jre/bin/java -Dlog4j.defaultInitOverride=true -cp /opt/dist/jans/jans-auth-client-jar-with-dependencies.jar io.jans.as.client.util.KeyGenerator -keystore /etc/certs/jans-auth-keys.jks -keypasswd Gblv8hQoN7U7 -sig_keys RS256 RS384 RS512 ES256 ES384 ES512 PS256 PS384 PS512 -enc_keys RSA1_5 RSA-OAEP -dnname "CN=Jans Auth CA Certificates" -expiration 2
11:35:28 06/21/21 {
  "keys" : [ {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "be6f1798-c4ee-4666-96d1-94c8b63d9976_sig_rs256",
    "x5c" : [ "MIIDCTCCAfGgAwIBAgIgUGqfwqOT+uiN2J6N1GL9+tO+V4MgIEn0VGPiE0biHZ4wDQYJKoZIhvcNAQELBQAwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTRaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCL3+X2cSGB2HDgR7SM1jB0V43N5Op4KiWgmPXjsnTOFG6iO0l23oc8i1OVBZoauEw8MJMYYDU5iqlr76qHLExfT8n0VdknrdVBOHvoBOvW7p8JsxrZV+Ps9B3zoIdmzTEjDi77CUCfU6lFFmYP/j6nDryic6ea82jjCtk/qJaYfsa8Zy8737tlUuIOrEvzpqqe/MZKVjBi3PN6ea8cxYHksUKYMD5msyx/ALYwOyEUC8oeZBSENmoARrAgDEN5bmstV6V12bHSRkmQIdW5o6PV9Jj3mgpGDY2jZvzlHvvhkK0UolneRVAko1y9VEXa3eHsD/RhEc8Bce4QVPOeXVxRAgMBAAGjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADANBgkqhkiG9w0BAQsFAAOCAQEAK5/EorowkxDYUSm0l46WsI9qsG9S2mkcyWSQNuA2QxRVhSYquAFGLo4fwaTK2HFSTwVFc7rLSPyG6o2QQAmLIod0ri5I3KosfUYnX3N11XqGklCdd3H2W8MUSo1g9bzvvTiC8MjT540OW7Szb/r8j6+Z1Cwqpu1xSIDtK0DGU15XOlhNc+UDm6kCc0+43UmHluOc5N4ccpExG9AMaIs9C6n+341z0WYL6Ft7Dv/q6ZIARI2+GqGtTOIpR9tsnfxQjxaJ3VVkcL5t9i644kJ3sZv22Y/m2Qa/qGqiX2OaBvMV58ttoPOb3OHDDaP4zYiuC8r2zUhHJJj8IZzNFkDfdw==" ],
    "exp" : 1624448124602,
    "alg" : "RS256",
    "n" : "i9_l9nEhgdhw4Ee0jNYwdFeNzeTqeColoJj147J0zhRuojtJdt6HPItTlQWaGrhMPDCTGGA1OYqpa--qhyxMX0_J9FXZJ63VQTh76ATr1u6fCbMa2Vfj7PQd86CHZs0xIw4u-wlAn1OpRRZmD_4-pw68onOnmvNo4wrZP6iWmH7GvGcvO9-7ZVLiDqxL86aqnvzGSlYwYtzzenmvHMWB5LFCmDA-ZrMsfwC2MDshFAvKHmQUhDZqAEawIAxDeW5rLVelddmx0kZJkCHVuaOj1fSY95oKRg2No2b85R774ZCtFKJZ3kVQJKNcvVRF2t3h7A_0YRHPAXHuEFTznl1cUQ"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "d3446f8c-631c-4faa-9201-b88e1cf8b3e8_sig_rs384",
    "x5c" : [ "MIIDCTCCAfGgAwIBAgIgS3eTNbw9BjuOg9Qmi4X/vGLhA//kktUO2rWJFZdLnOcwDQYJKoZIhvcNAQEMBQAwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTVaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCzMA5CLIscpiwUZXDSC3rtYrtfON2D5OdSHJvF7HaCDbGw7Emw9nRBM7558SkSo0uVDIVML0ykXuouzfyvwLBRHVhBNpaT2RSGLSlPALdHmT3Vz7O2blVPWBsp6RMLLnhvK60vRGJ98kWbtptbRP9gK7ARPVLzyMqAocPcX15LgXzAihDdmiK3ysSm6N98gwom0oUr1BnKGLmZ4N3MYnV7gE3HN032dgcOfqtuJy8FztfgYONmtQrhP91EUYrIFQhuOM+ltQwrX3klt4CbuPjWp9RJJ+hMwPF6gYne7YaSraXQxAmBHj8vT01XPMjnbpd0me32C5odVuNTbc2/jbQ1AgMBAAGjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADANBgkqhkiG9w0BAQwFAAOCAQEAZPRSLj6WMKIdzjTLS476q2wfWmag7E//M/JbzB0rd4ZFow4MARYsf7v4v4awl9waddqp1K/VnAfiUpnqa3udfiyMgKoPcwRtT7wxrP8KUwSM6EgLf5xnp3i0+E/UVyTPGTr5fN3IXw2NCM/a/AEcM4WjTAP9GP4MDhPljs7ljAeCNiGS/ylUzGLsu6bHVAd4TEWx4askhPZFdh18eaBLw/QvPOPaAFprIvTP/7rDLR3Yv/IQgNi3altZOKqA8kUURBJ8QwI2vWmv0kJNyNSMrpRkKz9kGulR7481oigocmlsBOH15BxP8xEJxHEPdwSmnj06dz6avgwlHUkdHZ+kCQ==" ],
    "exp" : 1624448124602,
    "alg" : "RS384",
    "n" : "szAOQiyLHKYsFGVw0gt67WK7Xzjdg-TnUhybxex2gg2xsOxJsPZ0QTO-efEpEqNLlQyFTC9MpF7qLs38r8CwUR1YQTaWk9kUhi0pTwC3R5k91c-ztm5VT1gbKekTCy54byutL0RiffJFm7abW0T_YCuwET1S88jKgKHD3F9eS4F8wIoQ3Zoit8rEpujffIMKJtKFK9QZyhi5meDdzGJ1e4BNxzdN9nYHDn6rbicvBc7X4GDjZrUK4T_dRFGKyBUIbjjPpbUMK195JbeAm7j41qfUSSfoTMDxeoGJ3u2Gkq2l0MQJgR4_L09NVzzI526XdJnt9guaHVbjU23Nv420NQ"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "347d188f-373d-45f4-a01f-f2340d8542c0_sig_rs512",
    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAI1d0gC+QMhGqOm3XL6qHqTTT+d/rFhqgTfXTtTwXrg4MA0GCSqGSIb3DQEBDQUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE2WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzKpmC4KzNYhmM4ul++hp7rRLPGN/oUjBV76iu5DM+MD5IL5A5LteuFK6U9WbFxjCQKlTLt53G4xFjoYIQlt1FXmal+tlgVB9SvrNQkNptRzyN2ikboSO7ajJfytavHleZTnepygCoQU1ymYXhOsj8wg65dCB29fu/cOKU4KNmyeGPqGX6+sz33Qi47ge4WMuM2UkIBjG9v0UwW7gTsIGDUjViXM1x6QeQVPNfvmJayYZxKodOyVCd+jsFhRDp9xiN1uQqhWbhNQZfu+sPHScdWEOXMmITu0YD7yD2c4oUGB3/hIh4nFqrTBtGg8h5f5a65y471W8K5rTOqyjjaKRPwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQENBQADggEBAEOF37tzSk74eIqYx42+1VPIcj1q7dfJ7N66eSWPBLfcDMm8RSb57zL6yqH7DHD5OT+TUf6bvjxnT/+V7nf3wqmEXmngCDlvEZ/17vMv4AzHggSPbR4DQlLAjWOpS4PEeJbxKg2/4if7Q6VluuhahQQNPHzh3nBbJ8s90AHxi4C31G01t4hcXa7jEsy5pYcPnDx1P/ogxMDtuLk+FNcVqm9AUU27h63M/h5lcE952tX1BcoBroQx/dGsWMa517yoRJEkbHEQABaCOXTaSXlvDPqwZo39f6X6FGmiMx15QV+WVLbJ0MVAvRr6FbxetzphprxkpE7mcOOOx6RsuGmxtQQ=" ],
    "exp" : 1624448124602,
    "alg" : "RS512",
    "n" : "zKpmC4KzNYhmM4ul--hp7rRLPGN_oUjBV76iu5DM-MD5IL5A5LteuFK6U9WbFxjCQKlTLt53G4xFjoYIQlt1FXmal-tlgVB9SvrNQkNptRzyN2ikboSO7ajJfytavHleZTnepygCoQU1ymYXhOsj8wg65dCB29fu_cOKU4KNmyeGPqGX6-sz33Qi47ge4WMuM2UkIBjG9v0UwW7gTsIGDUjViXM1x6QeQVPNfvmJayYZxKodOyVCd-jsFhRDp9xiN1uQqhWbhNQZfu-sPHScdWEOXMmITu0YD7yD2c4oUGB3_hIh4nFqrTBtGg8h5f5a65y471W8K5rTOqyjjaKRPw"
  }, {
    "kty" : "EC",
    "use" : "sig",
    "crv" : "P-256",
    "kid" : "e9f259dd-0020-424a-8653-36186e84b938_sig_es256",
    "x5c" : [ "MIIBfTCCASOgAwIBAgIgApEkB3oY3Zw5hcPOJj40rjxMxujNVB8Mkz/7MSyyIz4wCgYIKoZIzj0EAwIwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTZaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARgL6oKEKf5NCAIWtvOegvhS4XAdxuKLLGosACMWV6tFb+Vjp5R7XSjks2/8rTJUEXkefT+Nem4AO5uUANDGFIPoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwCgYIKoZIzj0EAwIDSAAwRQIhAITLXgBgx0VZuZvFHpfIcAPdwWcxX7MZRvqyYZ/qxEjkAiAD+s6KKx5aDUf4qC5/yLRClABLRhTsF2DcBcom1rr2AA==" ],
    "x" : "YC-qChCn-TQgCFrbznoL4UuFwHcbiiyxqLAAjFlerRU",
    "y" : "AL-Vjp5R7XSjks2_8rTJUEXkefT-Nem4AO5uUANDGFIP",
    "exp" : 1624448124602,
    "alg" : "ES256"
  }, {
    "kty" : "EC",
    "use" : "sig",
    "crv" : "P-384",
    "kid" : "425ea5da-d3ba-4d79-a3a8-3b848c598163_sig_es384",
    "x5c" : [ "MIIBujCCAUCgAwIBAgIgDU/Ae1sy6CLuTsKjwx7eBFF43lf94+1FIW7ScbQkq14wCgYIKoZIzj0EAwMwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTZaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAATdN4T4EUDHruouBmc8E1BXdSu2t4LXnph+zF62Sv/MPF5mnYXljQWkyzp7OQntqpvaIceQBLWxYQq83rX69LwJ2DhzrIORHtBTElAGyMWaWiUHmua0jhuQpdlpqFlcS5+jJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADAKBggqhkjOPQQDAwNoADBlAjACjwTsOOQjBqRNYSLFX9lPf12/gssSY0xsxJhxcm4EeN07qTzVW8uMu7+yUzNSbq0CMQCJtva13VryEsZ2eKyp26YTQ5fLbikhtWBOL4UNPq+5ZsW5GtxLjfnG4221vdpM6Xc=" ],
    "x" : "AN03hPgRQMeu6i4GZzwTUFd1K7a3gteemH7MXrZK_8w8XmadheWNBaTLOns5Ce2qmw",
    "y" : "ANohx5AEtbFhCrzetfr0vAnYOHOsg5Ee0FMSUAbIxZpaJQea5rSOG5Cl2WmoWVxLnw",
    "exp" : 1624448124602,
    "alg" : "ES384"
  }, {
    "kty" : "EC",
    "use" : "sig",
    "crv" : "P-521",
    "kid" : "c468ea93-393b-4846-a8e2-e48f173a5db4_sig_es512",
    "x5c" : [ "MIICBTCCAWegAwIBAgIhAMpGwf4XI7l3Sy8p648/Xy3oAt4wo3cHRA3hJCRzHdVSMAoGCCqGSM49BAMEMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE2WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQBll7Ra+QqAce/sIhU2kJP9Bbn8bMo6JYy1f7qjXlmb89ODrcOneTUmE7iDBa+oIfMYm7CNH2K4cfJNXm2mPFRQi8AwLEPAdgv6VTXcqD1EU21YP/rSSacsv1d/X6jg/Ee5tlsm5sRE+2E7WHk22yQgORT2ORLwuZbGBqBBbMObUIyMBKjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADAKBggqhkjOPQQDBAOBiwAwgYcCQgDm8r/D1kSDog8sua8qDb/wAi5/f+dTJ7H4EMwdc+9JLiVkg5zakj+/D3xjS9h2TyYpiEb0qzZ5Gqbu/Vih3JICeQJBYoUAvqLCIJDOgjfbjW5UzCLed356ffd4Qjmk1D5RparwybuRX3E58mdAmAPHBQq3zTcNPVB4HgxIPT97eMrA+Wg=" ],
    "x" : "AZZe0WvkKgHHv7CIVNpCT_QW5_GzKOiWMtX-6o15Zm_PTg63Dp3k1JhO4gwWvqCHzGJuwjR9iuHHyTV5tpjxUUIv",
    "y" : "AMCxDwHYL-lU13Kg9RFNtWD_60kmnLL9Xf1-o4PxHubZbJubERPthO1h5NtskIDkU9jkS8LmWxgagQWzDm1CMjAS",
    "exp" : 1624448124602,
    "alg" : "ES512"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "dfa48be5-3fa2-44ba-83ca-a528dbf7eee1_sig_ps256",
    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgDgMVuuoR7STMKXG5yWwJSS4yGMQ0bclXJL7glNI4MxswQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgEFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgEFAKIDAgEgMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE3WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtXkp4jVfR48RtW7CEo9b9pYXHjeMsCvgPPSlmEOvk7kqtu3wBf3haTkty1qABncvW358RuZILKIHpS969kTbnYwAIbWR3NzUK49GOM+w8nUmq7a6N3vP/AofmLowlAj2oxzwIn4sZHFVDqGKXg3C+eUuGTHK0p5llbnJIpiERr+6DwjjljGSTBtYNz334bf5+VYB9i8yNzTEkW2+4xyOvjmtfP9RwWllEMWon1RXkRlUCcVzgKOhohnl2vmK4BJUWJ/mKAprQgqlIOe/jOCs1UYnIn049Q7JNdseptiFCE+aunWEUzJPTTd+b70lzG8LnGO2vYAHhmou945JcCGTZQIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgEFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgEFAKIDAgEgA4IBAQAiDo2kyZP3TQ+y1iWBbVSEV/Dk4zbdLvMcj5S5XH2TBv1mtUtfeYXTHijUva5OlnEoPHO2Z071tpK2uFkhDnNCOskjZrMEGwAe2v/O6pwCjcF2KDA21CD3/6tMEuBQtL0pfs4VEGGg7lakWx4hg12l39KBh0JEEZwUZ9iSnIbDzOVF213pmRi9Ro0T+RbfnZ9Ct/5ho24Cd3I8dpg5rtBzE9TMAO/DbLX36dd1tQCSSawbbXGKeJ2ETSIMf3fPQxRsS8dKF6GXI6RNmJ4vekgw9FLRGtevonlLrzrxa1kfvF5dcOQqoQISNKaTP9JZFCP6via/m0g95XIIZL01C0Zy" ],
    "exp" : 1624448124602,
    "alg" : "PS256",
    "n" : "tXkp4jVfR48RtW7CEo9b9pYXHjeMsCvgPPSlmEOvk7kqtu3wBf3haTkty1qABncvW358RuZILKIHpS969kTbnYwAIbWR3NzUK49GOM-w8nUmq7a6N3vP_AofmLowlAj2oxzwIn4sZHFVDqGKXg3C-eUuGTHK0p5llbnJIpiERr-6DwjjljGSTBtYNz334bf5-VYB9i8yNzTEkW2-4xyOvjmtfP9RwWllEMWon1RXkRlUCcVzgKOhohnl2vmK4BJUWJ_mKAprQgqlIOe_jOCs1UYnIn049Q7JNdseptiFCE-aunWEUzJPTTd-b70lzG8LnGO2vYAHhmou945JcCGTZQ"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "2cab0f42-13c0-4d04-9570-3856245b7845_sig_ps384",
    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgRU1KLGepGaIrJrFuUmkooBc3Sv9yRSKfHLxqiT82pZ0wQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgIFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgIFAKIDAgEwMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE3WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwoDWlAtmUJ5bRnW7rV6+8s36fB2Yyppm7JLI9pQ/32pfMtE0D367R+SpGBgLrWnJng2Z/lzMcrvzqtlapLuCzff1WarDl5y40m7kSZ9VEpIiyPgkerprshBuB8c1Lebx46afeJNkiKiNbullWzJi+Oru+fdNII1N95ktjP2h47pv5U4KHgvW7cKItGEOcKqBw0x+9aMUvMixwjb6FiuuuKevDOL1Notnh+ILTnnUqXpSslK+85IoeEzlUM1pcm5CH3R/1DZVUXLwesi1poiQp2o4G01OdfkVE4EpWfI83v7T3yHjsjbO6PqcHlerKxjbeT49sZ4HwQvV068goPIRTwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgIFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgIFAKIDAgEwA4IBAQAuhqAeTjZ8CIWLMxuBj2pXw20mS4XpI1Am4ByBcdsLbvW5tlHi692pooGWIRFJqTwpDwFPtNM0rf6P4cFRBmzjdJpskas+H91Rd3hswSMvzNb1WBZWpjYFwJTfHRof8+slQRQa+yk8KpYGUuZ7d5aFRczWkojAaPnm8Xf5I2vlNCN/+5Ghlowp+xWr35W1VgQgljZcrXQY//dGClI93vy3kMHYBWHEBUX14vIpE+PNUKyJZgcfbwgfcwpgX4YImSxCEdshVhJlYKP+CbxQiC4WOW9LaIjj4EiMh41vrKEGKeO7Mmoj7RmTvKwzZNyaA4KxFjyYTZPX3dLtUwQ5s08b" ],
    "exp" : 1624448124602,
    "alg" : "PS384",
    "n" : "woDWlAtmUJ5bRnW7rV6-8s36fB2Yyppm7JLI9pQ_32pfMtE0D367R-SpGBgLrWnJng2Z_lzMcrvzqtlapLuCzff1WarDl5y40m7kSZ9VEpIiyPgkerprshBuB8c1Lebx46afeJNkiKiNbullWzJi-Oru-fdNII1N95ktjP2h47pv5U4KHgvW7cKItGEOcKqBw0x-9aMUvMixwjb6FiuuuKevDOL1Notnh-ILTnnUqXpSslK-85IoeEzlUM1pcm5CH3R_1DZVUXLwesi1poiQp2o4G01OdfkVE4EpWfI83v7T3yHjsjbO6PqcHlerKxjbeT49sZ4HwQvV068goPIRTw"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "sig",
    "crv" : "",
    "kid" : "b58649e2-3b4c-489a-96da-bf6a40413133_sig_ps512",
    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgLSP1zTFOnL24KN7yogmcMB/KRferymSvPrbhgjp1xsowQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgMFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgMFAKIDAgFAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvel84rjWHiW/pE27/KFB0U61g5YqyfNp7WPTh0YCPb/fHl1+A0BHKeGmtewJMwwcqVIYuLLr1b+rcykbkOEf4/sPpQcuoX7DCcFP5LhxH7cERH7JyV2JVgCDTN+LIxe9R15uMyFkCmE2zdnvqaLRic/Pv7Ke2Thv+ydMDk7YI6AsnpelXIzKjeQs8Cq8SWde0y9hHSFeY0RRy2dF4qcsu45B5XDIXe6TBjSIQmidtMPrpCEiNGN8sjUNzLbMi8ou/v6SiyABosKxITV5fT3KscYofX6eRGvYlwVYA2naqKv49cCNTt2gmbcfporBX8we6DMJ9YbGBjmoo/skfcxvuwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgMFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgMFAKIDAgFAA4IBAQAk/y0IBh1TjSRXl9WWtAPEhKgKvGOFH5gw65yshk9F8EP+tEG+6UN+/3YJJxkYvun3Ln8BPBY+R8In4rL1WtJ1D3D/yYBi064z2bPqyOcjDuqaPAibfPi9KfRFnAHnEORxuJ+GL1ROG13SxmZR0Sonl+cLiuKVPuO5S40YSFumNmzzBtHfOZKSewwaoMp8tFcQrpCryNhc0obxKFyRUBdtJRb2uxWqY32BrkFOX8q9ZCNW1CEnLXj4wOZ1vOAzBTEnd9FvJP3VtEB/BZHxHESbifXMoHZBJ+8/d7rnylstHcU355eH4b+Wu9grcNkADIgaLRtWlzKAJYmauBwS1maq" ],
    "exp" : 1624448124602,
    "alg" : "PS512",
    "n" : "vel84rjWHiW_pE27_KFB0U61g5YqyfNp7WPTh0YCPb_fHl1-A0BHKeGmtewJMwwcqVIYuLLr1b-rcykbkOEf4_sPpQcuoX7DCcFP5LhxH7cERH7JyV2JVgCDTN-LIxe9R15uMyFkCmE2zdnvqaLRic_Pv7Ke2Thv-ydMDk7YI6AsnpelXIzKjeQs8Cq8SWde0y9hHSFeY0RRy2dF4qcsu45B5XDIXe6TBjSIQmidtMPrpCEiNGN8sjUNzLbMi8ou_v6SiyABosKxITV5fT3KscYofX6eRGvYlwVYA2naqKv49cCNTt2gmbcfporBX8we6DMJ9YbGBjmoo_skfcxvuw"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "enc",
    "crv" : "",
    "kid" : "c1f2deb0-f069-47fb-b908-1376f1465316_enc_rsa1_5",
    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAOUJKq/Zc6rVTVB//Fa3Rb0br3H9wKvre8TFFNf3b7GxMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz5aYNLRwNlmnp1ssv541Wc3Ma602Op/BvXFUcqARDccQC1pz0AHy0kUnqEPiZRr664QB0UgLWpxkf4OdZ6teOCz/v9aCKWPA079grPxbJEux5gRQ37KVGgmmBEAgPI5HnUHQvBNVRnI2B79QvTFpLlMr5oPSdZPVIz56+TcyzKlNzD25uqwOYnVMJyLozL80dJrRBcwYR0E4Ab+W01bFg1RPm3i7UBHLfVVWyMBIkM+xrW0aR46gDFZw/prQF/HOY/NqRHG1uHmuDkQXpDOSMaS5T6lytkFZod8cKH0fyxTQjon9pS4nanSQwVpNZuMEMLuUvXbJvnZg4wLyRblMNwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAA7JVgfplAKshPvYZd++kE+NxUSiiN/gK7VsEDv6CA9fQ4tmGrOykdcuWiLt3JBGlz72KFmVmW0TPh32EynoVr98U+haD6o4IXt/itrxibF6Joa38fwEWwsAYVe55owq2Brfel7uj2nq1AbQI//tfzI+VCgqBytWyT+9WvYQhVwew0O/o6gv9Qo4IJ1+apHuc9/w8EEEZvUz+5yAq0im9vzeTnf0U4LIXPes10qzvlJuInE7QfZkmUWGQoyNqssfNpObMyc/mPAuynCuXWWCTFxtxt7mSgcLBTzMdB0hcwKwmqmROvZE3eOdQbY610xETgwroLyR6rHQTigOECGY+ns=" ],
    "exp" : 1624448124602,
    "alg" : "RSA1_5",
    "n" : "z5aYNLRwNlmnp1ssv541Wc3Ma602Op_BvXFUcqARDccQC1pz0AHy0kUnqEPiZRr664QB0UgLWpxkf4OdZ6teOCz_v9aCKWPA079grPxbJEux5gRQ37KVGgmmBEAgPI5HnUHQvBNVRnI2B79QvTFpLlMr5oPSdZPVIz56-TcyzKlNzD25uqwOYnVMJyLozL80dJrRBcwYR0E4Ab-W01bFg1RPm3i7UBHLfVVWyMBIkM-xrW0aR46gDFZw_prQF_HOY_NqRHG1uHmuDkQXpDOSMaS5T6lytkFZod8cKH0fyxTQjon9pS4nanSQwVpNZuMEMLuUvXbJvnZg4wLyRblMNw"
  }, {
    "kty" : "RSA",
    "e" : "AQAB",
    "use" : "enc",
    "crv" : "",
    "kid" : "af20de92-1e39-4680-b56e-c383d69ec900_enc_rsa-oaep",
    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAJ1X7MPmJS3kHq0T6r+SZefM6qyUz7lxg/oYZqE72tSIMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu2qkEacXwFCYnUu9BZF0vGExpOcFJt4Z3bQzRfO/MVuo927nfBRNXWjXxZYV91RaH0CRpKMMgr80K7MmbcUDj0utXbhPd5au7mL0+v1ops0qkK58GgnIkB+ibNWMBJIQCWfKUp5BIe1C7zc+hgsbYln+ewwDDQ+WASrSUJ0P+2wz9uLUEUzjFtcXS8YSvNHPui4QZ2lKik7wRZZeKnnYil2578acaBdrOIeFEVZv1/J2wfXdGfZ/BBAXt+DN3mJkxkLYIvfMNnUxtEDAqrjx8imnphLGVaQZG+ZVIQcf4de0f4QR0mnoLlFk1N9Y+RSnD6iBAjeZS2dpMEFRV0d3EQIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBALpI3vQOMjRGC7Xeo3hwwRUXfR346LGEWtfMXEkrQWo7DIebM6IDhuSCkQ3EezDwar6mkIoW2lToEAbRMZnC6zBGg8fIWKzqjuNL/0vE3lS3+E1f8aFt6IIcpou4irk+jjnterTGA9FhFKmHQk2QzhBjQc2CkBNib4h3qVaxTmYiZSXBpSXWk2+p+AYKxOGF5h4DCGyOyykDH9FBC1dnKcbn0nP6KBBzd3L8Wx7LWoBbWE8nqBTF2/XvekEz+mMRERHMYKFyDcDhC1gbEUELGgbi6O9AcwADeheK5ySUPE15q5RzRSBagfeFoEJ2goBrRxRAFwq1lSGkkPvnLRiuaYQ=" ],
    "exp" : 1624448124602,
    "alg" : "RSA-OAEP",
    "n" : "u2qkEacXwFCYnUu9BZF0vGExpOcFJt4Z3bQzRfO_MVuo927nfBRNXWjXxZYV91RaH0CRpKMMgr80K7MmbcUDj0utXbhPd5au7mL0-v1ops0qkK58GgnIkB-ibNWMBJIQCWfKUp5BIe1C7zc-hgsbYln-ewwDDQ-WASrSUJ0P-2wz9uLUEUzjFtcXS8YSvNHPui4QZ2lKik7wRZZeKnnYil2578acaBdrOIeFEVZv1_J2wfXdGfZ_BBAXt-DN3mJkxkLYIvfMNnUxtEDAqrjx8imnphLGVaQZG-ZVIQcf4de0f4QR0mnoLlFk1N9Y-RSnD6iBAjeZS2dpMEFRV0d3EQ"
  } ]
}

11:35:28 06/21/21 Writing oxAuth OpenID Connect keys
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Running: /bin/mkdir -p /opt/jans/jans-setup/output/jans-auth
11:35:28 06/21/21 Running: /bin/chown jetty:jetty /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Running: /bin/chmod 600 /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Wrote oxAuth OpenID Connect key to /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-auth/jans-auth-config.json
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/jans-auth-config.json
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/jans-auth-config.json
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-auth/people.ldif
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/people.ldif
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/people.ldif
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-auth/groups.ldif
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/groups.ldif
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/groups.ldif
11:35:28 06/21/21 Loading file /opt/jans/jans-setup/output/jans-auth/jans-auth-config.json
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/output/jans-auth/jans-auth-config.json
11:35:28 06/21/21 Loading file /opt/jans/jans-setup/templates/jans-auth/jans-auth-static-conf.json
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/jans-auth-static-conf.json
11:35:28 06/21/21 Loading file /opt/jans/jans-setup/templates/jans-auth/jans-auth-errors.json
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/jans-auth-errors.json
11:35:28 06/21/21 Loading file /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/output/jans-auth/jans-auth-keys.json
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/scripts.ldif
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/scripts.ldif
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/scripts.ldif
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-auth/configuration.ldif
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/configuration.ldif
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/configuration.ldif
11:35:28 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-auth/clients.ldif
11:35:28 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-auth/clients.ldif
11:35:28 06/21/21 Writing file /opt/jans/jans-setup/output/jans-auth/clients.ldif
11:35:28 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/jans-auth/configuration.ldif, /opt/jans/jans-setup/output/jans-auth/clients.ldif, /opt/jans/jans-setup/output/scripts.ldif, /opt/jans/jans-setup/output/jans-auth/people.ldif, /opt/jans/jans-setup/output/jans-auth/groups.ldif 
11:35:28 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-auth/configuration.ldif
11:35:28 06/21/21 Querying LDAP for dn ou=jans-auth,ou=configuration,o=jans
11:35:28 06/21/21 Adding LDAP dn:ou=jans-auth,ou=configuration,o=jans entry:{'jansConfDyn': ['{\n    "issuer":"https://test.dd.jans.io",\n    "baseEndpoint":"https://test.dd.jans.io/jans-auth/restv1",\n    "authorizationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/authorize",\n    "tokenEndpoint":"https://test.dd.jans.io/jans-auth/restv1/token",\n    "tokenRevocationEndpoint": "https://test.dd.jans.io/jans-auth/restv1/revoke",\n    "userInfoEndpoint":"https://test.dd.jans.io/jans-auth/restv1/userinfo",\n    "clientInfoEndpoint":"https://test.dd.jans.io/jans-auth/restv1/clientinfo",\n    "checkSessionIFrame":"https://test.dd.jans.io/jans-auth/opiframe.htm",\n    "endSessionEndpoint":"https://test.dd.jans.io/jans-auth/restv1/end_session",\n    "jwksUri":"https://test.dd.jans.io/jans-auth/restv1/jwks",\n    "registrationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/register",\n    "openIdDiscoveryEndpoint":"https://test.dd.jans.io/.well-known/webfinger",\n    "openIdConfigurationEndpoint":"https://test.dd.jans.io/.well-known/openid-configuration",\n    "idGenerationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/id",\n    "introspectionEndpoint":"https://test.dd.jans.io/jans-auth/restv1/introspection",\n    "umaConfigurationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/uma2-configuration",\n    "sectorIdentifierEndpoint":"https://test.dd.jans.io/jans-auth/sectoridentifier",\n    "oxElevenGenerateKeyEndpoint":"https://test.dd.jans.io/oxeleven/rest/oxeleven/generateKey",\n    "oxElevenSignEndpoint":"https://test.dd.jans.io/oxeleven/rest/oxeleven/sign",\n    "oxElevenVerifySignatureEndpoint":"https://test.dd.jans.io/oxeleven/rest/oxeleven/verifySignature",\n    "oxElevenDeleteKeyEndpoint":"https://test.dd.jans.io/oxeleven/rest/oxeleven/deleteKey",\n    "oxElevenJwksEndpoint":"https://test.dd.jans.io/oxeleven/rest/oxeleven/jwks",\n    "backchannelAuthenticationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/bc-authorize",\n    "backchannelDeviceRegistrationEndpoint":"https://test.dd.jans.io/jans-auth/restv1/bc-deviceRegistration",\n    "deviceAuthzEndpoint":"https://test.dd.jans.io/jans-auth/restv1/device_authorization",\n    "openidSubAttribute":"inum",\n    "responseTypesSupported":[\n        ["code"],\n        ["code", "id_token"],\n        ["token"],\n        ["token", "id_token"],\n        ["code", "token"],\n        ["code", "token", "id_token"],\n        ["id_token"]\n    ],\n    "responseModesSupported":[\n        "query",\n        "fragment",\n        "form_post"\n    ],\n    "grantTypesSupported":[\n        "authorization_code",\n        "implicit",\n        "password",\n        "client_credentials",\n        "refresh_token",\n        "urn:ietf:params:oauth:grant-type:uma-ticket",\n        "urn:ietf:params:oauth:grant-type:device_code"\n    ],\n    "subjectTypesSupported":[\n        "public",\n        "pairwise"\n    ],\n    "defaultSubjectType": "pairwise",\n    "userInfoSigningAlgValuesSupported":[\n        "HS256",\n        "HS384",\n        "HS512",\n        "RS256",\n        "RS384",\n        "RS512",\n        "ES256",\n        "ES384",\n        "ES512"\n    ],\n    "userInfoEncryptionAlgValuesSupported":[\n        "RSA1_5",\n        "RSA-OAEP",\n        "A128KW",\n        "A256KW"\n    ],\n    "userInfoEncryptionEncValuesSupported":[\n        "A128CBC+HS256",\n        "A256CBC+HS512",\n        "A128GCM",\n        "A256GCM"\n    ],\n    "idTokenSigningAlgValuesSupported":[\n        "none",\n        "HS256",\n        "HS384",\n        "HS512",\n        "RS256",\n        "RS384",\n        "RS512",\n        "ES256",\n        "ES384",\n        "ES512"\n    ],\n    "idTokenEncryptionAlgValuesSupported":[\n        "RSA1_5",\n        "RSA-OAEP",\n        "A128KW",\n        "A256KW"\n    ],\n    "idTokenEncryptionEncValuesSupported":[\n        "A128CBC+HS256",\n        "A256CBC+HS512",\n        "A128GCM",\n        "A256GCM"\n    ],\n    "requestObjectSigningAlgValuesSupported":[\n        "none",\n        "HS256",\n        "HS384",\n        "HS512",\n        "RS256",\n        "RS384",\n        "RS512",\n        "ES256",\n        "ES384",\n        "ES512"\n    ],\n    "jwksAlgorithmsSupported":[\n        "RS256",\n        "RS384",\n        "RS512",\n        "ES256",\n        "ES384",\n        "ES512",\n        "PS256",\n        "PS384",\n        "PS512",\n        "RSA1_5",\n        "RSA-OAEP"\n    ],\n    "requestObjectEncryptionAlgValuesSupported":[\n        "RSA1_5",\n        "RSA-OAEP",\n        "A128KW",\n        "A256KW"\n    ],\n    "requestObjectEncryptionEncValuesSupported":[\n        "A128CBC+HS256",\n        "A256CBC+HS512",\n        "A128GCM",\n        "A256GCM"\n    ],\n    "tokenEndpointAuthMethodsSupported":[\n        "client_secret_basic",\n        "client_secret_post",\n        "client_secret_jwt",\n        "private_key_jwt",\n        "tls_client_auth",\n        "self_signed_tls_client_auth"\n    ],\n    "tokenEndpointAuthSigningAlgValuesSupported":[\n        "HS256",\n        "HS384",\n        "HS512",\n        "RS256",\n        "RS384",\n        "RS512",\n        "ES256",\n        "ES384",\n        "ES512"\n    ],\n    "dynamicRegistrationCustomAttributes":[\n    ],\n    "displayValuesSupported":[\n        "page",\n        "popup"\n    ],\n    "claimTypesSupported":[\n        "normal"\n    ],\n    "serviceDocumentation":"http://jans.org/docs",\n    "claimsLocalesSupported":[\n        "en"\n    ],\n    "idTokenTokenBindingCnfValuesSupported":[\n        "tbh"\n    ],\n    "uiLocalesSupported":[\n        "en",\n        "bg",\n        "de",\n        "es",\n        "fr",\n        "it",\n        "ru",\n        "tr"\n    ],\n    "dynamicGrantTypeDefault":[\n        "authorization_code",\n        "implicit",\n        "client_credentials",\n        "refresh_token",\n        "urn:ietf:params:oauth:grant-type:uma-ticket",\n        "urn:ietf:params:oauth:grant-type:device_code"\n    ],\n    "claimsParameterSupported":false,\n    "requestParameterSupported":true,\n    "requestUriParameterSupported":true,\n    "requireRequestUriRegistration":false,\n    "allowPostLogoutRedirectWithoutValidation":false,\n    "introspectionAccessTokenMustHaveUmaProtectionScope":false,\n    "requestUriHashVerificationEnabled": false,\n    "idTokenFilterClaimsBasedOnAccessToken": false,\n    "opPolicyUri":"http://www.jans.io/doku.php?id=jans:policy",\n    "opTosUri":"http://www.jans.io/doku.php?id=jans:tos",\n    "authorizationCodeLifetime":60,\n    "refreshTokenLifetime":14400,\n    "idTokenLifetime":3600,\n    "spontaneousScopeLifetime":86400,\n    "accessTokenLifetime":300,\n    "umaResourceLifetime":2592000,\n    "sessionAsJwt":false,\n    "umaRptLifetime": 3600,\n    "umaTicketLifetime": 3600,\n    "umaPctLifetime": 2592000,\n    "umaAddScopesAutomatically":true,\n    "umaValidateClaimToken":false,\n    "umaGrantAccessIfNoPolicies":false,\n    "umaRestrictResourceToAssociatedClient":false,\n    "umaKeepClientDuringResourceSetRegistration":true,\n    "umaRptAsJwt":false,\n    "cleanServiceInterval":60,\n    "cleanServiceBatchChunkSize": 10000,\n    "keyRegenerationEnabled":true,\n    "keyRegenerationInterval":48,\n    "defaultSignatureAlgorithm":"RS256",\n    "oxOpenIdConnectVersion":"openidconnect-1.0",\n    "oxId":"https://test.dd.jans.io/oxid/service/jans/inum",\n    "dynamicRegistrationExpirationTime":-1,\n    "dynamicRegistrationPersistClientAuthorizations":true,\n    "trustedClientEnabled":true,\n    "skipAuthorizationForOpenIdScopeAndPairwiseId": false,\n    "dynamicRegistrationScopesParamEnabled":true,\n    "dynamicRegistrationCustomObjectClass":"",\n    "personCustomObjectClassList":[\n        "jansCustomPerson",\n        "jansPerson"\n    ],\n    "persistIdTokenInLdap":false,\n    "persistRefreshTokenInLdap":true,\n    "authenticationFiltersEnabled":false,\n    "invalidateSessionCookiesAfterAuthorizationFlow":false,\n    "clientAuthenticationFiltersEnabled":false,\n    "clientRegDefaultToCodeFlowWithRefresh": true,\n    "authenticationFilters":[\n        {\n            "filter":"(&(mail=*{0}*)(inum={1}))",\n            "bind":false,\n            "bindPasswordAttribute":"",\n            "baseDn":"ou=people,o=jans"\n        },\n        {\n            "filter":"uid={0}",\n            "bind":true,\n            "bindPasswordAttribute":"pwd",\n            "baseDn":"ou=people,o=jans"\n        }\n    ],\n    "clientAuthenticationFilters":[\n        {\n            "filter":"myCustomAttr1={0}",\n            "bind":"",\n            "bindPasswordAttribute":"",\n            "baseDn":"ou=clients,o=jans"\n        }\n    ],\n    "sessionIdUnusedLifetime":86400,\n    "sessionIdUnauthenticatedUnusedLifetime":120,\n    "sessionIdEnabled":true,\n    "changeSessionIdOnAuthentication":true,\n    "returnClientSecretOnRead": true,\n    "sessionIdPersistOnPromptNone":true,\n    "sessionIdLifetime": 86400,\n    "configurationUpdateInterval":3600,\n    "cssLocation":"",\n    "jsLocation":"",\n    "imgLocation":"",\n    "metricReporterInterval":300,\n    "metricReporterKeepDataDays":15,\n    "metricReporterEnabled": false,\n    "pairwiseIdType":"algorithmic",\n    "pairwiseCalculationKey":"snus1sMDV9f4wll7dGi34bk46Cl",\n    "pairwiseCalculationSalt": "C4hXDPMyGKslRSdYIathR",\n    "shareSubjectIdBetweenClientsWithSameSectorId": true,\n    "webKeysStorage": "keystore",\n    "dnName": "CN=Jans Auth CA Certificates",\n    "keyStoreFile": "/etc/certs/jans-auth-keys.jks",\n    "keyStoreSecret": "Gblv8hQoN7U7",\n    "endSessionWithAccessToken":false,\n    "clientWhiteList": ["*"],\n    "clientBlackList": ["*.attacker.com/*"],\n    "legacyIdTokenClaims": false,\n    "customHeadersWithAuthorizationResponse": true,\n    "frontChannelLogoutSessionSupported":true,\n    "updateUserLastLogonTime": false,\n    "updateClientAccessTime":false,\n    "enableClientGrantTypeUpdate": true,\n    "corsConfigurationFilters": [\n        {\n            "filterName": "CorsFilter",\n            "corsAllowedOrigins": "*",\n            "corsAllowedMethods": "GET,POST,HEAD,OPTIONS",\n            "corsAllowedHeaders": "Origin,Authorization,Accept,X-Requested-With,Content-Type,Access-Control-Request-Method,Access-Control-Request-Headers",\n            "corsExposedHeaders": "",\n            "corsSupportCredentials": true,\n            "corsLoggingEnabled": false,\n            "corsPreflightMaxAge": 1800,\n            "corsRequestDecorate": true,\n            "corsEnabled": true\n        }\n    ],\n    "logClientIdOnClientAuthentication": true,\n    "logClientNameOnClientAuthentication": false,\n    "httpLoggingEnabled": false,\n    "httpLoggingExludePaths": [],\n    "externalLoggerConfiguration": "",\n    "authorizationRequestCustomAllowedParameters" : [\n        "customParam1",\n        "customParam2",\n        "customParam3"\n    ],\n    "legacyDynamicRegistrationScopeParam": false,\n    "openidScopeBackwardCompatibility": false,\n    "disableU2fEndpoint":false,\n    "authenticationProtectionConfiguration": {\n        "attemptExpiration": 15,\n        "maximumAllowedAttemptsWithoutDelay": 4,\n        "delayTime": 2,\n        "bruteForceProtectionEnabled": false\n    },\n    "loggingLevel": "INFO",\n    "loggingLayout": "text",\n    "errorHandlingMethod":"internal",\n    "useLocalCache":true,\n    "backchannelTokenDeliveryModesSupported": [\n        "poll",\n        "ping",\n        "push"\n     ],\n    "backchannelAuthenticationRequestSigningAlgValuesSupported": [],\n    "backchannelClientId": "",\n    "backchannelRedirectUri": "https://test.dd.jans.io/jans-auth/ciba/home.htm",\n    "backchannelUserCodeParameterSupported": false,\n    "backchannelBindingMessagePattern": "^[a-zA-Z0-9]{4,8}$",\n    "backchannelAuthenticationResponseExpiresIn": 3600,\n    "backchannelAuthenticationResponseInterval": 2,\n    "backchannelRequestsProcessorJobIntervalSec": 5,\n    "backchannelRequestsProcessorJobChunkSize": 100,\n    "cibaGrantLifeExtraTimeSec": 180,\n    "cibaMaxExpirationTimeAllowedSec": 1800,\n    "backchannelLoginHintClaims": ["inum", "uid", "mail"],\n    "cibaEnabled": false,\n    "cibaEndUserNotificationConfig": {\n        "apiKey": "",\n        "authDomain": "",\n        "databaseURL": "",\n        "projectId": "",\n        "storageBucket": "",\n        "messagingSenderId": "",\n        "appId": "",\n        "notificationUrl": "",\n        "notificationKey": "",\n        "publicVapidKey": ""\n    },\n    "deviceAuthzRequestExpiresIn": 1800,\n    "deviceAuthzTokenPollInterval": 5,\n    "deviceAuthzResponseTypeToProcessAuthz": "code"\n}\n'], 'jansConfErrors': ['{\n    "authorize":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id": "disabled_client",\n            "description": "The client is disabled and can\'t request an access token using this method.",\n            "uri": null\n        },\n        {\n            "id":"unauthorized_client",\n            "description":"The client is not authorized to request an access token using this method.",\n            "uri":null\n        },\n        {\n            "id":"access_denied",\n            "description":"The resource owner or authorization server denied the request.",\n            "uri":null\n        },\n        {\n            "id":"retry",\n            "description":"The authorization server requires RP to send authorization request again.",\n            "uri":null\n        },\n        {\n            "id":"unsupported_response_type",\n            "description":"The authorization server does not support obtaining an access token using this method.",\n            "uri":null\n        },\n        {\n            "id":"invalid_scope",\n            "description":"The requested scope is invalid, unknown, or malformed.",\n            "uri":null\n        },\n        {\n            "id":"server_error",\n            "description":"The authorization server encountered an unexpected condition which prevented it from fulfilling the request.",\n            "uri":null\n        },\n        {\n            "id":"temporarily_unavailable",\n            "description":"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server.",\n            "uri":null\n        },\n        {\n            "id":"invalid_request_redirect_uri",\n            "description":"The redirect_uri in the Authorization Request does not match any of the Client\'s pre-registered redirect_uris.",\n            "uri":null\n        },\n        {\n            "id":"login_required",\n            "description":"The Authorization Server requires End-User authentication. This error MAY be returned when the prompt parameter in the Authorization Request is set to none to request that the Authorization Server should not display any user interfaces to the End-User, but the Authorization Request cannot be completed without displaying a user interface for user authentication.",\n            "uri":null\n        },\n        {\n            "id":"session_selection_required",\n            "description":"The End-User is required to select a session at the Authorization Server. The End-User MAY be authenticated at the Authorization Server with different associated accounts, but the End-User did not select a session. This error MAY be returned when the prompt parameter in the Authorization Request is set to none to request that the Authorization Server should not display any user interfaces to the End-User, but the Authorization Request cannot be completed without displaying a user interface to prompt for a session to use.",\n            "uri":null\n        },\n        {\n            "id":"consent_required",\n            "description":"The Authorization Server requires End-User consent. This error MAY be returned when the prompt parameter in the Authorization Request is set to none to request that the Authorization Server should not display any user interfaces to the End-User, but the Authorization Request cannot be completed without displaying a user interface for End-User consent.",\n            "uri":null\n        },\n        {\n            "id":"user_mismatched",\n            "description":"The current logged in End-User at the Authorization Server does not match the requested user. This error MAY be returned when the prompt parameter in the Authorization Request is set to none to request that the Authorization Server should not display any user interfaces to the End-User, but the Authorization Request cannot be completed without displaying a user interface to prompt for the correct End-User authentication.",\n            "uri":null\n        },\n        {\n            "id":"invalid_request_uri",\n            "description":"The request_uri in the Authorization Request returns an error or invalid data.",\n            "uri":null\n        },\n        {\n            "id":"invalid_openid_request_object",\n            "description":"The request parameter contains an invalid OpenID Request Object.",\n            "uri":null\n        },\n        {\n            "id":"invalid_request_object",\n            "description":"The request parameter contains an invalid Request Object.",\n            "uri":null\n        },\n        {\n            "id":"authentication_session_invalid",\n            "description":"The authorization server can\'t handle user authentication due to session expiration",\n            "uri":null\n        },\n        {\n            "id":"invalid_authentication_method",\n            "description":"The authorization server can\'t handle user authentication due to error caused by ACR",\n            "uri":null\n        }\n    ],\n    "clientInfo":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, uses more than one method for including an access token, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"invalid_token",\n            "description":"The access token provided is expired, revoked, malformed, or invalid for other reasons. Try to request a new access token and retry the protected resource.",\n            "uri":null\n        }\n    ],\n    "endSession":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats a parameter, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id": "invalid_grant_and_session",\n            "description": "The provided id token (or access token) or session state are invalid or were issued to another client.",\n            "uri": null\n        },\n        {\n            "id": "session_not_passed",\n            "description": "The provided session state is empty.",\n            "uri": null\n        },\n        {\n            "id": "post_logout_uri_not_passed",\n            "description": "The provided post logout uri is empty.",\n            "uri": null\n        },\n        {\n            "id": "post_logout_uri_not_associated_with_client",\n            "description": "The provided post logout uri is not associated with client.",\n            "uri": null\n        },\n        {\n            "id":"invalid_grant",\n            "description":"The provided access token is invalid, or was issued to another client.",\n            "uri":null\n        },\n        {\n            "id":"invalid_logout_uri",\n            "description":"The provided logout_uri is invalid.",\n            "uri":null\n        }\n    ],\n    "register":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"invalid_redirect_uri",\n            "description":"Value of one or more redirect_uris is invalid.",\n            "uri":null\n        },\n        {\n            "id":"invalid_claims_redirect_uri",\n            "description":"Value of one or more claims_redirect_uris is invalid.",\n            "uri":null\n        },\n        {\n            "id":"invalid_client_metadata",\n            "description":"The value of one of the Client Metadata fields is invalid and the server has rejected this request. Note that an Authorization Server MAY choose to substitute a valid value for any requested parameter of a Client\'s Metadata.",\n            "uri":null\n        },\n        {\n            "id":"invalid_token",\n            "description":"The access token provided is expired, revoked, malformed, or invalid for other reasons.",\n            "uri":null\n        },\n        {\n            "id": "invalid_software_statement",\n            "description":"The software_statement is malformed or invalid.",\n            "uri":null\n        },\n        {\n            "id":"access_denied",\n            "description":"The authorization server denied the request.",\n            "uri":null\n        }\n    ],\n    "token":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id": "disabled_client",\n            "description": "The client is disabled and can\'t request an access token using this method.",\n            "uri": null\n        },\n        {\n            "id":"invalid_client",\n            "description":"Client authentication failed (e.g. unknown client, no client authentication included, or unsupported authentication method). The authorization server MAY return an HTTP 401 (Unauthorized) status code to indicate which HTTP authentication schemes are supported. If the client attempted to authenticate via the Authorization request header field, the authorization server MUST respond with an HTTP 401 (Unauthorized) status code, and include the WWW-Authenticate response header field matching the authentication scheme used by the client.",\n            "uri":null\n        },\n        {\n            "id":"invalid_grant",\n            "description":"The provided authorization grant is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.",\n            "uri":null\n        },\n        {\n            "id":"unauthorized_client",\n            "description":"The authenticated client is not authorized to use this authorization grant type.",\n            "uri":null\n        },\n        {\n            "id":"unsupported_grant_type",\n            "description":"The authorization grant type is not supported by the authorization server.",\n            "uri":null\n        },\n        {\n            "id":"invalid_scope",\n            "description":"The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.",\n            "uri":null\n        }\n    ],\n    "revoke":[\n        {\n            "id":"unsupported_token_type",\n            "description":"The authorization server does not support the revocation of the presented token type. That is, the client tried to revoke an access token on a server not supporting this feature.",\n            "uri":null\n        },\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"invalid_client",\n            "description":"Client authentication failed (e.g. unknown client, no client authentication included, or unsupported authentication method). The authorization server MAY return an HTTP 401 (Unauthorized) status code to indicate which HTTP authentication schemes are supported. If the client attempted to authenticate via the Authorization request header field, the authorization server MUST respond with an HTTP 401 (Unauthorized) status code, and include the WWW-Authenticate response header field matching the authentication scheme used by the client.",\n            "uri":null\n        }\n    ],\n    "uma":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, or is otherwise malformed.",\n            "uri": null\n        },\n        {\n            "id": "disabled_client",\n            "description": "The client is disabled and can\'t request an access token using this method.",\n            "uri":null\n        },\n        {\n            "id":"client_not_in_trust_relationship",\n            "description":"The client is not in any trust relationship however federation is enabled for server.",\n            "uri":null\n        },\n        {\n            "id":"unauthorized_client",\n            "description":"The client is not authorized to request an access token using this method.",\n            "uri":null\n        },\n        {\n            "id":"invalid_session",\n            "description":"The provided session is invalid.",\n            "uri":null\n        },\n        {\n            "id":"access_denied",\n            "description":"The resource owner or AM server denied the request.",\n            "uri":null\n        },\n        {\n            "id":"unsupported_response_type",\n            "description":"The AM server does not support an access using this method.",\n            "uri":null\n        },\n        {\n            "id":"invalid_client_scope",\n            "description":"The requested scope is invalid, unknown, or malformed.",\n            "uri":null\n        },\n        {\n            "id":"server_error",\n            "description":"The AM server encountered an unexpected condition which prevented it from fulfilling the request.",\n            "uri":null\n        },\n        {\n            "id":"temporarily_unavailable",\n            "description":"The AM server is currently unable to handle the request due to a temporary overloading or maintenance of the server.",\n            "uri":null\n        },\n        {\n            "id":"precondition_failed",\n            "description":"The resource set that was requested to be deleted or updated at the AM did not match the If-Match value present in the request.",\n            "uri":null\n        },\n        {\n            "id":"not_found",\n            "description":"The resource set requested from the AM cannot be found.",\n            "uri":null\n        },\n        {\n            "id":"unsupported_method_type",\n            "description":"The host request used an unsupported HTTP method.",\n            "uri":null\n        },\n        {\n            "id":"invalid_token",\n            "description":"The access token expired.",\n            "uri":null\n        },\n        {\n            "id":"invalid_resource_id",\n            "description":"The provided resource id was not found at the AS.",\n            "uri":null\n        },\n        {\n            "id":"forbidden_by_policy",\n            "description":"Forbidden by policy (policy returned false).",\n            "uri":null\n        },\n        {\n            "id":"invalid_permission_request",\n            "description":"The provided permission request is not valid.",\n            "uri":null\n        },\n        {\n            "id":"invalid_claims_gathering_script_name",\n            "description":"The claims-gathering script name is not provided or otherwise failed to load script with this name(s).",\n            "uri":null\n        },\n        {\n            "id":"invalid_ticket",\n            "description":"The provided ticket was not found at the AS.",\n            "uri":null\n        },\n        {\n            "id":"invalid_client_id",\n            "description":"The provided client_id is not valid.",\n            "uri":null\n        },\n        {\n            "id":"invalid_claims_redirect_uri",\n            "description":"The provided claims_redirect_uri is not valid.",\n            "uri":null\n        },\n        {\n            "id":"invalid_claim_token_format",\n            "description":"The claim token format is blank or otherwise not supported (supported format is http://openid.net/specs/openid-connect-core-1_0.html#IDToken).",\n            "uri":null\n        },\n        {\n            "id":"invalid_claim_token",\n            "description":"The claim token is not valid or unsupported. (If format is http://openid.net/specs/openid-connect-core-1_0.html#IDToken then claim token has to be ID Token).",\n            "uri":null\n        },\n        {\n            "id":"invalid_pct",\n            "description":"PCT is invalid (revoked, expired or does not exist anymore on AS)",\n            "uri":null\n        },\n        {\n            "id":"invalid_rpt",\n            "description":"RPT is invalid (revoked, expired or does not exist anymore on AS)",\n            "uri":null\n        },\n        {\n            "id":"invalid_grant_type",\n            "description":"The provided grant_type valid does not equal to urn:ietf:params:oauth:grant-type:uma-ticket value which is required by UMA 2.",\n            "uri":null\n        },\n        {\n            "id":"invalid_scope",\n            "description":"The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.",\n            "uri":null\n        },\n        {\n            "id":"invalid_requester_ticket",\n            "description":"The provided ticket was not found at the AM.",\n            "uri":null\n        },\n        {\n            "id":"expired_requester_ticket",\n            "description":"The provided ticket has expired.",\n            "uri":null\n        },\n        {\n            "id":"not_authorized_permission",\n            "description":"The requester is definitively not authorized for this permission according to user policy.",\n            "uri":null\n        },\n        {\n            "id":"need_claims",\n            "description":"The AM is unable to determine whether the requester is authorized for this permission without gathering claims from the requesting party.",\n            "uri":null\n        }\n    ],\n    "userInfo":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, uses more than one method for including an access token, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"invalid_token",\n            "description":"The access token provided is expired, revoked, malformed, or invalid for other reasons. Try to request a new access token and retry the protected resource.",\n            "uri":null\n        },\n        {\n            "id":"insufficient_scope",\n            "description":"The request requires higher privileges than provided by the access token.",\n            "uri":null\n        }\n    ],\n    "validateToken":[\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"invalid_grant",\n            "description":"The provided access token is invalid, or was issued to another client.",\n            "uri":null\n        }\n    ],\n    "fido":[\n        {\n            "id":"server_error",\n            "description":"The authorization server encountered an unexpected condition which prevented it from fulfilling the request.",\n            "uri":null\n        },\n        {\n            "id":"invalid_request",\n            "description":"The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, has invalid signature, or is otherwise malformed.",\n            "uri":null\n        },\n        {\n            "id":"no_eligable_devices",\n            "description":"There are no devices registered.",\n            "uri":null\n        },\n        {\n            "id":"device_compromised",\n            "description":"All devices were compromised.",\n            "uri":null\n        },\n        {\n            "id":"session_expired",\n            "description":"The authentication or registration session was expired.",\n            "uri":null\n        },\n        {\n            "id":"registration_not_allowed",\n            "description":"The user has registered device already.",\n            "uri":null\n        }\n    ],\n    "backchannelAuthentication":[\n        {\n            "id": "invalid_request",\n            "description": "The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, contains more than one of the hints, or is otherwise malformed.",\n            "uri": null\n        },\n        {\n            "id": "invalid_scope",\n            "description": "The requested scope is invalid, unknown, or malformed.",\n            "uri": null\n        },\n        {\n            "id": "expired_login_hint_token",\n            "description": "The login_hint_token provided in the authentication request is not valid because it has expired.",\n            "uri": null\n        },\n        {\n            "id": "unknown_user_id",\n            "description": "The OpenID Provider is not able to identify which end-user the Client wishes to be authenticated by means of the hint provided in the request (login_hint_token, id_token_hint or login_hint).",\n            "uri": null\n        },\n        {\n            "id": "unauthorized_client",\n            "description": "The Client is not authorized to use this authentication flow.",\n            "uri": null\n        },\n        {\n            "id": "missing_user_code",\n            "description": "User code is required but was missing from the request.",\n            "uri": null\n        },\n        {\n            "id": "invalid_user_code",\n            "description": "User code was invalid.",\n            "uri": null\n        },\n        {\n            "id": "invalid_binding_message",\n            "description": "The binding message is invalid or unacceptable for use in the context of the given request.",\n            "uri": null\n        },\n        {\n            "id": "invalid_client",\n            "description": "Client authentication failed (e.g., invalid client credentials, unknown client, no client authentication included, or unsupported authentication method).",\n            "uri": null\n        },\n        {\n            "id": "unauthorized_end_user_device",\n            "description": "The end-user has not registered a device to receive push notifications.",\n            "uri": null\n        },\n        {\n            "id": "access_denied",\n            "description": "The resource owner or OpenID Provider denied the CIBA (Client Initiated Backchannel Authentication) request.",\n            "uri": null\n        }\n    ],\n    "backchannelDeviceRegistration":[\n        {\n            "id": "invalid_request",\n            "description": "The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed.",\n            "uri": null\n        },\n        {\n            "id": "unknown_user_id",\n            "description": "The OpenID Provider is not able to identify the end-user.",\n            "uri": null\n        },\n        {\n            "id": "unauthorized_client",\n            "description": "The Client is not authorized to use this authentication flow.",\n            "uri": null\n        },\n        {\n            "id": "access_denied",\n            "description": "The resource owner or OpenID Provider denied the request.",\n            "uri": null\n        }\n    ]\n}\n'], 'jansConfStatic': ['{\n    "baseDn":{\n        "configuration":"ou=configuration,o=jans",\n        "people":"ou=people,o=jans",\n        "groups":"ou=groups,o=jans",\n        "clients":"ou=clients,o=jans",\n        "sessions":"ou=sessions,o=jans",\n        "stat":"ou=stat,o=jans",\n        "tokens":"ou=tokens,o=jans",\n        "authorizations": "ou=authorizations,o=jans",\n        "scopes":"ou=scopes,o=jans",\n        "attributes":"ou=attributes,o=jans",\n        "scripts": "ou=scripts,o=jans",\n        "umaBase":"ou=uma,o=jans",\n        "umaPolicy":"ou=policies,ou=uma,o=jans",\n        "u2fBase":"ou=u2f,o=jans",\n        "metric":"ou=statistic,o=metric",\n        "sectorIdentifiers": "ou=sector_identifiers,o=jans",\n        "ciba": "ou=ciba,o=jans"\n    }\n}\n'], 'jansConfWebKeys': ['{\n  "keys" : [ {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "be6f1798-c4ee-4666-96d1-94c8b63d9976_sig_rs256",\n    "x5c" : [ "MIIDCTCCAfGgAwIBAgIgUGqfwqOT+uiN2J6N1GL9+tO+V4MgIEn0VGPiE0biHZ4wDQYJKoZIhvcNAQELBQAwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTRaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCL3+X2cSGB2HDgR7SM1jB0V43N5Op4KiWgmPXjsnTOFG6iO0l23oc8i1OVBZoauEw8MJMYYDU5iqlr76qHLExfT8n0VdknrdVBOHvoBOvW7p8JsxrZV+Ps9B3zoIdmzTEjDi77CUCfU6lFFmYP/j6nDryic6ea82jjCtk/qJaYfsa8Zy8737tlUuIOrEvzpqqe/MZKVjBi3PN6ea8cxYHksUKYMD5msyx/ALYwOyEUC8oeZBSENmoARrAgDEN5bmstV6V12bHSRkmQIdW5o6PV9Jj3mgpGDY2jZvzlHvvhkK0UolneRVAko1y9VEXa3eHsD/RhEc8Bce4QVPOeXVxRAgMBAAGjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADANBgkqhkiG9w0BAQsFAAOCAQEAK5/EorowkxDYUSm0l46WsI9qsG9S2mkcyWSQNuA2QxRVhSYquAFGLo4fwaTK2HFSTwVFc7rLSPyG6o2QQAmLIod0ri5I3KosfUYnX3N11XqGklCdd3H2W8MUSo1g9bzvvTiC8MjT540OW7Szb/r8j6+Z1Cwqpu1xSIDtK0DGU15XOlhNc+UDm6kCc0+43UmHluOc5N4ccpExG9AMaIs9C6n+341z0WYL6Ft7Dv/q6ZIARI2+GqGtTOIpR9tsnfxQjxaJ3VVkcL5t9i644kJ3sZv22Y/m2Qa/qGqiX2OaBvMV58ttoPOb3OHDDaP4zYiuC8r2zUhHJJj8IZzNFkDfdw==" ],\n    "exp" : 1624448124602,\n    "alg" : "RS256",\n    "n" : "i9_l9nEhgdhw4Ee0jNYwdFeNzeTqeColoJj147J0zhRuojtJdt6HPItTlQWaGrhMPDCTGGA1OYqpa--qhyxMX0_J9FXZJ63VQTh76ATr1u6fCbMa2Vfj7PQd86CHZs0xIw4u-wlAn1OpRRZmD_4-pw68onOnmvNo4wrZP6iWmH7GvGcvO9-7ZVLiDqxL86aqnvzGSlYwYtzzenmvHMWB5LFCmDA-ZrMsfwC2MDshFAvKHmQUhDZqAEawIAxDeW5rLVelddmx0kZJkCHVuaOj1fSY95oKRg2No2b85R774ZCtFKJZ3kVQJKNcvVRF2t3h7A_0YRHPAXHuEFTznl1cUQ"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "d3446f8c-631c-4faa-9201-b88e1cf8b3e8_sig_rs384",\n    "x5c" : [ "MIIDCTCCAfGgAwIBAgIgS3eTNbw9BjuOg9Qmi4X/vGLhA//kktUO2rWJFZdLnOcwDQYJKoZIhvcNAQEMBQAwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTVaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCzMA5CLIscpiwUZXDSC3rtYrtfON2D5OdSHJvF7HaCDbGw7Emw9nRBM7558SkSo0uVDIVML0ykXuouzfyvwLBRHVhBNpaT2RSGLSlPALdHmT3Vz7O2blVPWBsp6RMLLnhvK60vRGJ98kWbtptbRP9gK7ARPVLzyMqAocPcX15LgXzAihDdmiK3ysSm6N98gwom0oUr1BnKGLmZ4N3MYnV7gE3HN032dgcOfqtuJy8FztfgYONmtQrhP91EUYrIFQhuOM+ltQwrX3klt4CbuPjWp9RJJ+hMwPF6gYne7YaSraXQxAmBHj8vT01XPMjnbpd0me32C5odVuNTbc2/jbQ1AgMBAAGjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADANBgkqhkiG9w0BAQwFAAOCAQEAZPRSLj6WMKIdzjTLS476q2wfWmag7E//M/JbzB0rd4ZFow4MARYsf7v4v4awl9waddqp1K/VnAfiUpnqa3udfiyMgKoPcwRtT7wxrP8KUwSM6EgLf5xnp3i0+E/UVyTPGTr5fN3IXw2NCM/a/AEcM4WjTAP9GP4MDhPljs7ljAeCNiGS/ylUzGLsu6bHVAd4TEWx4askhPZFdh18eaBLw/QvPOPaAFprIvTP/7rDLR3Yv/IQgNi3altZOKqA8kUURBJ8QwI2vWmv0kJNyNSMrpRkKz9kGulR7481oigocmlsBOH15BxP8xEJxHEPdwSmnj06dz6avgwlHUkdHZ+kCQ==" ],\n    "exp" : 1624448124602,\n    "alg" : "RS384",\n    "n" : "szAOQiyLHKYsFGVw0gt67WK7Xzjdg-TnUhybxex2gg2xsOxJsPZ0QTO-efEpEqNLlQyFTC9MpF7qLs38r8CwUR1YQTaWk9kUhi0pTwC3R5k91c-ztm5VT1gbKekTCy54byutL0RiffJFm7abW0T_YCuwET1S88jKgKHD3F9eS4F8wIoQ3Zoit8rEpujffIMKJtKFK9QZyhi5meDdzGJ1e4BNxzdN9nYHDn6rbicvBc7X4GDjZrUK4T_dRFGKyBUIbjjPpbUMK195JbeAm7j41qfUSSfoTMDxeoGJ3u2Gkq2l0MQJgR4_L09NVzzI526XdJnt9guaHVbjU23Nv420NQ"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "347d188f-373d-45f4-a01f-f2340d8542c0_sig_rs512",\n    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAI1d0gC+QMhGqOm3XL6qHqTTT+d/rFhqgTfXTtTwXrg4MA0GCSqGSIb3DQEBDQUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE2WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzKpmC4KzNYhmM4ul++hp7rRLPGN/oUjBV76iu5DM+MD5IL5A5LteuFK6U9WbFxjCQKlTLt53G4xFjoYIQlt1FXmal+tlgVB9SvrNQkNptRzyN2ikboSO7ajJfytavHleZTnepygCoQU1ymYXhOsj8wg65dCB29fu/cOKU4KNmyeGPqGX6+sz33Qi47ge4WMuM2UkIBjG9v0UwW7gTsIGDUjViXM1x6QeQVPNfvmJayYZxKodOyVCd+jsFhRDp9xiN1uQqhWbhNQZfu+sPHScdWEOXMmITu0YD7yD2c4oUGB3/hIh4nFqrTBtGg8h5f5a65y471W8K5rTOqyjjaKRPwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQENBQADggEBAEOF37tzSk74eIqYx42+1VPIcj1q7dfJ7N66eSWPBLfcDMm8RSb57zL6yqH7DHD5OT+TUf6bvjxnT/+V7nf3wqmEXmngCDlvEZ/17vMv4AzHggSPbR4DQlLAjWOpS4PEeJbxKg2/4if7Q6VluuhahQQNPHzh3nBbJ8s90AHxi4C31G01t4hcXa7jEsy5pYcPnDx1P/ogxMDtuLk+FNcVqm9AUU27h63M/h5lcE952tX1BcoBroQx/dGsWMa517yoRJEkbHEQABaCOXTaSXlvDPqwZo39f6X6FGmiMx15QV+WVLbJ0MVAvRr6FbxetzphprxkpE7mcOOOx6RsuGmxtQQ=" ],\n    "exp" : 1624448124602,\n    "alg" : "RS512",\n    "n" : "zKpmC4KzNYhmM4ul--hp7rRLPGN_oUjBV76iu5DM-MD5IL5A5LteuFK6U9WbFxjCQKlTLt53G4xFjoYIQlt1FXmal-tlgVB9SvrNQkNptRzyN2ikboSO7ajJfytavHleZTnepygCoQU1ymYXhOsj8wg65dCB29fu_cOKU4KNmyeGPqGX6-sz33Qi47ge4WMuM2UkIBjG9v0UwW7gTsIGDUjViXM1x6QeQVPNfvmJayYZxKodOyVCd-jsFhRDp9xiN1uQqhWbhNQZfu-sPHScdWEOXMmITu0YD7yD2c4oUGB3_hIh4nFqrTBtGg8h5f5a65y471W8K5rTOqyjjaKRPw"\n  }, {\n    "kty" : "EC",\n    "use" : "sig",\n    "crv" : "P-256",\n    "kid" : "e9f259dd-0020-424a-8653-36186e84b938_sig_es256",\n    "x5c" : [ "MIIBfTCCASOgAwIBAgIgApEkB3oY3Zw5hcPOJj40rjxMxujNVB8Mkz/7MSyyIz4wCgYIKoZIzj0EAwIwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTZaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARgL6oKEKf5NCAIWtvOegvhS4XAdxuKLLGosACMWV6tFb+Vjp5R7XSjks2/8rTJUEXkefT+Nem4AO5uUANDGFIPoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwCgYIKoZIzj0EAwIDSAAwRQIhAITLXgBgx0VZuZvFHpfIcAPdwWcxX7MZRvqyYZ/qxEjkAiAD+s6KKx5aDUf4qC5/yLRClABLRhTsF2DcBcom1rr2AA==" ],\n    "x" : "YC-qChCn-TQgCFrbznoL4UuFwHcbiiyxqLAAjFlerRU",\n    "y" : "AL-Vjp5R7XSjks2_8rTJUEXkefT-Nem4AO5uUANDGFIP",\n    "exp" : 1624448124602,\n    "alg" : "ES256"\n  }, {\n    "kty" : "EC",\n    "use" : "sig",\n    "crv" : "P-384",\n    "kid" : "425ea5da-d3ba-4d79-a3a8-3b848c598163_sig_es384",\n    "x5c" : [ "MIIBujCCAUCgAwIBAgIgDU/Ae1sy6CLuTsKjwx7eBFF43lf94+1FIW7ScbQkq14wCgYIKoZIzj0EAwMwJDEiMCAGA1UEAwwZSmFucyBBdXRoIENBIENlcnRpZmljYXRlczAeFw0yMTA2MjExMTM1MTZaFw0yMTA2MjMxMTM1MjRaMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAATdN4T4EUDHruouBmc8E1BXdSu2t4LXnph+zF62Sv/MPF5mnYXljQWkyzp7OQntqpvaIceQBLWxYQq83rX69LwJ2DhzrIORHtBTElAGyMWaWiUHmua0jhuQpdlpqFlcS5+jJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADAKBggqhkjOPQQDAwNoADBlAjACjwTsOOQjBqRNYSLFX9lPf12/gssSY0xsxJhxcm4EeN07qTzVW8uMu7+yUzNSbq0CMQCJtva13VryEsZ2eKyp26YTQ5fLbikhtWBOL4UNPq+5ZsW5GtxLjfnG4221vdpM6Xc=" ],\n    "x" : "AN03hPgRQMeu6i4GZzwTUFd1K7a3gteemH7MXrZK_8w8XmadheWNBaTLOns5Ce2qmw",\n    "y" : "ANohx5AEtbFhCrzetfr0vAnYOHOsg5Ee0FMSUAbIxZpaJQea5rSOG5Cl2WmoWVxLnw",\n    "exp" : 1624448124602,\n    "alg" : "ES384"\n  }, {\n    "kty" : "EC",\n    "use" : "sig",\n    "crv" : "P-521",\n    "kid" : "c468ea93-393b-4846-a8e2-e48f173a5db4_sig_es512",\n    "x5c" : [ "MIICBTCCAWegAwIBAgIhAMpGwf4XI7l3Sy8p648/Xy3oAt4wo3cHRA3hJCRzHdVSMAoGCCqGSM49BAMEMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE2WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQBll7Ra+QqAce/sIhU2kJP9Bbn8bMo6JYy1f7qjXlmb89ODrcOneTUmE7iDBa+oIfMYm7CNH2K4cfJNXm2mPFRQi8AwLEPAdgv6VTXcqD1EU21YP/rSSacsv1d/X6jg/Ee5tlsm5sRE+2E7WHk22yQgORT2ORLwuZbGBqBBbMObUIyMBKjJzAlMCMGA1UdJQQcMBoGCCsGAQUFBwMBBggrBgEFBQcDAgYEVR0lADAKBggqhkjOPQQDBAOBiwAwgYcCQgDm8r/D1kSDog8sua8qDb/wAi5/f+dTJ7H4EMwdc+9JLiVkg5zakj+/D3xjS9h2TyYpiEb0qzZ5Gqbu/Vih3JICeQJBYoUAvqLCIJDOgjfbjW5UzCLed356ffd4Qjmk1D5RparwybuRX3E58mdAmAPHBQq3zTcNPVB4HgxIPT97eMrA+Wg=" ],\n    "x" : "AZZe0WvkKgHHv7CIVNpCT_QW5_GzKOiWMtX-6o15Zm_PTg63Dp3k1JhO4gwWvqCHzGJuwjR9iuHHyTV5tpjxUUIv",\n    "y" : "AMCxDwHYL-lU13Kg9RFNtWD_60kmnLL9Xf1-o4PxHubZbJubERPthO1h5NtskIDkU9jkS8LmWxgagQWzDm1CMjAS",\n    "exp" : 1624448124602,\n    "alg" : "ES512"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "dfa48be5-3fa2-44ba-83ca-a528dbf7eee1_sig_ps256",\n    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgDgMVuuoR7STMKXG5yWwJSS4yGMQ0bclXJL7glNI4MxswQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgEFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgEFAKIDAgEgMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE3WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtXkp4jVfR48RtW7CEo9b9pYXHjeMsCvgPPSlmEOvk7kqtu3wBf3haTkty1qABncvW358RuZILKIHpS969kTbnYwAIbWR3NzUK49GOM+w8nUmq7a6N3vP/AofmLowlAj2oxzwIn4sZHFVDqGKXg3C+eUuGTHK0p5llbnJIpiERr+6DwjjljGSTBtYNz334bf5+VYB9i8yNzTEkW2+4xyOvjmtfP9RwWllEMWon1RXkRlUCcVzgKOhohnl2vmK4BJUWJ/mKAprQgqlIOe/jOCs1UYnIn049Q7JNdseptiFCE+aunWEUzJPTTd+b70lzG8LnGO2vYAHhmou945JcCGTZQIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgEFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgEFAKIDAgEgA4IBAQAiDo2kyZP3TQ+y1iWBbVSEV/Dk4zbdLvMcj5S5XH2TBv1mtUtfeYXTHijUva5OlnEoPHO2Z071tpK2uFkhDnNCOskjZrMEGwAe2v/O6pwCjcF2KDA21CD3/6tMEuBQtL0pfs4VEGGg7lakWx4hg12l39KBh0JEEZwUZ9iSnIbDzOVF213pmRi9Ro0T+RbfnZ9Ct/5ho24Cd3I8dpg5rtBzE9TMAO/DbLX36dd1tQCSSawbbXGKeJ2ETSIMf3fPQxRsS8dKF6GXI6RNmJ4vekgw9FLRGtevonlLrzrxa1kfvF5dcOQqoQISNKaTP9JZFCP6via/m0g95XIIZL01C0Zy" ],\n    "exp" : 1624448124602,\n    "alg" : "PS256",\n    "n" : "tXkp4jVfR48RtW7CEo9b9pYXHjeMsCvgPPSlmEOvk7kqtu3wBf3haTkty1qABncvW358RuZILKIHpS969kTbnYwAIbWR3NzUK49GOM-w8nUmq7a6N3vP_AofmLowlAj2oxzwIn4sZHFVDqGKXg3C-eUuGTHK0p5llbnJIpiERr-6DwjjljGSTBtYNz334bf5-VYB9i8yNzTEkW2-4xyOvjmtfP9RwWllEMWon1RXkRlUCcVzgKOhohnl2vmK4BJUWJ_mKAprQgqlIOe_jOCs1UYnIn049Q7JNdseptiFCE-aunWEUzJPTTd-b70lzG8LnGO2vYAHhmou945JcCGTZQ"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "2cab0f42-13c0-4d04-9570-3856245b7845_sig_ps384",\n    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgRU1KLGepGaIrJrFuUmkooBc3Sv9yRSKfHLxqiT82pZ0wQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgIFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgIFAKIDAgEwMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE3WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwoDWlAtmUJ5bRnW7rV6+8s36fB2Yyppm7JLI9pQ/32pfMtE0D367R+SpGBgLrWnJng2Z/lzMcrvzqtlapLuCzff1WarDl5y40m7kSZ9VEpIiyPgkerprshBuB8c1Lebx46afeJNkiKiNbullWzJi+Oru+fdNII1N95ktjP2h47pv5U4KHgvW7cKItGEOcKqBw0x+9aMUvMixwjb6FiuuuKevDOL1Notnh+ILTnnUqXpSslK+85IoeEzlUM1pcm5CH3R/1DZVUXLwesi1poiQp2o4G01OdfkVE4EpWfI83v7T3yHjsjbO6PqcHlerKxjbeT49sZ4HwQvV068goPIRTwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgIFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgIFAKIDAgEwA4IBAQAuhqAeTjZ8CIWLMxuBj2pXw20mS4XpI1Am4ByBcdsLbvW5tlHi692pooGWIRFJqTwpDwFPtNM0rf6P4cFRBmzjdJpskas+H91Rd3hswSMvzNb1WBZWpjYFwJTfHRof8+slQRQa+yk8KpYGUuZ7d5aFRczWkojAaPnm8Xf5I2vlNCN/+5Ghlowp+xWr35W1VgQgljZcrXQY//dGClI93vy3kMHYBWHEBUX14vIpE+PNUKyJZgcfbwgfcwpgX4YImSxCEdshVhJlYKP+CbxQiC4WOW9LaIjj4EiMh41vrKEGKeO7Mmoj7RmTvKwzZNyaA4KxFjyYTZPX3dLtUwQ5s08b" ],\n    "exp" : 1624448124602,\n    "alg" : "PS384",\n    "n" : "woDWlAtmUJ5bRnW7rV6-8s36fB2Yyppm7JLI9pQ_32pfMtE0D367R-SpGBgLrWnJng2Z_lzMcrvzqtlapLuCzff1WarDl5y40m7kSZ9VEpIiyPgkerprshBuB8c1Lebx46afeJNkiKiNbullWzJi-Oru-fdNII1N95ktjP2h47pv5U4KHgvW7cKItGEOcKqBw0x-9aMUvMixwjb6FiuuuKevDOL1Notnh-ILTnnUqXpSslK-85IoeEzlUM1pcm5CH3R_1DZVUXLwesi1poiQp2o4G01OdfkVE4EpWfI83v7T3yHjsjbO6PqcHlerKxjbeT49sZ4HwQvV068goPIRTw"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "sig",\n    "crv" : "",\n    "kid" : "b58649e2-3b4c-489a-96da-bf6a40413133_sig_ps512",\n    "x5c" : [ "MIIDcTCCAiWgAwIBAgIgLSP1zTFOnL24KN7yogmcMB/KRferymSvPrbhgjp1xsowQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgMFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgMFAKIDAgFAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvel84rjWHiW/pE27/KFB0U61g5YqyfNp7WPTh0YCPb/fHl1+A0BHKeGmtewJMwwcqVIYuLLr1b+rcykbkOEf4/sPpQcuoX7DCcFP5LhxH7cERH7JyV2JVgCDTN+LIxe9R15uMyFkCmE2zdnvqaLRic/Pv7Ke2Thv+ydMDk7YI6AsnpelXIzKjeQs8Cq8SWde0y9hHSFeY0RRy2dF4qcsu45B5XDIXe6TBjSIQmidtMPrpCEiNGN8sjUNzLbMi8ou/v6SiyABosKxITV5fT3KscYofX6eRGvYlwVYA2naqKv49cCNTt2gmbcfporBX8we6DMJ9YbGBjmoo/skfcxvuwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwQQYJKoZIhvcNAQEKMDSgDzANBglghkgBZQMEAgMFAKEcMBoGCSqGSIb3DQEBCDANBglghkgBZQMEAgMFAKIDAgFAA4IBAQAk/y0IBh1TjSRXl9WWtAPEhKgKvGOFH5gw65yshk9F8EP+tEG+6UN+/3YJJxkYvun3Ln8BPBY+R8In4rL1WtJ1D3D/yYBi064z2bPqyOcjDuqaPAibfPi9KfRFnAHnEORxuJ+GL1ROG13SxmZR0Sonl+cLiuKVPuO5S40YSFumNmzzBtHfOZKSewwaoMp8tFcQrpCryNhc0obxKFyRUBdtJRb2uxWqY32BrkFOX8q9ZCNW1CEnLXj4wOZ1vOAzBTEnd9FvJP3VtEB/BZHxHESbifXMoHZBJ+8/d7rnylstHcU355eH4b+Wu9grcNkADIgaLRtWlzKAJYmauBwS1maq" ],\n    "exp" : 1624448124602,\n    "alg" : "PS512",\n    "n" : "vel84rjWHiW_pE27_KFB0U61g5YqyfNp7WPTh0YCPb_fHl1-A0BHKeGmtewJMwwcqVIYuLLr1b-rcykbkOEf4_sPpQcuoX7DCcFP5LhxH7cERH7JyV2JVgCDTN-LIxe9R15uMyFkCmE2zdnvqaLRic_Pv7Ke2Thv-ydMDk7YI6AsnpelXIzKjeQs8Cq8SWde0y9hHSFeY0RRy2dF4qcsu45B5XDIXe6TBjSIQmidtMPrpCEiNGN8sjUNzLbMi8ou_v6SiyABosKxITV5fT3KscYofX6eRGvYlwVYA2naqKv49cCNTt2gmbcfporBX8we6DMJ9YbGBjmoo_skfcxvuw"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "enc",\n    "crv" : "",\n    "kid" : "c1f2deb0-f069-47fb-b908-1376f1465316_enc_rsa1_5",\n    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAOUJKq/Zc6rVTVB//Fa3Rb0br3H9wKvre8TFFNf3b7GxMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz5aYNLRwNlmnp1ssv541Wc3Ma602Op/BvXFUcqARDccQC1pz0AHy0kUnqEPiZRr664QB0UgLWpxkf4OdZ6teOCz/v9aCKWPA079grPxbJEux5gRQ37KVGgmmBEAgPI5HnUHQvBNVRnI2B79QvTFpLlMr5oPSdZPVIz56+TcyzKlNzD25uqwOYnVMJyLozL80dJrRBcwYR0E4Ab+W01bFg1RPm3i7UBHLfVVWyMBIkM+xrW0aR46gDFZw/prQF/HOY/NqRHG1uHmuDkQXpDOSMaS5T6lytkFZod8cKH0fyxTQjon9pS4nanSQwVpNZuMEMLuUvXbJvnZg4wLyRblMNwIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAA7JVgfplAKshPvYZd++kE+NxUSiiN/gK7VsEDv6CA9fQ4tmGrOykdcuWiLt3JBGlz72KFmVmW0TPh32EynoVr98U+haD6o4IXt/itrxibF6Joa38fwEWwsAYVe55owq2Brfel7uj2nq1AbQI//tfzI+VCgqBytWyT+9WvYQhVwew0O/o6gv9Qo4IJ1+apHuc9/w8EEEZvUz+5yAq0im9vzeTnf0U4LIXPes10qzvlJuInE7QfZkmUWGQoyNqssfNpObMyc/mPAuynCuXWWCTFxtxt7mSgcLBTzMdB0hcwKwmqmROvZE3eOdQbY610xETgwroLyR6rHQTigOECGY+ns=" ],\n    "exp" : 1624448124602,\n    "alg" : "RSA1_5",\n    "n" : "z5aYNLRwNlmnp1ssv541Wc3Ma602Op_BvXFUcqARDccQC1pz0AHy0kUnqEPiZRr664QB0UgLWpxkf4OdZ6teOCz_v9aCKWPA079grPxbJEux5gRQ37KVGgmmBEAgPI5HnUHQvBNVRnI2B79QvTFpLlMr5oPSdZPVIz56-TcyzKlNzD25uqwOYnVMJyLozL80dJrRBcwYR0E4Ab-W01bFg1RPm3i7UBHLfVVWyMBIkM-xrW0aR46gDFZw_prQF_HOY_NqRHG1uHmuDkQXpDOSMaS5T6lytkFZod8cKH0fyxTQjon9pS4nanSQwVpNZuMEMLuUvXbJvnZg4wLyRblMNw"\n  }, {\n    "kty" : "RSA",\n    "e" : "AQAB",\n    "use" : "enc",\n    "crv" : "",\n    "kid" : "af20de92-1e39-4680-b56e-c383d69ec900_enc_rsa-oaep",\n    "x5c" : [ "MIIDCjCCAfKgAwIBAgIhAJ1X7MPmJS3kHq0T6r+SZefM6qyUz7lxg/oYZqE72tSIMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNjIxMTEzNTE4WhcNMjEwNjIzMTEzNTI0WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu2qkEacXwFCYnUu9BZF0vGExpOcFJt4Z3bQzRfO/MVuo927nfBRNXWjXxZYV91RaH0CRpKMMgr80K7MmbcUDj0utXbhPd5au7mL0+v1ops0qkK58GgnIkB+ibNWMBJIQCWfKUp5BIe1C7zc+hgsbYln+ewwDDQ+WASrSUJ0P+2wz9uLUEUzjFtcXS8YSvNHPui4QZ2lKik7wRZZeKnnYil2578acaBdrOIeFEVZv1/J2wfXdGfZ/BBAXt+DN3mJkxkLYIvfMNnUxtEDAqrjx8imnphLGVaQZG+ZVIQcf4de0f4QR0mnoLlFk1N9Y+RSnD6iBAjeZS2dpMEFRV0d3EQIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBALpI3vQOMjRGC7Xeo3hwwRUXfR346LGEWtfMXEkrQWo7DIebM6IDhuSCkQ3EezDwar6mkIoW2lToEAbRMZnC6zBGg8fIWKzqjuNL/0vE3lS3+E1f8aFt6IIcpou4irk+jjnterTGA9FhFKmHQk2QzhBjQc2CkBNib4h3qVaxTmYiZSXBpSXWk2+p+AYKxOGF5h4DCGyOyykDH9FBC1dnKcbn0nP6KBBzd3L8Wx7LWoBbWE8nqBTF2/XvekEz+mMRERHMYKFyDcDhC1gbEUELGgbi6O9AcwADeheK5ySUPE15q5RzRSBagfeFoEJ2goBrRxRAFwq1lSGkkPvnLRiuaYQ=" ],\n    "exp" : 1624448124602,\n    "alg" : "RSA-OAEP",\n    "n" : "u2qkEacXwFCYnUu9BZF0vGExpOcFJt4Z3bQzRfO_MVuo927nfBRNXWjXxZYV91RaH0CRpKMMgr80K7MmbcUDj0utXbhPd5au7mL0-v1ops0qkK58GgnIkB-ibNWMBJIQCWfKUp5BIe1C7zc-hgsbYln-ewwDDQ-WASrSUJ0P-2wz9uLUEUzjFtcXS8YSvNHPui4QZ2lKik7wRZZeKnnYil2578acaBdrOIeFEVZv1_J2wfXdGfZ_BBAXt-DN3mJkxkLYIvfMNnUxtEDAqrjx8imnphLGVaQZG-ZVIQcf4de0f4QR0mnoLlFk1N9Y-RSnD6iBAjeZS2dpMEFRV0d3EQ"\n  } ]\n}'], 'jansRevision': ['1'], 'objectClass': ['top', 'jansAppConf'], 'ou': ['jans-auth']}
11:35:29 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-auth/clients.ldif
11:35:29 06/21/21 Querying LDAP for dn inum=1001.0eda93d4-65d9-456f-888a-92e28f2f12f5,ou=clients,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=1001.0eda93d4-65d9-456f-888a-92e28f2f12f5,ou=clients,o=jans entry:{'displayName': ['oxTrust Admin GUI'], 'inum': ['1001.0eda93d4-65d9-456f-888a-92e28f2f12f5'], 'jansAppTyp': ['web'], 'jansClaimRedirectURI': ['https://test.dd.jans.io/jans-auth/restv1/uma/gather_claims'], 'jansClntSecret': ['DK4tHNiOnJiJfiziPs5KAg=='], 'jansGrantTyp': ['authorization_code', 'implicit', 'refresh_token'], 'jansIdTknSignedRespAlg': ['HS256'], 'jansLogoutSessRequired': ['true'], 'jansLogoutURI': ['https://test.dd.jans.io/identity/ssologout.htm'], 'jansPersistClntAuthzs': ['false'], 'jansPostLogoutRedirectURI': ['https://test.dd.jans.io/identity/finishlogout.htm'], 'jansRedirectURI': ['https://test.dd.jans.io/identity/scim/auth', 'https://test.dd.jans.io/identity/authcode.htm', 'https://test.dd.jans.io/jans-auth/restv1/uma/gather_claims?authentication=true'], 'jansRespTyp': ['code'], 'jansScope': ['inum=F0C4,ou=scopes,o=jans', 'inum=10B2,ou=scopes,o=jans', 'inum=764C,ou=scopes,o=jans'], 'jansSubjectTyp': ['public'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['true'], 'objectClass': ['top', 'jansClnt']}
11:35:29 06/21/21 Importing entries from /opt/jans/jans-setup/output/scripts.ldif
11:35:29 06/21/21 Querying LDAP for dn inum=2124-0CF1,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2124-0CF1,ou=scripts,o=jans entry:{'description': ['Cert authentication module'], 'displayName': ['cert'], 'inum': ['2124-0CF1'], 'jansConfProperty': ['{"value1":"chain_cert_file_path","value2":"/etc/certs/chain_cert.pem","description":""}', '{"value1":"credentials_file","value2":"/etc/certs/cert_creds.json","description":""}', '{"value1":"map_user_cert","value2":"true","description":""}', '{"value1":"use_generic_validator","value2":"true","description":""}', '{"value1":"use_path_validator","value2":"true","description":""}', '{"value1":"use_ocsp_validator","value2":"false","description":""}', '{"value1":"use_crl_validator","value2":"false","description":""}', '{"value1":"crl_max_response_size","value2":"10485760","description":""}'], 'jansLevel': ['30'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['#\n# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom javax.faces.context import FacesContext\nfrom io.jans.as.server.security import Identity\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.util import StringHelper\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.as.service.common import EncryptionService\nfrom java.util import Arrays\nfrom io.jans.as.cert.fingerprint import FingerprintHelper\nfrom io.jans.as.cert.validation import GenericCertificateVerifier, PathCertificateVerifier, OCSPCertificateVerifier, CRLCertificateVerifier\nfrom io.jans.as.cert.validation.model import ValidationStatus\nfrom io.jans.as.util import CertUtil\nfrom io.jans.as.model.util import CertUtils\nfrom io.jans.as.service.net import HttpService\nfrom org.apache.http.params import CoreConnectionPNames\n\nimport sys\nimport base64\nimport urllib\n\nimport java\nimport json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Cert. Initialization"\n\n        if not (configurationAttributes.containsKey("chain_cert_file_path")):\n            print "Cert. Initialization. Property chain_cert_file_path is mandatory"\n            return False\n\n        if not (configurationAttributes.containsKey("map_user_cert")):\n            print "Cert. Initialization. Property map_user_cert is mandatory"\n            return False\n\n        chain_cert_file_path = configurationAttributes.get("chain_cert_file_path").getValue2()\n\n        self.chain_certs = CertUtil.loadX509CertificateFromFile(chain_cert_file_path)\n        if self.chain_certs == None:\n            print "Cert. Initialization. Failed to load chain certificates from \'%s\'" % chain_cert_file_path\n            return False\n\n        print "Cert. Initialization. Loaded \'%d\' chain certificates" % self.chain_certs.size()\n        \n        crl_max_response_size = 5 * 1024 * 1024  # 10Mb\n        if configurationAttributes.containsKey("crl_max_response_size"):\n            crl_max_response_size = StringHelper.toInteger(configurationAttributes.get("crl_max_response_size").getValue2(), crl_max_response_size)\n            print "Cert. Initialization. CRL max response size is \'%d\'" % crl_max_response_size\n\n        # Define array to order methods correctly\n        self.validator_types = [ \'generic\', \'path\', \'ocsp\', \'crl\']\n        self.validators = { \'generic\' : [GenericCertificateVerifier(), False],\n                            \'path\' : [PathCertificateVerifier(False), False],\n                            \'ocsp\' : [OCSPCertificateVerifier(), False],\n                            \'crl\' : [CRLCertificateVerifier(crl_max_response_size), False] }\n\n        for type in self.validator_types:\n            validator_param_name = "use_%s_validator" % type\n            if configurationAttributes.containsKey(validator_param_name):\n                validator_status = StringHelper.toBoolean(configurationAttributes.get(validator_param_name).getValue2(), False)\n                self.validators[type][1] = validator_status\n\n            print "Cert. Initialization. Validation method \'%s\' status: \'%s\'" % (type, self.validators[type][1])\n\n        self.map_user_cert = StringHelper.toBoolean(configurationAttributes.get("map_user_cert").getValue2(), False)\n        print "Cert. Initialization. map_user_cert: \'%s\'" % self.map_user_cert\n\n        self.enabled_recaptcha = self.initRecaptcha(configurationAttributes)\n        print "Cert. Initialization. enabled_recaptcha: \'%s\'" % self.enabled_recaptcha\n\n        print "Cert. Initialized successfully"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Cert. Destroy"\n\n        for type in self.validator_types:\n            self.validators[type][0].destroy()\n\n        print "Cert. Destroyed successfully"\n\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        user_name = credentials.getUsername()\n\n        userService = CdiUtil.bean(UserService)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        if step == 1:\n            print "Cert. Authenticate for step 1"\n            login_button = ServerUtil.getFirstValue(requestParameters, "loginForm:loginButton")\n            if StringHelper.isEmpty(login_button):\n                print "Cert. Authenticate for step 1. Form were submitted incorrectly"\n                return False\n            if self.enabled_recaptcha:\n                print "Cert. Authenticate for step 1. Validating recaptcha response"\n                recaptcha_response = ServerUtil.getFirstValue(requestParameters, "g-recaptcha-response")\n\n                recaptcha_result = self.validateRecaptcha(recaptcha_response)\n                print "Cert. Authenticate for step 1. recaptcha_result: \'%s\'" % recaptcha_result\n                \n                return recaptcha_result\n\n            return True\n        elif step == 2:\n            print "Cert. Authenticate for step 2"\n\n            # Validate if user selected certificate\n            cert_x509 = self.getSessionAttribute("cert_x509")\n            if cert_x509 == None:\n                print "Cert. Authenticate for step 2. User not selected any certs"\n                identity.setWorkingParameter("cert_selected", False)\n                    \n                # Return True to inform user how to reset workflow\n                return True\n            else:\n                identity.setWorkingParameter("cert_selected", True)\n                x509Certificate = self.certFromString(cert_x509)\n\n            subjectX500Principal = x509Certificate.getSubjectX500Principal()\n            print "Cert. Authenticate for step 2. User selected certificate with DN \'%s\'" % subjectX500Principal\n            \n            # Validate certificates which user selected\n            valid = self.validateCertificate(x509Certificate)\n            if not valid:\n                print "Cert. Authenticate for step 2. Certificate DN \'%s\' is not valid" % subjectX500Principal\n                identity.setWorkingParameter("cert_valid", False)\n                \n                # Return True to inform user how to reset workflow\n                return True\n\n            identity.setWorkingParameter("cert_valid", True)\n            \n            # Calculate certificate fingerprint\n            x509CertificateFingerprint = self.calculateCertificateFingerprint(x509Certificate)\n            identity.setWorkingParameter("cert_x509_fingerprint", x509CertificateFingerprint)\n            print "Cert. Authenticate for step 2. Fingerprint is \'%s\' of certificate with DN \'%s\'" % (x509CertificateFingerprint, subjectX500Principal)\n            \n            # Attempt to find user by certificate fingerprint\n            cert_user_external_uid = "cert:%s" % x509CertificateFingerprint\n            print "Cert. Authenticate for step 2. Attempting to find user by oxExternalUid attribute value %s" % cert_user_external_uid\n\n            find_user_by_external_uid = userService.getUserByAttribute("oxExternalUid", cert_user_external_uid)\n            if find_user_by_external_uid == None:\n                print "Cert. Authenticate for step 2. Failed to find user"\n                \n                if self.map_user_cert:\n                    print "Cert. Authenticate for step 2. Storing cert_user_external_uid for step 3"\n                    identity.setWorkingParameter("cert_user_external_uid", cert_user_external_uid)\n                    return True\n                else:\n                    print "Cert. Authenticate for step 2. Mapping cert to user account is not allowed"\n                    identity.setWorkingParameter("cert_count_login_steps", 2)\n                    return False\n\n            foundUserName = find_user_by_external_uid.getUserId()\n            print "Cert. Authenticate for step 2. foundUserName: " + foundUserName\n\n            logged_in = False\n            userService = CdiUtil.bean(UserService)\n            logged_in = authenticationService.authenticate(foundUserName)\n        \n            print "Cert. Authenticate for step 2. Setting count steps to 2"\n            identity.setWorkingParameter("cert_count_login_steps", 2)\n\n            return logged_in\n        elif step == 3:\n            print "Cert. Authenticate for step 3"\n\n            cert_user_external_uid = self.getSessionAttribute("cert_user_external_uid")\n            if cert_user_external_uid == None:\n                print "Cert. Authenticate for step 3. cert_user_external_uid is empty"\n                return False\n\n            user_password = credentials.getPassword()\n\n            logged_in = False\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if (not logged_in):\n                return False\n\n            # Double check just to make sure. We did checking in previous step\n            # Check if there is user which has cert_user_external_uid\n            # Avoid mapping user cert to more than one IDP account\n            find_user_by_external_uid = userService.getUserByAttribute("oxExternalUid", cert_user_external_uid)\n            if find_user_by_external_uid == None:\n                # Add cert_user_external_uid to user\'s external GUID list\n                find_user_by_external_uid = userService.addUserAttribute(user_name, "oxExternalUid", cert_user_external_uid)\n                if find_user_by_external_uid == None:\n                    print "Cert. Authenticate for step 3. Failed to update current user"\n                    return False\n\n                return True\n        \n            return True\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        print "Cert. Prepare for step %d" % step\n        identity = CdiUtil.bean(Identity)\n        \n        if step == 1:\n            if self.enabled_recaptcha:\n                identity.setWorkingParameter("recaptcha_site_key", self.recaptcha_creds[\'site_key\'])\n        elif step == 2:\n            # Store certificate in session\n            facesContext = CdiUtil.bean(FacesContext)\n            externalContext = facesContext.getExternalContext()\n            request = externalContext.getRequest()\n\n            # Try to get certificate from header X-ClientCert\n            clientCertificate = externalContext.getRequestHeaderMap().get("X-ClientCert")\n            if clientCertificate != None:\n                x509Certificate = self.certFromPemString(clientCertificate)\n                identity.setWorkingParameter("cert_x509",  self.certToString(x509Certificate))\n                print "Cert. Prepare for step 2. Storing user certificate obtained from \'X-ClientCert\' header"\n                return True\n\n            # Try to get certificate from attribute javax.servlet.request.X509Certificate\n            x509Certificates = request.getAttribute(\'javax.servlet.request.X509Certificate\')\n            if (x509Certificates != None) and (len(x509Certificates) > 0):\n                identity.setWorkingParameter("cert_x509", self.certToString(x509Certificates[0]))\n                print "Cert. Prepare for step 2. Storing user certificate obtained from \'javax.servlet.request.X509Certificate\' attribute"\n                return True\n\n        if step < 4:\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return Arrays.asList("cert_selected", "cert_valid", "cert_x509", "cert_x509_fingerprint", "cert_count_login_steps", "cert_user_external_uid")\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        cert_count_login_steps = self.getSessionAttribute("cert_count_login_steps")\n        if cert_count_login_steps != None:\n            return cert_count_login_steps\n        else:\n            return 3\n\n    def getPageForStep(self, configurationAttributes, step):\n        if step == 1:\n            return "/auth/cert/login.xhtml"\n        if step == 2:\n            return "/auth/cert/cert-login.xhtml"\n        elif step == 3:\n            cert_selected = self.getSessionAttribute("cert_selected")\n            if True != cert_selected:\n                return "/auth/cert/cert-not-selected.xhtml"\n\n            cert_valid = self.getSessionAttribute("cert_valid")\n            if True != cert_valid:\n                return "/auth/cert/cert-invalid.xhtml"\n            \n            return "/login.xhtml"\n\n        return ""\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def processBasicAuthentication(self, credentials):\n        userService = CdiUtil.bean(UserService)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        user_name = credentials.getUsername()\n        user_password = credentials.getPassword()\n\n        logged_in = False\n        if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n            logged_in = authenticationService.authenticate(user_name, user_password)\n\n        if (not logged_in):\n            return None\n\n        find_user_by_uid = authenticationService.getAuthenticatedUser()\n        if (find_user_by_uid == None):\n            print "Cert. Process basic authentication. Failed to find user \'%s\'" % user_name\n            return None\n        \n        return find_user_by_uid\n\n    def getSessionAttribute(self, attribute_name):\n        identity = CdiUtil.bean(Identity)\n\n        # Try to get attribute value from Seam event context\n        if identity.isSetWorkingParameter(attribute_name):\n            return identity.getWorkingParameter(attribute_name)\n        \n        # Try to get attribute from persistent session\n        session_id = identity.getSessionId()\n        if session_id == None:\n            return None\n\n        session_attributes = session_id.getSessionAttributes()\n        if session_attributes == None:\n            return None\n\n        if session_attributes.containsKey(attribute_name):\n            return session_attributes.get(attribute_name)\n\n        return None\n\n    def calculateCertificateFingerprint(self, x509Certificate):\n        print "Cert. Calculate fingerprint for certificate DN \'%s\'" % x509Certificate.getSubjectX500Principal()\n        \n        publicKey = x509Certificate.getPublicKey()\n        \n        # Use oxAuth implementation\n        fingerprint = FingerprintHelper.getPublicKeySshFingerprint(publicKey)\n        \n        return fingerprint      \n\n    def validateCertificate(self, x509Certificate):\n        subjectX500Principal = x509Certificate.getSubjectX500Principal()\n\n        print "Cert. Validating certificate with DN \'%s\'" % subjectX500Principal\n        \n        validation_date = java.util.Date()\n\n        for type in self.validator_types:\n            if self.validators[type][1]:\n                result = self.validators[type][0].validate(x509Certificate, self.chain_certs, validation_date)\n                print "Cert. Validate certificate: \'%s\'. Validation method \'%s\' result: \'%s\'" % (subjectX500Principal, type, result)\n                \n                if (result.getValidity() != ValidationStatus.CertificateValidity.VALID):\n                    print "Cert. Certificate: \'%s\' is invalid" % subjectX500Principal\n                    return False\n        \n        return True\n\n    def certToString(self, x509Certificate):\n        if x509Certificate == None:\n            return None\n        return base64.b64encode(x509Certificate.getEncoded())\n\n    def certFromString(self, x509CertificateEncoded):\n        x509CertificateDecoded = base64.b64decode(x509CertificateEncoded)\n        return CertUtils.x509CertificateFromBytes(x509CertificateDecoded)\n\n    def certFromPemString(self, pemCertificate):\n        x509CertificateEncoded = pemCertificate.replace("-----BEGIN CERTIFICATE-----", "").replace("-----END CERTIFICATE-----", "").strip()\n        return self.certFromString(x509CertificateEncoded)\n\n    def initRecaptcha(self, configurationAttributes):\n        print "Cert. Initialize recaptcha"\n        if not configurationAttributes.containsKey("credentials_file"):\n            return False\n\n        cert_creds_file = configurationAttributes.get("credentials_file").getValue2()\n\n        # Load credentials from file\n        f = open(cert_creds_file, \'r\')\n        try:\n            creds = json.loads(f.read())\n        except:\n            print "Cert. Initialize recaptcha. Failed to load credentials from file: %s" % cert_creds_file\n            return False\n        finally:\n            f.close()\n        \n        try:\n            recaptcha_creds = creds["recaptcha"]\n        except:\n            print "Cert. Initialize recaptcha. Invalid credentials file \'%s\' format:" % cert_creds_file\n            return False\n        \n        self.recaptcha_creds = None\n        if recaptcha_creds["enabled"]:\n            print "Cert. Initialize recaptcha. Recaptcha is enabled"\n\n            encryptionService = CdiUtil.bean(EncryptionService)\n\n            site_key = recaptcha_creds["site_key"]\n            secret_key = recaptcha_creds["secret_key"]\n\n            try:\n                site_key = encryptionService.decrypt(site_key)\n            except:\n                # Ignore exception. Value is not encrypted\n                print "Cert. Initialize recaptcha. Assuming that \'site_key\' in not encrypted"\n\n            try:\n                secret_key = encryptionService.decrypt(secret_key)\n            except:\n                # Ignore exception. Value is not encrypted\n                print "Cert. Initialize recaptcha. Assuming that \'secret_key\' in not encrypted"\n\n            \n            self.recaptcha_creds = { \'site_key\' : site_key, "secret_key" : secret_key }\n            print "Cert. Initialize recaptcha. Recaptcha is configured correctly"\n\n            return True\n        else:\n            print "Cert. Initialize recaptcha. Recaptcha is disabled"\n\n        return False\n\n    def validateRecaptcha(self, recaptcha_response):\n        print "Cert. Validate recaptcha response"\n\n        facesContext = CdiUtil.bean(FacesContext)\n        request = facesContext.getExternalContext().getRequest()\n\n        remoteip = ServerUtil.getIpAddress(request)\n        print "Cert. Validate recaptcha response. remoteip: \'%s\'" % remoteip\n\n        httpService = CdiUtil.bean(HttpService)\n\n        http_client = httpService.getHttpsClient()\n        http_client_params = http_client.getParams()\n        http_client_params.setIntParameter(CoreConnectionPNames.CONNECTION_TIMEOUT, 15 * 1000)\n        \n        recaptcha_validation_url = "https://www.google.com/recaptcha/api/siteverify"\n        recaptcha_validation_request = urllib.urlencode({ "secret" : self.recaptcha_creds[\'secret_key\'], "response" : recaptcha_response, "remoteip" : remoteip })\n        recaptcha_validation_headers = { "Content-type" : "application/x-www-form-urlencoded", "Accept" : "application/json" }\n\n        try:\n            http_service_response = httpService.executePost(http_client, recaptcha_validation_url, None, recaptcha_validation_headers, recaptcha_validation_request)\n            http_response = http_service_response.getHttpResponse()\n        except:\n            print "Cert. Validate recaptcha response. Exception: ", sys.exc_info()[1]\n            return False\n\n        try:\n            if not httpService.isResponseStastusCodeOk(http_response):\n                print "Cert. Validate recaptcha response. Get invalid response from validation server: ", str(http_response.getStatusLine().getStatusCode())\n                httpService.consume(http_response)\n                return False\n    \n            response_bytes = httpService.getResponseContent(http_response)\n            response_string = httpService.convertEntityToString(response_bytes)\n            httpService.consume(http_response)\n        finally:\n            http_service_response.closeConnection()\n\n        if response_string == None:\n            print "Cert. Validate recaptcha response. Get empty response from validation server"\n            return False\n        \n        response = json.loads(response_string)\n        \n        return response["success"]\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=CB5B-3211,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=CB5B-3211,ou=scripts,o=jans entry:{'description': ['Permission Dynamic Scope script'], 'displayName': ['dynamic_permission'], 'inum': ['CB5B-3211'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n# Author: Yuriy Movchan\r\n#\r\n\r\nfrom io.jans.model.custom.script.type.scope import DynamicScopeType\r\nfrom io.jans.service.cdi.util import CdiUtil\r\nfrom io.jans.as.server.service import UserService\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays, ArrayList\r\n\r\nimport java\r\n\r\nclass DynamicScope(DynamicScopeType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "Permission dynamic scope. Initialization"\r\n\r\n        print "Permission dynamic scope. Initialized successfully"\r\n\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "Permission dynamic scope. Destroy"\r\n        print "Permission dynamic scope. Destroyed successfully"\r\n        return True   \r\n\r\n    # Update Json Web token before signing/encrypring it\r\n    #   dynamicScopeContext is io.jans.as.service.external.context.DynamicScopeExternalContext\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def update(self, dynamicScopeContext, configurationAttributes):\r\n        print "Permission dynamic scope scope. Update method"\r\n\r\n        authorizationGrant = dynamicScopeContext.getAuthorizationGrant()\r\n        user = dynamicScopeContext.getUser()\r\n        jsonWebResponse = dynamicScopeContext.getJsonWebResponse()\r\n        claims = jsonWebResponse.getClaims()\r\n\r\n        userService = CdiUtil.bean(UserService)\r\n        roles = userService.getCustomAttribute(user, "role")\r\n        if roles != None:\r\n            claims.setClaim("role", roles.getValues())\r\n\r\n        return True\r\n\r\n    def getSupportedClaims(self, configurationAttributes):\r\n        return Arrays.asList("role")\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n'], 'jansScrTyp': ['dynamic_scope'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['true'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=031C-4A65,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=031C-4A65,ou=scripts,o=jans entry:{'description': ['Sample Id Generator script'], 'displayName': ['id_generator'], 'inum': ['031C-4A65'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.id import IdGeneratorType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\n\nimport java\n\nclass IdGenerator(IdGeneratorType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Id generator. Initialization"\n        print "Id generator. Initialized successfully"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Id generator. Destroy"\n        print "Id generator. Destroyed successfully"\n        return True   \n\n    def getApiVersion(self):\n        return 11\n\n    # Id generator init method\n    #   appId is application Id\n    #   idType is Id Type\n    #   idPrefix is Id Prefix\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def generateId(self, appId, idType, idPrefix, configurationAttributes):\n        print "Id generator. Generate Id"\n        print "Id generator. Generate Id. AppId: \'", appId, "\', IdType: \'", idType, "\', IdPrefix: \'", idPrefix, "\'"\n\n        # Return None or empty string to trigger default Id generation method\n        return None\n'], 'jansScrTyp': ['id_generator'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=031C-5621,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=031C-5621,ou=scripts,o=jans entry:{'description': ['Sample Dynamic Scope script for org_name'], 'displayName': ['org_name'], 'inum': ['031C-5621'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n# Author: Yuriy Movchan\r\n#\r\n\r\nfrom io.jans.model.custom.script.type.scope import DynamicScopeType\r\nfrom io.jans.as.server.service import UserService\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays, ArrayList\r\n\r\nimport java\r\n\r\nclass DynamicScope(DynamicScopeType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "Dynamic scope. Initialization"\r\n\r\n        print "Dynamic scope. Initialized successfully"\r\n\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "Dynamic scope. Destroy"\r\n        print "Dynamic scope. Destroyed successfully"\r\n        return True   \r\n\r\n    # Update Json Web token before signing/encrypring it\r\n    #   dynamicScopeContext is io.jans.as.service.external.context.DynamicScopeExternalContext\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def update(self, dynamicScopeContext, configurationAttributes):\r\n        print "Dynamic scope. Update method"\r\n\r\n        dynamicScopes = dynamicScopeContext.getDynamicScopes()\r\n        authorizationGrant = dynamicScopeContext.getAuthorizationGrant()\r\n        user = dynamicScopeContext.getUser()\r\n        jsonWebResponse = dynamicScopeContext.getJsonWebResponse()\r\n        claims = jsonWebResponse.getClaims()\r\n\r\n        # Add organization name if there is scope = org_name\r\n        claims.setClaim("org_name", "Janssen, Inc.")\r\n\r\n        return True\r\n\r\n    def getSupportedClaims(self, configurationAttributes):\r\n        return Arrays.asList("org_name")\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n'], 'jansScrTyp': ['dynamic_scope'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=031C-5622,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=031C-5622,ou=scripts,o=jans entry:{'description': ['Sample Dynamic Scope script for work_phone'], 'displayName': ['work_phone'], 'inum': ['031C-5622'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n# Author: Yuriy Movchan\r\n#\r\n\r\nfrom io.jans.model.custom.script.type.scope import DynamicScopeType\r\nfrom io.jans.service.cdi.util import CdiUtil\r\nfrom io.jans.as.server.service import UserService\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays, ArrayList\r\n\r\nimport java\r\n\r\nclass DynamicScope(DynamicScopeType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "Dynamic scope. Initialization"\r\n\r\n        print "Dynamic scope. Initialized successfully"\r\n\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "Dynamic scope. Destroy"\r\n        print "Dynamic scope. Destroyed successfully"\r\n        return True   \r\n\r\n    # Update Json Web token before signing/encrypring it\r\n    #   dynamicScopeContext is io.jans.as.service.external.context.DynamicScopeExternalContext\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def update(self, dynamicScopeContext, configurationAttributes):\r\n        print "Dynamic scope. Update method"\r\n\r\n        dynamicScopes = dynamicScopeContext.getDynamicScopes()\r\n        authorizationGrant = dynamicScopeContext.getAuthorizationGrant()\r\n        user = dynamicScopeContext.getUser()\r\n        jsonWebResponse = dynamicScopeContext.getJsonWebResponse()\r\n        claims = jsonWebResponse.getClaims()\r\n\r\n        # Add work phone if there is scope = work_phone\r\n        userService = CdiUtil.bean(UserService)\r\n        workPhone = userService.getCustomAttribute(user, "telephoneNumber")\r\n        if workPhone != None:\r\n            claims.setClaim("work_phone", workPhone.getValues())\r\n\r\n        return True\r\n\r\n    def getSupportedClaims(self, configurationAttributes):\r\n        return Arrays.asList("work_phone")\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n'], 'jansScrTyp': ['dynamic_scope'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=13D3-E7AD,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=13D3-E7AD,ou=scripts,o=jans entry:{'description': ['Sample Cache Refresh script'], 'displayName': ['cache_refresh'], 'inum': ['13D3-E7AD'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.user import CacheRefreshType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\nfrom io.jans.oxtrust.model import JanssenCustomAttribute\nfrom io.jans.model.custom.script.model.bind import BindCredentials\n\nimport java\n\nclass CacheRefresh(CacheRefreshType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Cache refresh. Initialization"\n        print "Cache refresh. Initialized successfully"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Cache refresh. Destroy"\n        print "Cache refresh. Destroyed successfully"\n        return True\n\n    # Check if this instance conform starting conditions \n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    #   return True/False\n    def isStartProcess(self, configurationAttributes):\n        print "Cache refresh. Is start process method"\n\n        return False\n    \n    # Get bind credentials required to access source server \n    #   configId is the source server\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    #   return None (use password from configuration) or io.jans.model.custom.script.model.bind.BindCredentials\n    def getBindCredentials(self, configId, configurationAttributes):\n        print "Cache refresh. GetBindCredentials method"\n#        if configId == "source":\n#            return BindCredentials("cn=Directory Manager", "password")\n\n        return None\n\n    # Update user entry before persist it\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def updateUser(self, user, configurationAttributes):\n        print "Cache refresh. UpdateUser method"\n\n        attributes = user.getCustomAttributes()\n\n        # Add new attribute preferredLanguage\n        attrPrefferedLanguage = JanssenCustomAttribute("preferredLanguage", "en-us")\n        attributes.add(attrPrefferedLanguage)\n\n        # Add new attribute userPassword\n        attrUserPassword = JanssenCustomAttribute("userPassword", "test")\n        attributes.add(attrUserPassword)\n\n        # Update givenName attribute\n        for attribute in attributes:\n            attrName = attribute.getName()\n            if (("givenname" == StringHelper.toLowerCase(attrName)) and StringHelper.isNotEmpty(attribute.getValue())):\n                attribute.setValue(StringHelper.removeMultipleSpaces(attribute.getValue()) + " (updated)")\n\n        return True\n\n    def getApiVersion(self):\n        return 11\n'], 'jansScrTyp': ['cache_refresh'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=24FD-B96E,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=24FD-B96E,ou=scripts,o=jans entry:{'description': ['OTP Validation of passwords using Yubicloud authentication module'], 'displayName': ['yubicloud'], 'inum': ['24FD-B96E'], 'jansConfProperty': ['{"value1":"yubicloud_uri","value2":"api.yubico.com","description":""}', '{"value1":"yubicloud_api_key","value2":"","description":""}', '{"value1":"yubicloud_id","value2":"","description":""}'], 'jansLevel': ['40'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan, Arunmozhi\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.service import UserService\nfrom io.jans.util import StringHelper\n\nimport java\n\nimport urllib2\nimport urllib\nimport uuid\n\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Yubicloud. Initialization"\n\n        self.api_server = configurationAttributes.get("yubicloud_uri").getValue2()\n        self.api_key = configurationAttributes.get("yubicloud_api_key").getValue2()\n        self.client_id = configurationAttributes.get("yubicloud_id").getValue2()\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Yubicloud. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            print "Yubicloud. Authenticate for step 1"\n\n            identity = CdiUtil.bean(Identity)\n            credentials = identity.getCredentials()\n\n            username = credentials.getUsername()\n            otp = credentials.getPassword()\n\n            # Validate otp length\n            if len(otp) < 32 or len(otp) > 48:\n                print "Yubicloud. Invalid OTP length"\n                return False\n\n            user_service = CdiUtil.bean(UserService)\n            user = user_service.getUser(username)\n\n            public_key = user.getAttribute(\'yubikeyId\')\n\n            # Match the user with the yubikey\n            if public_key not in otp:\n                print "Yubicloud. Public Key not matching OTP"\n                return False\n\n            data = ""\n            try:\n                nonce = str(uuid.uuid4()).replace("-", "")\n                params = urllib.urlencode({"id": self.client_id, "otp": otp, "nonce": nonce})\n                url = "https://" + self.api_server + "/wsapi/2.0/verify/?" + params\n                f = urllib2.urlopen(url)\n                data = f.read()\n            except Exception as e:\n                print "Yubicloud. Exception ", e\n\n            if \'status=OK\' in data:\n                user_service.authenticate(username)\n                print "Yubicloud. Authentication Successful"\n                return True\n\n            print "Yubicloud. End of Step 1. Returning False."\n            return False\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            print "Yubicloud. Prepare for Step 1"\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return ""\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-F995,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-F995,ou=scripts,o=jans entry:{'description': ['Sample UMA RPT Policy'], 'displayName': ['uma_rpt_policy'], 'inum': ['2DAF-F995'], 'jansConfProperty': ['{"value1":"allowed_clients","value2":"","description":""}'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2017, Janssen\r\n#\r\n# Author: Yuriy Zabrovarnyy\r\n#\r\n# Call sequence\r\n# 1. First is call constructor of the Script __init__\r\n# 2. Next init() method\r\n# 3. Next getRequiredClaims() - method returns required claims, so UMA engine checks whether\r\n#    in request RP provided all claims that are required. Pay attention that there can be\r\n#    multiple scripts bound to the scopes, means that UMA engine will build set of required claims\r\n#    from all scripts. If not all claims are provided need_info error is sent to RP.\r\n#    During need_info construction getClaimsGatheringScriptName() method is called\r\n# 4. authorize() method is called if all required claims are provided.\r\n# 5. destroy()\r\n\r\nfrom io.jans.model.custom.script.type.uma import UmaRptPolicyType\r\nfrom io.jans.model.uma import ClaimDefinitionBuilder\r\nfrom java.lang import String\r\n\r\nclass UmaRptPolicy(UmaRptPolicyType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "RPT Policy. Initializing ..."\r\n        print "RPT Policy. Initialized successfully"\r\n\r\n        return True\r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "RPT Policy. Destroying ..."\r\n        print "RPT Policy. Destroyed successfully"\r\n        return True\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n\r\n    # Returns required claims definitions.\r\n    # This method must provide definition of all claims that is used in \'authorize\' method.\r\n    # Note : name in both places must match.\r\n    # %1$s - placeholder for issuer. It uses standard Java Formatter, docs : https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html\r\n    def getRequiredClaims(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\r\n        json = """[\r\n        {\r\n            "issuer" : [ "%1$s" ],\r\n            "name" : "country",\r\n            "claim_token_format" : [ "http://openid.net/specs/openid-connect-core-1_0.html#IDToken" ],\r\n            "claim_type" : "string",\r\n            "friendly_name" : "country"\r\n        },\r\n        {\r\n            "issuer" : [ "%1$s" ],\r\n            "name" : "city",\r\n            "claim_token_format" : [ "http://openid.net/specs/openid-connect-core-1_0.html#IDToken" ],\r\n            "claim_type" : "string",\r\n            "friendly_name" : "city"\r\n        }\r\n        ]"""\r\n        context.addRedirectUserParam("customUserParam1", "value1") # pass some custom parameters to need_info uri. It can be removed if you don\'t need custom parameters.\r\n        return ClaimDefinitionBuilder.build(String.format(json, context.getIssuer()))\r\n\r\n    # Main authorization method. Must return True or False.\r\n    def authorize(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\r\n        print "RPT Policy. Authorizing ..."\r\n\r\n        if context.getClaim("country") == \'US\' and context.getClaim("city") == \'NY\':\r\n            print "Authorized successfully!"\r\n            return True\r\n\r\n        return False\r\n\r\n    # Returns name of the Claims-Gathering script which will be invoked if need_info error is returned.\r\n    def getClaimsGatheringScriptName(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\r\n        context.addRedirectUserParam("customUserParam2", "value2") # pass some custom parameters to need_info uri. It can be removed if you don\'t need custom parameters.\r\n        return "sampleClaimsGathering"'], 'jansScrTyp': ['uma_rpt_policy'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-F9A5,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-F9A5,ou=scripts,o=jans entry:{'description': ['Client authorization UMA RPT Policy for SCIM and Passport'], 'displayName': ['scim_access_policy'], 'inum': ['2DAF-F9A5'], 'jansConfProperty': ['{"value1":"allowed_clients","value2":"","description":""}'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2017, Janssen\n#\n# Author: Jose Gonzalez\n# Adapted from previous 3.0.1 script of Yuriy Movchan\n#\n# oxConfigurationProperty required:\n#   allowed_clients - comma separated list of dns of allowed clients\n#   (i.e. the SCIM RP client)\n\nfrom io.jans.as.model.uma import UmaConstants\nfrom io.jans.model.uma import ClaimDefinitionBuilder\nfrom io.jans.model.custom.script.type.uma import UmaRptPolicyType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList, HashSet\nfrom java.lang import String\n\nclass UmaRptPolicy(UmaRptPolicyType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "RPT Policy. Initializing ..."\n        self.clientsSet = self.prepareClientsSet(configurationAttributes)\n        print "RPT Policy. Initialized successfully"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "RPT Policy. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def getRequiredClaims(self, context):\n        json = """[\n        ]"""\n        return ClaimDefinitionBuilder.build(json)\n\n    def authorize(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\n        print "RPT Policy. Authorizing ..."\n\n        client_id=context.getClient().getClientId()\n        print "UmaRptPolicy. client_id = %s" % client_id\n\n        if (StringHelper.isEmpty(client_id)):\n            return False\n     \n        if (self.clientsSet.contains(client_id)):\n            print "UmaRptPolicy. Authorizing client"\n            return True\n        else:\n            print "UmaRptPolicy. Client isn\'t authorized"\n            return False\n\n    def getClaimsGatheringScriptName(self, context):\n        return UmaConstants.NO_SCRIPT\n\n    def prepareClientsSet(self, configurationAttributes):\n        clientsSet = HashSet()\n        if (not configurationAttributes.containsKey("allowed_clients")):\n            return clientsSet\n\n        allowedClientsList = configurationAttributes.get("allowed_clients").getValue2()\n        if (StringHelper.isEmpty(allowedClientsList)):\n            print "UmaRptPolicy. The property allowed_clients is empty"\n            return clientsSet    \n\n        allowedClientsListArray = StringHelper.split(allowedClientsList, ",")\n        if (ArrayHelper.isEmpty(allowedClientsListArray)):\n            print "UmaRptPolicy. No clients specified in allowed_clients property"\n            return clientsSet\n        \n        # Convert to HashSet to quick search\n        i = 0\n        count = len(allowedClientsListArray)\n        while (i < count):\n            client = allowedClientsListArray[i]\n            clientsSet.add(client)\n            i = i + 1\n\n        return clientsSet\n'], 'jansScrTyp': ['uma_rpt_policy'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-F996,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-F996,ou=scripts,o=jans entry:{'description': ['Sample UMA Claims Gathering'], 'displayName': ['sampleClaimsGathering'], 'inum': ['2DAF-F996'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2017, Janssen\r\n#\r\n# Author: Yuriy Zabrovarnyy\r\n#\r\n\r\nfrom io.jans.model.custom.script.type.uma import UmaClaimsGatheringType\r\n\r\nclass UmaClaimsGathering(UmaClaimsGatheringType):\r\n\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "Claims-Gathering. Initializing ..."\r\n        print "Claims-Gathering. Initialized successfully"\r\n\r\n        return True\r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "Claims-Gathering. Destroying ..."\r\n        print "Claims-Gathering. Destroyed successfully"\r\n        return True\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n\r\n\r\n    # Main gather method. Must return True (if gathering performed successfully) or False (if fail).\r\n    # Method must set claim into context (via context.putClaim(\'name\', value)) in order to persist it (otherwise it will be lost).\r\n    # All user entered values can be access via Map<String, String> context.getPageClaims()\r\n    def gather(self, step, context): # context is reference of io.jans.as.uma.authorization.UmaGatherContext\r\n        print "Claims-Gathering. Gathering ..."\r\n\r\n        if step == 1:\r\n            if (context.getPageClaims().containsKey("country")):\r\n                country = context.getPageClaims().get("country")\r\n                print "Country: " + country\r\n\r\n                context.putClaim("country", country)\r\n                return True\r\n\r\n            print "Claims-Gathering. \'country\' is not provided on step 1."\r\n            return False\r\n\r\n        elif step == 2:\r\n            if (context.getPageClaims().containsKey("city")):\r\n                city = context.getPageClaims().get("city")\r\n                print "City: " + city\r\n\r\n                context.putClaim("city", city)\r\n                print "Claims-Gathering. \'city\' is not provided on step 2."\r\n                return True\r\n\r\n        return False\r\n\r\n    def getNextStep(self, step, context):\r\n        return -1\r\n\r\n    def prepareForStep(self, step, context):\r\n        if step == 10 and not context.isAuthenticated():\r\n            # user is not authenticated, so we are redirecting user to authorization endpoint\r\n            # client_id is specified via configuration attribute.\r\n            # Make sure that given client has redirect_uri to Claims-Gathering Endpoint with parameter authentication=true\r\n            # Sample https://sample.com/restv1/uma/gather_claims?authentication=true\r\n            # If redirect to external url is performated, make sure that viewAction has onPostback="true" (otherwise redirect will not work)\r\n            # After user is authenticated then within the script it\'s possible to get user attributes as\r\n            # context.getUser("uid", "sn")\r\n            # If user is authenticated to current AS (to the same server, not external one) then it\'s possible to\r\n            # access Connect session attributes directly (no need to obtain id_token after redirect with \'code\').\r\n            # To fetch attributes please use getConnectSessionAttributes() method.\r\n\r\n            print "User is not authenticated. Redirect for authentication ..."\r\n            clientId = context.getConfigurationAttributes().get("client_id").getValue2()\r\n            redirectUri = context.getClaimsGatheringEndpoint() + "?authentication=true" # without authentication=true parameter it will not work\r\n            authorizationUrl = context.getAuthorizationEndpoint() + "?client_id=" + clientId + "&redirect_uri=" + redirectUri + "&scope=openid&response_type=code"\r\n            context.redirectToExternalUrl(authorizationUrl) # redirect to external url\r\n            return False\r\n        if step == 10 and context.isAuthenticated(): # example how to get session attribute if user is authenticated to same AS\r\n            arc = context.getConnectSessionAttributes().get("acr")\r\n\r\n        return True\r\n\r\n    def getStepsCount(self, context):\r\n        return 2\r\n\r\n    def getPageForStep(self, step, context):\r\n        if step == 1:\r\n            return "/uma2/sample/country.xhtml"\r\n        elif step == 2:\r\n            return "/uma2/sample/city.xhtml"\r\n        return ""'], 'jansScrTyp': ['uma_claims_gathering'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-AA90,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-AA90,ou=scripts,o=jans entry:{'description': ['Introspection Sample Script'], 'displayName': ['introspection_sample'], 'inum': ['2DAF-AA90'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n#\n\nfrom io.jans.model.custom.script.type.introspection import IntrospectionType\nfrom java.lang import String\n\nclass Introspection(IntrospectionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Introspection script. Initializing ..."\n        print "Introspection script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Introspection script. Destroying ..."\n        print "Introspection script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - apply introspection method, false - ignore it.\n    # This method is called after introspection response is ready. This method can modify introspection response.\n    # Note :\n    # responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenFederation/oxauth project, )\n    def modifyResponse(self, responseAsJsonObject, context):\n        responseAsJsonObject.accumulate("key_from_script", "value_from_script")\n        return True\n\n'], 'jansScrTyp': ['introspection'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-BA90,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-BA90,ou=scripts,o=jans entry:{'description': ['Introspection Custom Parameters Sample Script'], 'displayName': ['introspection_custom_params'], 'inum': ['2DAF-BA90'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2019, Janssen\n#\n# Author: Yuriy Mochan\n#\n#\n\nfrom io.jans.model.custom.script.type.introspection import IntrospectionType\nfrom io.jans.as.model.common import AuthorizationGrantList\nfrom io.jans.as.server.service import SessionIdService\nfrom io.jans.service.cdi.util import CdiUtil\nfrom java.lang import String\n\nclass Introspection(IntrospectionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Introspection script. Initializing ..."\n        print "Introspection script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Introspection script. Destroying ..."\n        print "Introspection script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - apply introspection method, false - ignore it.\n    # This method is called after introspection response is ready. This method can modify introspection response.\n    # Note :\n    # responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenFederation/oxauth project, )\n    def modifyResponse(self, responseAsJsonObject, context):\n        token = context.getHttpRequest().getParameter("token")\n        if token is None:\n            print "Introspection. There is no token in request"\n            return False\n\n        authorizationGrantList = CdiUtil.bean(AuthorizationGrantList)\n        authorizationGrant = authorizationGrantList.getAuthorizationGrantByAccessToken(token);\n        if authorizationGrant is None:\n            print "Introspection. Failed to load authorization grant by token"\n            return False\n\n        # Put user_id into response\n        responseAsJsonObject.accumulate("user_id", authorizationGrant.getUser().getUserId())\n\n        # Put custom parameters into response\n        sessionDn = authorizationGrant.getSessionDn();\n        if sessionDn is None:\n            # There is no session\n            return True\n\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        session = sessionIdService.getSessionById(sessionDn)\n        if sessionDn is None:\n            print "Introspection. Failed to load session \'%s\'" % sessionDn\n            return False\n\n        # Return session_id\n        responseAsJsonObject.accumulate("session_id", sessionDn)\n        \n        sessionAttributes = session.getSessionAttributes()\n        if sessionAttributes is None:\n            # There is no session attributes\n            return True\n\n        # Append custom claims\n        if sessionAttributes.containsKey("custom1"):\n            responseAsJsonObject.accumulate("custom1", sessionAttributes.get("custom1"))\n        if sessionAttributes.containsKey("custom2"):\n            responseAsJsonObject.accumulate("custom2", sessionAttributes.get("custom2"))\n\n        return True\n\n'], 'jansScrTyp': ['introspection'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-CA90,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-CA90,ou=scripts,o=jans entry:{'description': ['Frontchannel logout Sample'], 'displayName': ['frontchannel_logout_sample'], 'inum': ['2DAF-CA90'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n\nfrom io.jans.model.custom.script.type.logout import EndSessionType\nfrom java.lang import String\n\nclass EndSession(EndSessionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "EndSession script. Initializing ..."\n        print "EndSession script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "EndSession script. Destroying ..."\n        print "EndSession script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns string, it must be valid HTML (with iframes according to spec http://openid.net/specs/openid-connect-frontchannel-1_0.html)\n    # This method is called on `/end_session` after actual session is killed and oxauth construct HTML to return to RP.\n    # Note :\n    # context is reference of io.jans.as.service.external.context.EndSessionContext (in https://github.com/JanssenFederation/oxauth project, )\n    def getFrontchannelHtml(self, context):\n        return ""'], 'jansScrTyp': ['end_session'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-AA91,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-AA91,ou=scripts,o=jans entry:{'description': ['Resource Owner Password Credentials Example'], 'displayName': ['resource_owner_password_credentials_example'], 'inum': ['2DAF-AA91'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['from io.jans.model.custom.script.type.owner import ResourceOwnerPasswordCredentialsType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.service.cdi.util import CdiUtil\nfrom java.lang import String\n\nclass ResourceOwnerPasswordCredentials(ResourceOwnerPasswordCredentialsType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "ROPC script. Initializing ..."\n\n        self.usernameParamName = "username"\n        self.passwordParamName = "password"\n\n        print "ROPC script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "ROPC script. Destroying ..."\n        print "ROPC script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns True and set user into context when user authenticated succesfully\n    # Returns False when user not authenticated or it\'s needed to cancel notmal flow\n    # Note :\n    # context is reference of io.jans.as.service.external.context.ExternalResourceOwnerPasswordCredentialsContext#ExternalResourceOwnerPasswordCredentialsContext (in https://github.com/JanssenFederation/oxauth project, )\n    def authenticate(self, context):\n        print "ROPC script. Authenticate"\n        deviceIdParam = context.getHttpRequest().getParameterValues("device_id")\n        if deviceIdParam != None and (deviceIdParam.lenght > 0 ):\n            result = deviceIdParam[0] == "device_id_1"\n            if not result:\n                return False\n\n            # Set auntenticated user in context\n            # context.setUser(user)\n            return True\n\n        # Do generic authentication in other cases\n        authService = CdiUtil.bean(AuthenticationService)\n\n        username = context.getHttpRequest().getParameter(self.usernameParamName)\n        password = context.getHttpRequest().getParameter(self.passwordParamName)\n        result = authService.authenticate(username, password)\n        if not result:\n            print "ROPC script. Authenticate. Could not authenticate user \'%s\' " % username\n            return False\n\n        context.setUser(authService.getAuthenticatedUser())\n\n        return True\n'], 'jansScrTyp': ['resource_owner_password_credentials'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2DAF-BA91,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2DAF-BA91,ou=scripts,o=jans entry:{'description': ['Resource Owner Password Credentials Custom Parameters Example'], 'displayName': ['resource_owner_password_credentials_custom_params_example'], 'inum': ['2DAF-BA91'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2019, Janssen\n#\n# Author: Yuriy Mochan\n#\n#\n\nfrom io.jans.model.custom.script.type.owner import ResourceOwnerPasswordCredentialsType\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.model.common import SessionIdState\nfrom io.jans.as.server.security import Identity\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.model.authorize import AuthorizeRequestParam\nfrom io.jans.as.model.config import Constants\nfrom io.jans.util import StringHelper\nfrom java.lang import String\nfrom java.util import Date, HashMap\n\nclass ResourceOwnerPasswordCredentials(ResourceOwnerPasswordCredentialsType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "ROPC script. Initializing ..."\n        print "ROPC script. Initialized successfully"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "ROPC script. Destroying ..."\n        print "ROPC script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns True and set user into context when user authenticated succesfully\n    # Returns False when user not authenticated or it\'s needed to cancel notmal flow\n    # Note :\n    # context is reference of io.jans.as.service.external.context.ExternalResourceOwnerPasswordCredentialsContext#ExternalResourceOwnerPasswordCredentialsContext (in https://github.com/JanssenFederation/oxauth project, )\n    def authenticate(self, context):\n        print "ROPC script. Authenticate"\n\n        # Do generic authentication\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        username = context.getHttpRequest().getParameter("username")\n        password = context.getHttpRequest().getParameter("password")\n        result = authenticationService.authenticate(username, password)\n        if not result:\n            print "ROPC script. Authenticate. Could not authenticate user \'%s\' " % username\n            return False\n\n        context.setUser(authenticationService.getAuthenticatedUser())\n        print "ROPC script. Authenticate. User \'%s\' authenticated successfully" % username\n        \n\n        # Get cusom parameters from request\n        customParam1Value = context.getHttpRequest().getParameter("custom1")\n        customParam2Value = context.getHttpRequest().getParameter("custom2")\n\n        customParameters = {}\n        customParameters["custom1"] = customParam1Value\n        customParameters["custom2"] = customParam2Value\n        print "ROPC script. Authenticate. User \'%s\'. Creating authenticated session with custom attributes: \'%s\'" % (username, customParameters)\n\n        session = self.createNewAuthenticatedSession(context, customParameters)\n        \n        # This is needed to allow store in token entry sessionId\n        authenticationService.configureEventUser(session)\n\n        print "ROPC script. Authenticate. User \'%s\'. Created authenticated session: \'%s\'" % (username, customParameters)\n\n        return True\n\n    def createNewAuthenticatedSession(self, context, customParameters={}):\n        sessionIdService = CdiUtil.bean(SessionIdService)\n\n        user = context.getUser()\n        client = CdiUtil.bean(Identity).getSessionClient().getClient()\n\n        # Add mandatory session parameters\n        sessionAttributes = HashMap()\n        sessionAttributes.put(Constants.AUTHENTICATED_USER, user.getUserId())\n        sessionAttributes.put(AuthorizeRequestParam.CLIENT_ID, client.getClientId())\n        sessionAttributes.put(AuthorizeRequestParam.PROMPT, "")\n\n        # Add custom session parameters\n        for key, value in customParameters.iteritems():\n            if StringHelper.isNotEmpty(value):\n                sessionAttributes.put(key, value)\n\n        # Generate authenticated session\n        sessionId = sessionIdService.generateAuthenticatedSessionId(context.getHttpRequest(), user.getDn(), sessionAttributes)\n\n        print "ROPC script. Generated session id. DN: \'%s\'" % sessionId.getDn()\n\n        return sessionId\n'], 'jansScrTyp': ['resource_owner_password_credentials'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=4BBE-C6A8,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=4BBE-C6A8,ou=scripts,o=jans entry:{'description': ['Basic (with user locking) authentication module'], 'displayName': ['basic_lock'], 'inum': ['4BBE-C6A8'], 'jansConfProperty': ['{"value1":"invalid_login_count_attribute","value2":"oxCountInvalidLogin","description":""}', '{"value1":"maximum_invalid_login_attemps","value2":"3","description":""}', '{"value1":"lock_expiration_time","value2":"120","description":""}'], 'jansLevel': ['20'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n# Author: Gasmyr Mougang\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.service import CacheService\nfrom io.jans.util import StringHelper\nfrom io.jans.orm.exception import AuthenticationException\nfrom javax.faces.application import FacesMessage\nfrom io.jans.jsf2.message import FacesMessages\nfrom java.time import LocalDateTime, Duration\nfrom java.time.format import DateTimeFormatter\n\nimport java\nimport datetime\nimport json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print "Basic (lock account). Initialization"\n\n        self.invalidLoginCountAttribute = "oxCountInvalidLogin"\n        if configurationAttributes.containsKey("invalid_login_count_attribute"):\n            self.invalidLoginCountAttribute = configurationAttributes.get("invalid_login_count_attribute").getValue2()\n        else:\n            print "Basic (lock account). Initialization. Using default attribute"\n\n        self.maximumInvalidLoginAttemps = 3\n        if configurationAttributes.containsKey("maximum_invalid_login_attemps"):\n            self.maximumInvalidLoginAttemps = StringHelper.toInteger(configurationAttributes.get("maximum_invalid_login_attemps").getValue2())\n        else:\n            print "Basic (lock account). Initialization. Using default number attempts"\n\n        self.lockExpirationTime = 180\n        if configurationAttributes.containsKey("lock_expiration_time"):\n            self.lockExpirationTime = StringHelper.toInteger(configurationAttributes.get("lock_expiration_time").getValue2())\n        else:\n            print "Basic (lock account). Initialization. Using default lock expiration time"\n\n\n        print "Basic (lock account). Initialized successfully. invalid_login_count_attribute: \'%s\', maximum_invalid_login_attemps: \'%s\', lock_expiration_time: \'%s\'" % (self.invalidLoginCountAttribute, self.maximumInvalidLoginAttemps, self.lockExpirationTime)\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Basic (lock account). Destroy"\n        print "Basic (lock account). Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        if step == 1:\n            print "Basic (lock account). Authenticate for step 1"\n            facesMessages = CdiUtil.bean(FacesMessages)\n            facesMessages.setKeepMessages()\n            identity = CdiUtil.bean(Identity)\n            credentials = identity.getCredentials()\n            user_name = credentials.getUsername()\n            user_password = credentials.getPassword()\n            cacheService = CdiUtil.bean(CacheService)\n            userService = CdiUtil.bean(UserService)\n\n\n            logged_in = False\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                try:\n                    logged_in = authenticationService.authenticate(user_name, user_password)\n                except AuthenticationException:\n                    print "Basic (lock account). Authenticate. Failed to authenticate user \'%s\'" % user_name\n\n            if logged_in:\n                self.setUserAttributeValue(user_name, self.invalidLoginCountAttribute, StringHelper.toString(0))\n            else:\n                countInvalidLoginArributeValue = self.getUserAttributeValue(user_name, self.invalidLoginCountAttribute)\n                userSatus = self.getUserAttributeValue(user_name, "jansStatus")\n                print "Current user \'%s\' status is \'%s\'" % ( user_name, userSatus )\n\n                countInvalidLogin = StringHelper.toInteger(countInvalidLoginArributeValue, 0)\n\n                if countInvalidLogin < self.maximumInvalidLoginAttemps:\n                    countInvalidLogin = countInvalidLogin + 1\n                    remainingAttempts = self.maximumInvalidLoginAttemps - countInvalidLogin\n\n                    print "Remaining login count attempts \'%s\' for user \'%s\'" % ( remainingAttempts, user_name )\n\n                    self.setUserAttributeValue(user_name, self.invalidLoginCountAttribute, StringHelper.toString(countInvalidLogin))\n                    if remainingAttempts > 0 and userSatus == "active":\n                        facesMessages.add(FacesMessage.SEVERITY_INFO, StringHelper.toString(remainingAttempts)+" more attempt(s) before account is LOCKED!")\n\n                if (countInvalidLogin >= self.maximumInvalidLoginAttemps) and ((userSatus == None) or (userSatus == "active")):\n                    print "Basic (lock account). Locking \'%s\' for \'%s\' seconds" % ( user_name, self.lockExpirationTime)\n                    self.lockUser(user_name)\n                    return False\n\n                if (countInvalidLogin >= self.maximumInvalidLoginAttemps) and userSatus == "inactive":\n                    print "Basic (lock account). User \'%s\' is locked. Checking if we can unlock him" % user_name\n                    \n                    unlock_and_authenticate = False\n\n                    object_from_store = cacheService.get(None, "lock_user_" + user_name)\n                    if object_from_store == None:\n                        # Object in cache was expired. We need to unlock user\n                        print "Basic (lock account). User locking details for user \'%s\' not exists" % user_name\n                        unlock_and_authenticate = True\n                    else:\n                        # Analyze object from cache\n                        user_lock_details = json.loads(object_from_store)\n\n                        user_lock_details_locked = user_lock_details[\'locked\']\n                        user_lock_details_created = user_lock_details[\'created\']\n                        user_lock_details_created_date = LocalDateTime.parse(user_lock_details_created, DateTimeFormatter.ISO_LOCAL_DATE_TIME)\n                        user_lock_details_created_diff = Duration.between(user_lock_details_created_date, LocalDateTime.now()).getSeconds()\n                        print "Basic (lock account). Get user \'%s\' locking details. locked: \'%s\', Created: \'%s\', Difference in seconds: \'%s\'" % ( user_name, user_lock_details_locked, user_lock_details_created, user_lock_details_created_diff )\n\n                        if user_lock_details_locked and user_lock_details_created_diff >= self.lockExpirationTime:\n                            print "Basic (lock account). Unlocking user \'%s\' after lock expiration" % user_name\n                            unlock_and_authenticate = True\n\n                    if unlock_and_authenticate:\n                        self.unLockUser(user_name)\n                        self.setUserAttributeValue(user_name, self.invalidLoginCountAttribute, StringHelper.toString(0))\n                        logged_in = authenticationService.authenticate(user_name, user_password)\n                        if not logged_in:\n                            # Update number of attempts \n                            self.setUserAttributeValue(user_name, self.invalidLoginCountAttribute, StringHelper.toString(1))\n                            if self.maximumInvalidLoginAttemps == 1:\n                                # Lock user if maximum count login attempts is 1 \n                                self.lockUser(user_name)\n                                return False\n\n\n            return logged_in\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if step == 1:\n            print "Basic (lock account). Prepare for Step 1"\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return ""\n        \n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def getUserAttributeValue(self, user_name, attribute_name):\n        if StringHelper.isEmpty(user_name):\n            return None\n\n        userService = CdiUtil.bean(UserService)\n\n        find_user_by_uid = userService.getUser(user_name, attribute_name)\n        if find_user_by_uid == None:\n            return None\n\n        custom_attribute_value = userService.getCustomAttribute(find_user_by_uid, attribute_name)\n        if custom_attribute_value == None:\n            return None\n        \n        attribute_value = custom_attribute_value.getValue()\n\n        print "Basic (lock account). Get user attribute. User\'s \'%s\' attribute \'%s\' value is \'%s\'" % (user_name, attribute_name, attribute_value)\n\n        return attribute_value\n\n    def setUserAttributeValue(self, user_name, attribute_name, attribute_value):\n        if StringHelper.isEmpty(user_name):\n            return None\n\n        userService = CdiUtil.bean(UserService)\n\n        find_user_by_uid = userService.getUser(user_name)\n        if find_user_by_uid == None:\n            return None\n        \n        userService.setCustomAttribute(find_user_by_uid, attribute_name, attribute_value)\n        updated_user = userService.updateUser(find_user_by_uid)\n\n        print "Basic (lock account). Set user attribute. User\'s \'%s\' attribute \'%s\' value is \'%s\'" % (user_name, attribute_name, attribute_value)\n\n        return updated_user\n\n    def lockUser(self, user_name):\n        if StringHelper.isEmpty(user_name):\n            return None\n\n        userService = CdiUtil.bean(UserService)\n        cacheService= CdiUtil.bean(CacheService)\n        facesMessages = CdiUtil.bean(FacesMessages)\n        facesMessages.setKeepMessages()\n\n        find_user_by_uid = userService.getUser(user_name)\n        if (find_user_by_uid == None):\n            return None\n\n        status_attribute_value = userService.getCustomAttribute(find_user_by_uid, "jansStatus")\n        if status_attribute_value != None:\n            user_status = status_attribute_value.getValue()\n            if StringHelper.equals(user_status, "inactive"):\n                print "Basic (lock account). Lock user. User \'%s\' locked already" % user_name\n                return\n        \n        userService.setCustomAttribute(find_user_by_uid, "jansStatus", "inactive")\n        userService.setCustomAttribute(find_user_by_uid, "oxTrustActive", "false")\n        updated_user = userService.updateUser(find_user_by_uid)\n\n        object_to_store = json.dumps({\'locked\': True, \'created\': LocalDateTime.now().toString()}, separators=(\',\',\':\'))\n\n        cacheService.put(StringHelper.toString(self.lockExpirationTime), "lock_user_"+user_name, object_to_store);\n        facesMessages.add(FacesMessage.SEVERITY_ERROR, "Your account is locked. Please try again after " + StringHelper.toString(self.lockExpirationTime) + " secs")\n\n        print "Basic (lock account). Lock user. User \'%s\' locked" % user_name\n\n    def unLockUser(self, user_name):\n        if StringHelper.isEmpty(user_name):\n            return None\n\n        userService = CdiUtil.bean(UserService)\n        cacheService= CdiUtil.bean(CacheService)\n\n        find_user_by_uid = userService.getUser(user_name)\n        if (find_user_by_uid == None):\n            return None\n\n        object_to_store = json.dumps({\'locked\': False, \'created\': LocalDateTime.now().toString()}, separators=(\',\',\':\'))\n        cacheService.put(StringHelper.toString(self.lockExpirationTime), "lock_user_"+user_name, object_to_store);\n\n        userService.setCustomAttribute(find_user_by_uid, "jansStatus", "active")\n        userService.setCustomAttribute(find_user_by_uid, "oxTrustActive", "true")\n        userService.setCustomAttribute(find_user_by_uid, self.invalidLoginCountAttribute, None)\n        updated_user = userService.updateUser(find_user_by_uid)\n\n\n        print "Basic (lock account). Lock user. User \'%s\' unlocked" % user_name\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=5018-AF9C,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=5018-AF9C,ou=scripts,o=jans entry:{'description': ['UAF authentication module'], 'displayName': ['uaf'], 'inum': ['5018-AF9C'], 'jansConfProperty': ['{"value1":"uaf_server_uri","value2":"https://test.dd.jans.io","description":""}', '{"value1":"uaf_policy_name","value2":"default","description":""}', '{"value1":"qr_options","value2":"{ width: 400, height: 400 }","description":""}', '{"value1":"registration_uri","value2":"https://test.dd.jans.io/identity/register","description":""}', '{"value1":"send_push_notifaction","value2":"false","description":""}'], 'jansLevel': ['70'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\n# Requires the following custom properties and values:\n#   uaf_server_uri: <idp_hostname>\n#\n# These are non mandatory custom properties and values:\n#   uaf_policy_name: default\n#   send_push_notifaction: false\n#   registration_uri: https://<idp_hostname>/identity/register\n#   qr_options: { width: 400, height: 400 }\n\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.as.model.config import Constants\nfrom javax.ws.rs.core import Response\nfrom java.util import Arrays\nfrom io.jans.as.service.net import HttpService\nfrom org.apache.http.params import CoreConnectionPNames\n\nimport sys\nimport java\nimport json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "UAF. Initialization"\n\n        if not configurationAttributes.containsKey("uaf_server_uri"):\n            print "UAF. Initialization. Property uaf_server_uri is mandatory"\n            return False\n\n        self.uaf_server_uri = configurationAttributes.get("uaf_server_uri").getValue2()\n\n        self.uaf_policy_name = "default"\n        if configurationAttributes.containsKey("uaf_policy_name"):\n            self.uaf_policy_name = configurationAttributes.get("uaf_policy_name").getValue2()\n\n        self.send_push_notifaction = False\n        if configurationAttributes.containsKey("send_push_notifaction"):\n            self.send_push_notifaction = StringHelper.toBoolean(configurationAttributes.get("send_push_notifaction").getValue2(), False)\n\n        self.registration_uri = None\n        if configurationAttributes.containsKey("registration_uri"):\n            self.registration_uri = configurationAttributes.get("registration_uri").getValue2()\n\n        self.customQrOptions = {}\n        if configurationAttributes.containsKey("qr_options"):\n            self.customQrOptions = configurationAttributes.get("qr_options").getValue2()\n\n        print "UAF. Initializing HTTP client"\n        httpService = CdiUtil.bean(HttpService)\n        self.http_client = httpService.getHttpsClient()\n        http_client_params = self.http_client.getParams()\n        http_client_params.setIntParameter(CoreConnectionPNames.CONNECTION_TIMEOUT, 15 * 1000)\n\n        print "UAF. Initialized successfully. uaf_server_uri: \'%s\', uaf_policy_name: \'%s\', send_push_notifaction: \'%s\', registration_uri: \'%s\', qr_options: \'%s\'" % (self.uaf_server_uri, self.uaf_policy_name, self.send_push_notifaction, self.registration_uri, self.customQrOptions)\n        \n        print "UAF. Initialized successfully"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "UAF. Destroy"\n        print "UAF. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        session_attributes = identity.getSessionId().getSessionAttributes()\n\n        self.setRequestScopedParameters(identity)\n\n        if (step == 1):\n            print "UAF. Authenticate for step 1"\n\n            user_name = credentials.getUsername()\n\n            authenticated_user = self.processBasicAuthentication(credentials)\n            if authenticated_user == None:\n                return False\n\n            uaf_auth_method = "authenticate"\n            # Uncomment this block if you need to allow user second device registration\n            #enrollment_mode = ServerUtil.getFirstValue(requestParameters, "loginForm:registerButton")\n            #if StringHelper.isNotEmpty(enrollment_mode):\n            #    uaf_auth_method = "enroll"\n            \n            if uaf_auth_method == "authenticate":\n                user_enrollments = self.findEnrollments(credentials)\n                if len(user_enrollments) == 0:\n                    uaf_auth_method = "enroll"\n                    print "UAF. Authenticate for step 1. There is no UAF enrollment for user \'%s\'. Changing uaf_auth_method to \'%s\'" % (user_name, uaf_auth_method)\n\n            print "UAF. Authenticate for step 1. uaf_auth_method: \'%s\'" % uaf_auth_method\n            \n            identity.setWorkingParameter("uaf_auth_method", uaf_auth_method)\n\n            return True\n        elif (step == 2):\n            print "UAF. Authenticate for step 2"\n\n            session = CdiUtil.bean(SessionIdService).getSessionId()\n            if session == None:\n                print "UAF. Prepare for step 2. Failed to determine session_id"\n                return False\n\n            user = authenticationService.getAuthenticatedUser()\n            if (user == None):\n                print "UAF. Authenticate for step 2. Failed to determine user name"\n                return False\n            user_name = user.getUserId()\n\n            uaf_auth_result = ServerUtil.getFirstValue(requestParameters, "auth_result")\n            if uaf_auth_result != "success":\n                print "UAF. Authenticate for step 2. auth_result is \'%s\'" % uaf_auth_result\n                return False\n\n            # Restore state from session\n            uaf_auth_method = session_attributes.get("uaf_auth_method")\n\n            if not uaf_auth_method in [\'enroll\', \'authenticate\']:\n                print "UAF. Authenticate for step 2. Failed to authenticate user. uaf_auth_method: \'%s\'" % uaf_auth_method\n                return False\n\n            # Request STATUS_OBB\n            if True:\n                #TODO: Remove this condition\n                # It\'s workaround becuase it\'s not possible to call STATUS_OBB 2 times. First time on browser and second ime on server\n                uaf_user_device_handle = ServerUtil.getFirstValue(requestParameters, "auth_handle")\n            else:\n                uaf_obb_auth_method = session_attributes.get("uaf_obb_auth_method")\n                uaf_obb_server_uri = session_attributes.get("uaf_obb_server_uri")\n                uaf_obb_start_response = session_attributes.get("uaf_obb_start_response")\n\n                # Prepare STATUS_OBB\n                uaf_obb_start_response_json = json.loads(uaf_obb_start_response)\n                uaf_obb_status_request_dictionary = { "operation": "STATUS_%s" % uaf_obb_auth_method,\n                                                      "userName": user_name,\n                                                      "needDetails": 1,\n                                                      "oobStatusHandle": uaf_obb_start_response_json["oobStatusHandle"],\n                                                    }\n    \n                uaf_obb_status_request = json.dumps(uaf_obb_status_request_dictionary, separators=(\',\',\':\'))\n                print "UAF. Authenticate for step 2. Prepared STATUS request: \'%s\' to send to \'%s\'" % (uaf_obb_status_request, uaf_obb_server_uri)\n\n                uaf_status_obb_response = self.executePost(uaf_obb_server_uri, uaf_obb_status_request)\n                if uaf_status_obb_response == None:\n                    return False\n\n                print "UAF. Authenticate for step 2. Get STATUS response: \'%s\'" % uaf_status_obb_response\n                uaf_status_obb_response_json = json.loads(uaf_status_obb_response)\n                \n                if uaf_status_obb_response_json["statusCode"] != 4000:\n                    print "UAF. Authenticate for step 2. UAF operation status is invalid. statusCode: \'%s\'" % uaf_status_obb_response_json["statusCode"]\n                    return False\n\n                uaf_user_device_handle = uaf_status_obb_response_json["additionalInfo"]["authenticatorsResult"]["handle"]\n\n            if StringHelper.isEmpty(uaf_user_device_handle):\n                print "UAF. Prepare for step 2. Failed to get UAF handle"\n                return False\n\n            uaf_user_external_uid = "uaf:%s" % uaf_user_device_handle\n            print "UAF. Authenticate for step 2. UAF handle: \'%s\'" % uaf_user_external_uid\n\n            if uaf_auth_method == "authenticate":\n                # Validate if user used device with same keYHandle\n                user_enrollments = self.findEnrollments(credentials)\n                if len(user_enrollments) == 0:\n                    uaf_auth_method = "enroll"\n                    print "UAF. Authenticate for step 2. There is no UAF enrollment for user \'%s\'." % user_name\n                    return False\n                \n                for user_enrollment in user_enrollments:\n                    if StringHelper.equalsIgnoreCase(user_enrollment, uaf_user_device_handle):\n                        print "UAF. Authenticate for step 2. There is UAF enrollment for user \'%s\'. User authenticated successfully" % user_name\n                        return True\n            else:\n                userService = CdiUtil.bean(UserService)\n\n                # Double check just to make sure. We did checking in previous step\n                # Check if there is user which has uaf_user_external_uid\n                # Avoid mapping user cert to more than one IDP account\n                find_user_by_external_uid = userService.getUserByAttribute("oxExternalUid", uaf_user_external_uid)\n                if find_user_by_external_uid == None:\n                    # Add uaf_user_external_uid to user\'s external GUID list\n                    find_user_by_external_uid = userService.addUserAttribute(user_name, "oxExternalUid", uaf_user_external_uid)\n                    if find_user_by_external_uid == None:\n                        print "UAF. Authenticate for step 2. Failed to update current user"\n                        return False\n    \n                    return True\n\n            return False\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        session_attributes = identity.getSessionId().getSessionAttributes()\n\n        self.setRequestScopedParameters(identity)\n\n        if (step == 1):\n            return True\n        elif (step == 2):\n            print "UAF. Prepare for step 2"\n\n            session = CdiUtil.bean(SessionIdService).getSessionId()\n            if session == None:\n                print "UAF. Prepare for step 2. Failed to determine session_id"\n                return False\n\n            user = authenticationService.getAuthenticatedUser()\n            if (user == None):\n                print "UAF. Prepare for step 2. Failed to determine user name"\n                return False\n\n            uaf_auth_method = session_attributes.get("uaf_auth_method")\n            if StringHelper.isEmpty(uaf_auth_method):\n                print "UAF. Prepare for step 2. Failed to determine auth_method"\n                return False\n\n            print "UAF. Prepare for step 2. uaf_auth_method: \'%s\'" % uaf_auth_method\n\n            uaf_obb_auth_method = "OOB_REG"\n            uaf_obb_server_uri = self.uaf_server_uri + "/nnl/v2/reg" \n            if StringHelper.equalsIgnoreCase(uaf_auth_method, "authenticate"):\n                uaf_obb_auth_method = "OOB_AUTH"\n                uaf_obb_server_uri = self.uaf_server_uri + "/nnl/v2/auth" \n\n            # Prepare START_OBB\n            uaf_obb_start_request_dictionary = { "operation": "START_%s" % uaf_obb_auth_method,\n                                                 "userName": user.getUserId(),\n                                                 "policyName": "default",\n                                                 "oobMode":\n                                                    { "qr": "true", "rawData": "false", "push": "false" } \n                                               }\n\n            uaf_obb_start_request = json.dumps(uaf_obb_start_request_dictionary, separators=(\',\',\':\'))\n            print "UAF. Prepare for step 2. Prepared START request: \'%s\' to send to \'%s\'" % (uaf_obb_start_request, uaf_obb_server_uri)\n\n            # Request START_OBB\n            uaf_obb_start_response = self.executePost(uaf_obb_server_uri, uaf_obb_start_request)\n            if uaf_obb_start_response == None:\n                return False\n\n            print "UAF. Prepare for step 2. Get START response: \'%s\'" % uaf_obb_start_response\n            uaf_obb_start_response_json = json.loads(uaf_obb_start_response)\n\n            # Prepare STATUS_OBB\n            #TODO: Remove needDetails parameter\n            uaf_obb_status_request_dictionary = { "operation": "STATUS_%s" % uaf_obb_auth_method,\n                                                  "userName": user.getUserId(),\n                                                  "needDetails": 1,\n                                                  "oobStatusHandle": uaf_obb_start_response_json["oobStatusHandle"],\n                                                }\n\n            uaf_obb_status_request = json.dumps(uaf_obb_status_request_dictionary, separators=(\',\',\':\'))\n            print "UAF. Prepare for step 2. Prepared STATUS request: \'%s\' to send to \'%s\'" % (uaf_obb_status_request, uaf_obb_server_uri)\n\n            identity.setWorkingParameter("uaf_obb_auth_method", uaf_obb_auth_method)\n            identity.setWorkingParameter("uaf_obb_server_uri", uaf_obb_server_uri)\n            identity.setWorkingParameter("uaf_obb_start_response", uaf_obb_start_response)\n            identity.setWorkingParameter("qr_image", uaf_obb_start_response_json["modeResult"]["qrCode"]["qrImage"])\n            identity.setWorkingParameter("uaf_obb_status_request", uaf_obb_status_request)\n\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return Arrays.asList("uaf_auth_method", "uaf_obb_auth_method", "uaf_obb_server_uri", "uaf_obb_start_response")\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 2\n\n    def getPageForStep(self, configurationAttributes, step):\n        if (step == 2):\n            return "/auth/uaf/login.xhtml"\n\n        return ""\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def setRequestScopedParameters(self, identity):\n        if self.registration_uri != None:\n            identity.setWorkingParameter("external_registration_uri", self.registration_uri)\n        identity.setWorkingParameter("qr_options", self.customQrOptions)\n\n    def processBasicAuthentication(self, credentials):\n        userService = CdiUtil.bean(UserService)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        user_name = credentials.getUsername()\n        user_password = credentials.getPassword()\n\n        logged_in = False\n        if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n            logged_in = authenticationService.authenticate(user_name, user_password)\n\n        if not logged_in:\n            return None\n\n        find_user_by_uid = authenticationService.getAuthenticatedUser()\n        if find_user_by_uid == None:\n            print "UAF. Process basic authentication. Failed to find user \'%s\'" % user_name\n            return None\n        \n        return find_user_by_uid\n\n    def findEnrollments(self, credentials):\n        result = []\n\n        userService = CdiUtil.bean(UserService)\n        user_name = credentials.getUsername()\n        user = userService.getUser(user_name, "oxExternalUid")\n        if user == None:\n            print "UAF. Find enrollments. Failed to find user"\n            return result\n        \n        user_custom_ext_attribute = userService.getCustomAttribute(user, "oxExternalUid")\n        if user_custom_ext_attribute == None:\n            return result\n        \n        uaf_prefix = "uaf:"\n        uaf_prefix_length = len(uaf_prefix) \n        for user_external_uid in user_custom_ext_attribute.getValues():\n            index = user_external_uid.find(uaf_prefix)\n            if index != -1:\n                enrollment_uid = user_external_uid[uaf_prefix_length:]\n                result.append(enrollment_uid)\n        \n        return result\n\n    def executePost(self, request_uri, request_data):\n        httpService = CdiUtil.bean(HttpService)\n\n        request_headers = { "Content-type" : "application/json; charset=UTF-8", "Accept" : "application/json" }\n\n        try:\n            http_service_response = httpService.executePost(self.http_client, request_uri, None, request_headers, request_data)\n            http_response = http_service_response.getHttpResponse()\n        except:\n            print "UAF. Validate POST response. Exception: ", sys.exc_info()[1]\n            return None\n\n        try:\n            if not httpService.isResponseStastusCodeOk(http_response):\n                print "UAF. Validate POST response. Get invalid response from  server: %s" % str(http_response.getStatusLine().getStatusCode())\n                httpService.consume(http_response)\n                return None\n    \n            response_bytes = httpService.getResponseContent(http_response)\n            response_string = httpService.convertEntityToString(response_bytes)\n            httpService.consume(http_response)\n            \n            return response_string\n        finally:\n            http_service_response.closeConnection()\n        return None\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=5018-D4BF,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=5018-D4BF,ou=scripts,o=jans entry:{'description': ['HOTP/TOPT authentication module'], 'displayName': ['otp'], 'inum': ['5018-D4BF'], 'jansConfProperty': ['{"value1":"otp_type","value2":"totp","description":""}', '{"value1":"otp_conf_file","value2":"/etc/certs/otp_configuration.json","description":""}', '{"value1":"issuer","value2":"Gluu Inc","description":""}', '{"value1":"label","value2":"Gluu OTP","description":""}', '{"value1":"qr_options","value2":"{ size: 400, mSize: 0.05 }","description":""}', '{"value1":"registration_uri","value2":"https://test.dd.jans.io/identity/register","description":""}'], 'jansLevel': ['40'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\n# Requires the following custom properties and values:\n#   otp_type: totp/hotp\n#   issuer: Janssen Inc\n#   otp_conf_file: /etc/certs/otp_configuration.json\n#\n# These are non mandatory custom properties and values:\n#   label: Janssen OTP\n#   qr_options: { width: 400, height: 400 }\n#   registration_uri: https://ce-dev.jans.org/identity/register\n\nimport jarray\nimport json\nimport sys\nfrom com.google.common.io import BaseEncoding\nfrom com.lochbridge.oath.otp import HOTP\nfrom com.lochbridge.oath.otp import HOTPValidator\nfrom com.lochbridge.oath.otp import HmacShaAlgorithm\nfrom com.lochbridge.oath.otp import TOTP\nfrom com.lochbridge.oath.otp.keyprovisioning import OTPAuthURIBuilder\nfrom com.lochbridge.oath.otp.keyprovisioning import OTPKey\nfrom com.lochbridge.oath.otp.keyprovisioning.OTPKey import OTPType\nfrom java.security import SecureRandom\nfrom java.util import Arrays\nfrom java.util.concurrent import TimeUnit\nfrom javax.faces.application import FacesMessage\nfrom io.jans.jsf2.message import FacesMessages\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.security import Identity\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.util import StringHelper\n\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "OTP. Initialization"\n\n        if not configurationAttributes.containsKey("otp_type"):\n            print "OTP. Initialization. Property otp_type is mandatory"\n            return False\n        self.otpType = configurationAttributes.get("otp_type").getValue2()\n\n        if not self.otpType in ["hotp", "totp"]:\n            print "OTP. Initialization. Property value otp_type is invalid"\n            return False\n\n        if not configurationAttributes.containsKey("issuer"):\n            print "OTP. Initialization. Property issuer is mandatory"\n            return False\n        self.otpIssuer = configurationAttributes.get("issuer").getValue2()\n\n        self.customLabel = None\n        if configurationAttributes.containsKey("label"):\n            self.customLabel = configurationAttributes.get("label").getValue2()\n\n        self.customQrOptions = {}\n        if configurationAttributes.containsKey("qr_options"):\n            self.customQrOptions = configurationAttributes.get("qr_options").getValue2()\n\n        self.registrationUri = None\n        if configurationAttributes.containsKey("registration_uri"):\n            self.registrationUri = configurationAttributes.get("registration_uri").getValue2()\n\n        validOtpConfiguration = self.loadOtpConfiguration(configurationAttributes)\n        if not validOtpConfiguration:\n            return False\n\n        print "OTP. Initialized successfully"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "OTP. Destroy"\n        print "OTP. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        print "getNextStep Invoked"\n        # If user not pass current step change step to previous\n        identity = CdiUtil.bean(Identity)\n        retry_current_step = identity.getWorkingParameter("retry_current_step")\n        if retry_current_step:\n            print "OTP. Get next step. Retrying current step %s" % step\n            # Remove old QR code\n            #identity.setWorkingParameter("super.jans.request", "timeout")\n            resultStep = step\n            return resultStep\n        return -1\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        self.setRequestScopedParameters(identity)\n\n        if step == 1:\n            print "OTP. Authenticate for step 1"\n            authenticated_user = self.processBasicAuthentication(credentials)\n            if authenticated_user == None:\n                return False\n\n            otp_auth_method = "authenticate"\n            # Uncomment this block if you need to allow user second OTP registration\n            #enrollment_mode = ServerUtil.getFirstValue(requestParameters, "loginForm:registerButton")\n            #if StringHelper.isNotEmpty(enrollment_mode):\n            #    otp_auth_method = "enroll"\n\n            if otp_auth_method == "authenticate":\n                user_enrollments = self.findEnrollments(authenticated_user.getUserId())\n                if len(user_enrollments) == 0:\n                    otp_auth_method = "enroll"\n                    print "OTP. Authenticate for step 1. There is no OTP enrollment for user \'%s\'. Changing otp_auth_method to \'%s\'" % (authenticated_user.getUserId(), otp_auth_method)\n\n            if otp_auth_method == "enroll":\n                print "OTP. Authenticate for step 1. Setting count steps: \'%s\'" % 3\n                identity.setWorkingParameter("otp_count_login_steps", 3)\n\n            print "OTP. Authenticate for step 1. otp_auth_method: \'%s\'" % otp_auth_method\n            identity.setWorkingParameter("otp_auth_method", otp_auth_method)\n\n            return True\n        elif step == 2:\n            print "OTP. Authenticate for step 2"\n\n            authenticationService = CdiUtil.bean(AuthenticationService)\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "OTP. Authenticate for step 2. Failed to determine user name"\n                return False\n\n            session_id_validation = self.validateSessionId(identity)\n            if not session_id_validation:\n                return False\n\n            # Restore state from session\n            identity.setWorkingParameter("retry_current_step", False)\n            otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n            if otp_auth_method == \'enroll\':\n                auth_result = ServerUtil.getFirstValue(requestParameters, "auth_result")\n                if not StringHelper.isEmpty(auth_result):\n                    # defect fix #1225  - Retry the step, show QR code again\n                    if auth_result == \'timeout\':\n\t\t\t\t\t\tprint "OTP. QR-code timeout. Authenticate for step %s. Reinitializing current step" % step\n\t\t\t\t\t\tidentity.setWorkingParameter("retry_current_step", True)\n\t\t\t\t\t\treturn True\n\n                    print "OTP. Authenticate for step 2. User not enrolled OTP"\n                    return False\n\n                print "OTP. Authenticate for step 2. Skipping this step during enrollment"\n                return True\n\n            otp_auth_result = self.processOtpAuthentication(requestParameters, user.getUserId(), identity, otp_auth_method)\n            print "OTP. Authenticate for step 2. OTP authentication result: \'%s\'" % otp_auth_result\n\n            return otp_auth_result\n        elif step == 3:\n            print "OTP. Authenticate for step 3"\n\n            authenticationService = CdiUtil.bean(AuthenticationService)\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "OTP. Authenticate for step 2. Failed to determine user name"\n                return False\n\n            session_id_validation = self.validateSessionId(identity)\n            if not session_id_validation:\n                return False\n\n            # Restore state from session\n            otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n            if otp_auth_method != \'enroll\':\n                return False\n\n            otp_auth_result = self.processOtpAuthentication(requestParameters, user.getUserId(), identity, otp_auth_method)\n            print "OTP. Authenticate for step 3. OTP authentication result: \'%s\'" % otp_auth_result\n\n            return otp_auth_result\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        self.setRequestScopedParameters(identity)\n\n        if step == 1:\n            print "OTP. Prepare for step 1"\n\n            return True\n        elif step == 2:\n            print "OTP. Prepare for step 2"\n\n            session_id_validation = self.validateSessionId(identity)\n            if not session_id_validation:\n                return False\n\n            otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n            print "OTP. Prepare for step 2. otp_auth_method: \'%s\'" % otp_auth_method\n\n            if otp_auth_method == \'enroll\':\n                authenticationService = CdiUtil.bean(AuthenticationService)\n                user = authenticationService.getAuthenticatedUser()\n                if user == None:\n                    print "OTP. Prepare for step 2. Failed to load user enty"\n                    return False\n\n                if self.otpType == "hotp":\n                    otp_secret_key = self.generateSecretHotpKey()\n                    otp_enrollment_request = self.generateHotpSecretKeyUri(otp_secret_key, self.otpIssuer, user.getAttribute("displayName"))\n                elif self.otpType == "totp":\n                    otp_secret_key = self.generateSecretTotpKey()\n                    otp_enrollment_request = self.generateTotpSecretKeyUri(otp_secret_key, self.otpIssuer, user.getAttribute("displayName"))\n                else:\n                    print "OTP. Prepare for step 2. Unknown OTP type: \'%s\'" % self.otpType\n                    return False\n\n                print "OTP. Prepare for step 2. Prepared enrollment request for user: \'%s\'" % user.getUserId()\n                identity.setWorkingParameter("otp_secret_key", self.toBase64Url(otp_secret_key))\n                identity.setWorkingParameter("otp_enrollment_request", otp_enrollment_request)\n\n            return True\n        elif step == 3:\n            print "OTP. Prepare for step 3"\n\n            session_id_validation = self.validateSessionId(identity)\n            if not session_id_validation:\n                return False\n\n            otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n            print "OTP. Prepare for step 3. otp_auth_method: \'%s\'" % otp_auth_method\n\n            if otp_auth_method == \'enroll\':\n                return True\n\n        return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return Arrays.asList("otp_auth_method", "otp_count_login_steps", "otp_secret_key", "otp_enrollment_request","retry_current_step")\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        identity = CdiUtil.bean(Identity)\n\n        if identity.isSetWorkingParameter("otp_count_login_steps"):\n            return StringHelper.toInteger("%s" % identity.getWorkingParameter("otp_count_login_steps"))\n        else:\n            return 2\n\n    def getPageForStep(self, configurationAttributes, step):\n        if step == 2:\n            identity = CdiUtil.bean(Identity)\n\n            otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n            print "OTP. Gep page for step 2. otp_auth_method: \'%s\'" % otp_auth_method\n\n            if otp_auth_method == \'enroll\':\n                return "/auth/otp/enroll.xhtml"\n            else:\n                return "/auth/otp/otplogin.xhtml"\n        elif step == 3:\n            return "/auth/otp/otplogin.xhtml"\n\n        return ""\n\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def setRequestScopedParameters(self, identity):\n        if self.registrationUri != None:\n            identity.setWorkingParameter("external_registration_uri", self.registrationUri)\n\n        if self.customLabel != None:\n            identity.setWorkingParameter("qr_label", self.customLabel)\n\n        identity.setWorkingParameter("qr_options", self.customQrOptions)\n\n    def loadOtpConfiguration(self, configurationAttributes):\n        print "OTP. Load OTP configuration"\n        if not configurationAttributes.containsKey("otp_conf_file"):\n            return False\n\n        otp_conf_file = configurationAttributes.get("otp_conf_file").getValue2()\n\n        # Load configuration from file\n        f = open(otp_conf_file, \'r\')\n        try:\n            otpConfiguration = json.loads(f.read())\n        except:\n            print "OTP. Load OTP configuration. Failed to load configuration from file:", otp_conf_file\n            return False\n        finally:\n            f.close()\n\n        # Check configuration file settings\n        try:\n            self.hotpConfiguration = otpConfiguration["hotp"]\n            self.totpConfiguration = otpConfiguration["totp"]\n            \n            hmacShaAlgorithm = self.totpConfiguration["hmacShaAlgorithm"]\n            hmacShaAlgorithmType = None\n\n            if StringHelper.equalsIgnoreCase(hmacShaAlgorithm, "sha1"):\n                hmacShaAlgorithmType = HmacShaAlgorithm.HMAC_SHA_1\n            elif StringHelper.equalsIgnoreCase(hmacShaAlgorithm, "sha256"):\n                hmacShaAlgorithmType = HmacShaAlgorithm.HMAC_SHA_256\n            elif StringHelper.equalsIgnoreCase(hmacShaAlgorithm, "sha512"):\n                hmacShaAlgorithmType = HmacShaAlgorithm.HMAC_SHA_512\n            else:\n                print "OTP. Load OTP configuration. Invalid TOTP HMAC SHA algorithm: \'%s\'" % hmacShaAlgorithm\n                 \n            self.totpConfiguration["hmacShaAlgorithmType"] = hmacShaAlgorithmType\n        except:\n            print "OTP. Load OTP configuration. Invalid configuration file \'%s\' format. Exception: \'%s\'" % (otp_conf_file, sys.exc_info()[1])\n            return False\n        \n\n        return True\n\n    def processBasicAuthentication(self, credentials):\n        userService = CdiUtil.bean(UserService)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        user_name = credentials.getUsername()\n        user_password = credentials.getPassword()\n\n        logged_in = False\n        if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n            logged_in = authenticationService.authenticate(user_name, user_password)\n\n        if not logged_in:\n            return None\n\n        find_user_by_uid = authenticationService.getAuthenticatedUser()\n        if find_user_by_uid == None:\n            print "OTP. Process basic authentication. Failed to find user \'%s\'" % user_name\n            return None\n        \n        return find_user_by_uid\n\n    def findEnrollments(self, user_name, skipPrefix = True):\n        result = []\n\n        userService = CdiUtil.bean(UserService)\n        user = userService.getUser(user_name, "oxExternalUid")\n        if user == None:\n            print "OTP. Find enrollments. Failed to find user"\n            return result\n        \n        user_custom_ext_attribute = userService.getCustomAttribute(user, "oxExternalUid")\n        if user_custom_ext_attribute == None:\n            return result\n\n        otp_prefix = "%s:" % self.otpType\n        \n        otp_prefix_length = len(otp_prefix) \n        for user_external_uid in user_custom_ext_attribute.getValues():\n            index = user_external_uid.find(otp_prefix)\n            if index != -1:\n                if skipPrefix:\n                    enrollment_uid = user_external_uid[otp_prefix_length:]\n                else:\n                    enrollment_uid = user_external_uid\n\n                result.append(enrollment_uid)\n        \n        return result\n\n    def validateSessionId(self, identity):\n        session = CdiUtil.bean(SessionIdService).getSessionId()\n        if session == None:\n            print "OTP. Validate session id. Failed to determine session_id"\n            return False\n\n        otp_auth_method = identity.getWorkingParameter("otp_auth_method")\n        if not otp_auth_method in [\'enroll\', \'authenticate\']:\n            print "OTP. Validate session id. Failed to authenticate user. otp_auth_method: \'%s\'" % otp_auth_method\n            return False\n\n        return True\n\n    def processOtpAuthentication(self, requestParameters, user_name, identity, otp_auth_method):\n        facesMessages = CdiUtil.bean(FacesMessages)\n        facesMessages.setKeepMessages()\n\n        userService = CdiUtil.bean(UserService)\n\n        otpCode = ServerUtil.getFirstValue(requestParameters, "loginForm:otpCode")\n        if StringHelper.isEmpty(otpCode):\n            facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to authenticate. OTP code is empty")\n            print "OTP. Process OTP authentication. otpCode is empty"\n\n            return False\n        \n        if otp_auth_method == "enroll":\n            # Get key from session\n            otp_secret_key_encoded = identity.getWorkingParameter("otp_secret_key")\n            if otp_secret_key_encoded == None:\n                print "OTP. Process OTP authentication. OTP secret key is invalid"\n                return False\n            \n            otp_secret_key = self.fromBase64Url(otp_secret_key_encoded)\n\n            if self.otpType == "hotp":\n                validation_result = self.validateHotpKey(otp_secret_key, 1, otpCode)\n                \n                if (validation_result != None) and validation_result["result"]:\n                    print "OTP. Process HOTP authentication during enrollment. otpCode is valid"\n                    # Store HOTP Secret Key and moving factor in user entry\n                    otp_user_external_uid = "hotp:%s;%s" % ( otp_secret_key_encoded, validation_result["movingFactor"] )\n\n                    # Add otp_user_external_uid to user\'s external GUID list\n                    find_user_by_external_uid = userService.addUserAttribute(user_name, "oxExternalUid", otp_user_external_uid)\n                    if find_user_by_external_uid != None:\n                        return True\n\n                    print "OTP. Process HOTP authentication during enrollment. Failed to update user entry"\n            elif self.otpType == "totp":\n                validation_result = self.validateTotpKey(otp_secret_key, otpCode,user_name)\n                if (validation_result != None) and validation_result["result"]:\n                    print "OTP. Process TOTP authentication during enrollment. otpCode is valid"\n                    # Store TOTP Secret Key and moving factor in user entry\n                    otp_user_external_uid = "totp:%s" % otp_secret_key_encoded\n\n                    # Add otp_user_external_uid to user\'s external GUID list\n                    find_user_by_external_uid = userService.addUserAttribute(user_name, "oxExternalUid", otp_user_external_uid)\n                    if find_user_by_external_uid != None:\n                        return True\n\n                    print "OTP. Process TOTP authentication during enrollment. Failed to update user entry"\n        elif otp_auth_method == "authenticate":\n            user_enrollments = self.findEnrollments(user_name)\n\n            if len(user_enrollments) == 0:\n                print "OTP. Process OTP authentication. There is no OTP enrollment for user \'%s\'" % user_name\n                facesMessages.add(FacesMessage.SEVERITY_ERROR, "There is no valid OTP user enrollments")\n                return False\n\n            if self.otpType == "hotp":\n                for user_enrollment in user_enrollments:\n                    user_enrollment_data = user_enrollment.split(";")\n                    otp_secret_key_encoded = user_enrollment_data[0]\n\n                    # Get current moving factor from user entry\n                    moving_factor = StringHelper.toInteger(user_enrollment_data[1])\n                    otp_secret_key = self.fromBase64Url(otp_secret_key_encoded)\n\n                    # Validate TOTP\n                    validation_result = self.validateHotpKey(otp_secret_key, moving_factor, otpCode)\n                    if (validation_result != None) and validation_result["result"]:\n                        print "OTP. Process HOTP authentication during authentication. otpCode is valid"\n                        otp_user_external_uid = "hotp:%s;%s" % ( otp_secret_key_encoded, moving_factor )\n                        new_otp_user_external_uid = "hotp:%s;%s" % ( otp_secret_key_encoded, validation_result["movingFactor"] )\n    \n                        # Update moving factor in user entry\n                        find_user_by_external_uid = userService.replaceUserAttribute(user_name, "oxExternalUid", otp_user_external_uid, new_otp_user_external_uid)\n                        if find_user_by_external_uid != None:\n                            return True\n    \n                        print "OTP. Process HOTP authentication during authentication. Failed to update user entry"\n            elif self.otpType == "totp":\n                for user_enrollment in user_enrollments:\n                    otp_secret_key = self.fromBase64Url(user_enrollment)\n\n                    # Validate TOTP\n                    validation_result = self.validateTotpKey(otp_secret_key, otpCode, user_name)\n                    if (validation_result != None) and validation_result["result"]:\n                        print "OTP. Process TOTP authentication during authentication. otpCode is valid"\n                        return True\n\n        facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to authenticate. OTP code is invalid")\n        print "OTP. Process OTP authentication. OTP code is invalid"\n\n        return False\n\n    # Shared HOTP/TOTP methods\n    def generateSecretKey(self, keyLength):\n        bytes = jarray.zeros(keyLength, "b")\n        secureRandom = SecureRandom()\n        secureRandom.nextBytes(bytes)\n        \n        return bytes\n    \n    # HOTP methods\n    def generateSecretHotpKey(self):\n        keyLength = self.hotpConfiguration["keyLength"]\n        \n        return self.generateSecretKey(keyLength)\n\n    def generateHotpKey(self, secretKey, movingFactor):\n        digits = self.hotpConfiguration["digits"]\n\n        hotp = HOTP.key(secretKey).digits(digits).movingFactor(movingFactor).build()\n        \n        return hotp.value()\n\n    def validateHotpKey(self, secretKey, movingFactor, totpKey):\n        lookAheadWindow = self.hotpConfiguration["lookAheadWindow"]\n        digits = self.hotpConfiguration["digits"]\n\n        htopValidationResult = HOTPValidator.lookAheadWindow(lookAheadWindow).validate(secretKey, movingFactor, digits, totpKey)\n        if htopValidationResult.isValid():\n            return { "result": True, "movingFactor": htopValidationResult.getNewMovingFactor() }\n\n        return { "result": False, "movingFactor": None }\n\n    def generateHotpSecretKeyUri(self, secretKey, issuer, userDisplayName):\n        digits = self.hotpConfiguration["digits"]\n\n        secretKeyBase32 = self.toBase32(secretKey)\n        otpKey = OTPKey(secretKeyBase32, OTPType.HOTP)\n        label = issuer + " %s" % userDisplayName\n\n        otpAuthURI = OTPAuthURIBuilder.fromKey(otpKey).label(label).issuer(issuer).digits(digits).build()\n\n        return otpAuthURI.toUriString()\n\n    # TOTP methods\n    def generateSecretTotpKey(self):\n        keyLength = self.totpConfiguration["keyLength"]\n        \n        return self.generateSecretKey(keyLength)\n\n    def generateTotpKey(self, secretKey):\n        digits = self.totpConfiguration["digits"]\n        timeStep = self.totpConfiguration["timeStep"]\n        hmacShaAlgorithmType = self.totpConfiguration["hmacShaAlgorithmType"]\n\n        totp = TOTP.key(secretKey).digits(digits).timeStep(TimeUnit.SECONDS.toMillis(timeStep)).hmacSha(hmacShaAlgorithmType).build()\n        \n        return totp.value()\n\n    def validateTotpKey(self, secretKey, totpKey, user_name):\n        localTotpKey = self.generateTotpKey(secretKey)\n        cachedOTP = self.getCachedOTP(user_name)\n\n        if StringHelper.equals(localTotpKey, totpKey) and not StringHelper.equals(localTotpKey, cachedOTP):\n            userService = CdiUtil.bean(UserService)\n            if cachedOTP is None:\n                userService.addUserAttribute(user_name, "oxOTPCache",localTotpKey)\n            else :\n                userService.replaceUserAttribute(user_name, "oxOTPCache", cachedOTP, localTotpKey)\n            print "OTP. Caching OTP: \'%s\'" % localTotpKey\n            return { "result": True }\n        return { "result": False }\n\t\n    def getCachedOTP(self, user_name):\n        userService = CdiUtil.bean(UserService)\n        user = userService.getUser(user_name, "oxOTPCache")\n        if user is None:\n            print "OTP. Get Cached OTP. Failed to find OTP"\n            return None\n        customAttribute = userService.getCustomAttribute(user, "oxOTPCache")\n        \n        if customAttribute is None:\n            print "OTP. Custom attribute is null"\n            return None\n        user_cached_OTP = customAttribute.getValue()\n        if user_cached_OTP is None:\n            print "OTP. no OTP is present in LDAP"\n            return None\n        \n        print "OTP.Cached OTP: \'%s\'" % user_cached_OTP\n        return user_cached_OTP\n        \n    def generateTotpSecretKeyUri(self, secretKey, issuer, userDisplayName):\n        digits = self.totpConfiguration["digits"]\n        timeStep = self.totpConfiguration["timeStep"]\n\n        secretKeyBase32 = self.toBase32(secretKey)\n        otpKey = OTPKey(secretKeyBase32, OTPType.TOTP)\n        label = issuer + " %s" % userDisplayName\n\n        otpAuthURI = OTPAuthURIBuilder.fromKey(otpKey).label(label).issuer(issuer).digits(digits).timeStep(TimeUnit.SECONDS.toMillis(timeStep)).build()\n\n        return otpAuthURI.toUriString()\n\n    # Utility methods\n    def toBase32(self, bytes):\n        return BaseEncoding.base32().omitPadding().encode(bytes)\n\n    def toBase64Url(self, bytes):\n        return BaseEncoding.base64Url().encode(bytes)\n\n    def fromBase64Url(self, chars):\n        return BaseEncoding.base64Url().decode(chars)\n\n\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=5018-F9CF,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=5018-F9CF,ou=scripts,o=jans entry:{'description': ['DUO authentication module'], 'displayName': ['duo'], 'inum': ['5018-F9CF'], 'jansConfProperty': ['{"value1":"duo_creds_file","value2":"/etc/certs/duo_creds.json","description":""}', '{"value1":"duo_host","value2":"api-random.duosecurity.com","description":""}'], 'jansLevel': ['50'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.service import MailService\nfrom io.jans.util import ArrayHelper\nfrom io.jans.util import StringHelper\nfrom java.util import Arrays\n\nimport duo_web\nimport json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Duo. Initialization"\n\n        duo_creds_file = configurationAttributes.get("duo_creds_file").getValue2()\n        # Load credentials from file\n        f = open(duo_creds_file, \'r\')\n        try:\n            creds = json.loads(f.read())\n        except:\n            print "Duo. Initialization. Failed to load creds from file:", duo_creds_file\n            return False\n        finally:\n            f.close()\n\n        self.ikey = str(creds["ikey"])\n        self.skey = str(creds["skey"])\n        self.akey = str(creds["akey"])\n\n        self.use_duo_group = False\n        if (configurationAttributes.containsKey("duo_group")):\n            self.duo_group = configurationAttributes.get("duo_group").getValue2()\n            self.use_duo_group = True\n            print "Duo. Initialization. Using Duo only if user belong to group:", self.duo_group\n\n        self.use_audit_group = False\n        if (configurationAttributes.containsKey("audit_group")):\n            self.audit_group = configurationAttributes.get("audit_group").getValue2()\n\n            if (not configurationAttributes.containsKey("audit_group_email")):\n                print "Duo. Initialization. Property audit_group_email is not specified"\n                return False\n\n            self.audit_email = configurationAttributes.get("audit_group_email").getValue2()\n            self.use_audit_group = True\n\n            print "Duo. Initialization. Using audito group:", self.audit_group\n            \n        if (self.use_duo_group or self.use_audit_group):\n            if (not configurationAttributes.containsKey("audit_attribute")):\n                print "Duo. Initialization. Property audit_attribute is not specified"\n                return False\n            else:\n                self.audit_attribute = configurationAttributes.get("audit_attribute").getValue2()\n\n        print "Duo. Initialized successfully"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Duo. Destroy"\n        print "Duo. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        duo_host = configurationAttributes.get("duo_host").getValue2()\n\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        identity = CdiUtil.bean(Identity)\n\n        if (step == 1):\n            print "Duo. Authenticate for step 1"\n\n            # Check if user authenticated already in another custom script\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                credentials = identity.getCredentials()\n                user_name = credentials.getUsername()\n                user_password = credentials.getPassword()\n    \n                logged_in = False\n                if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                    userService = CdiUtil.bean(UserService)\n                    logged_in = authenticationService.authenticate(user_name, user_password)\n    \n                if (not logged_in):\n                    return False\n    \n                user = authenticationService.getAuthenticatedUser()\n\n            if (self.use_duo_group):\n                print "Duo. Authenticate for step 1. Checking if user belong to Duo group"\n                is_member_duo_group = self.isUserMemberOfGroup(user, self.audit_attribute, self.duo_group)\n                if (is_member_duo_group):\n                    print "Duo. Authenticate for step 1. User \'" + user.getUserId() + "\' member of Duo group"\n                    duo_count_login_steps = 2\n                else:\n                    self.processAuditGroup(user)\n                    duo_count_login_steps = 1\n\n                identity.setWorkingParameter("duo_count_login_steps", duo_count_login_steps)\n\n            return True\n        elif (step == 2):\n            print "Duo. Authenticate for step 2"\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "Duo. Authenticate for step 2. Failed to determine user name"\n                return False\n\n            user_name = user.getUserId()\n\n            sig_response_array = requestParameters.get("sig_response")\n            if ArrayHelper.isEmpty(sig_response_array):\n                print "Duo. Authenticate for step 2. sig_response is empty"\n                return False\n\n            duo_sig_response = sig_response_array[0]\n\n            print "Duo. Authenticate for step 2. duo_sig_response: " + duo_sig_response\n\n            authenticated_username = duo_web.verify_response(self.ikey, self.skey, self.akey, duo_sig_response)\n\n            print "Duo. Authenticate for step 2. authenticated_username: " + authenticated_username + ", expected user_name: " + user_name\n\n            if (not StringHelper.equals(user_name, authenticated_username)):\n                return False\n\n            self.processAuditGroup(user)\n\n            return True\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        duo_host = configurationAttributes.get("duo_host").getValue2()\n\n        if (step == 1):\n            print "Duo. Prepare for step 1"\n\n            return True\n        elif (step == 2):\n            print "Duo. Prepare for step 2"\n\n            user = authenticationService.getAuthenticatedUser()\n            if (user == None):\n                print "Duo. Prepare for step 2. Failed to determine user name"\n                return False\n            user_name = user.getUserId()\n\n            duo_sig_request = duo_web.sign_request(self.ikey, self.skey, self.akey, user_name)\n            print "Duo. Prepare for step 2. duo_sig_request: " + duo_sig_request\n            \n            identity.setWorkingParameter("duo_host", duo_host)\n            identity.setWorkingParameter("duo_sig_request", duo_sig_request)\n\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        if step == 2:\n            return Arrays.asList("duo_count_login_steps", "cas2_user_uid")\n\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        identity = CdiUtil.bean(Identity)\n        if (identity.isSetWorkingParameter("duo_count_login_steps")):\n            return int(identity.getWorkingParameter("duo_count_login_steps"))\n\n        return 2\n\n    def getPageForStep(self, configurationAttributes, step):\n        if (step == 2):\n            return "/auth/duo/duologin.xhtml"\n        return ""\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def isUserMemberOfGroup(self, user, attribute, group):\n        is_member = False\n        member_of_list = user.getAttributeValues(attribute)\n        if (member_of_list != None):\n            for member_of in member_of_list:\n                if StringHelper.equalsIgnoreCase(group, member_of) or member_of.endswith(group):\n                    is_member = True\n                    break\n\n        return is_member\n\n    def processAuditGroup(self, user):\n        if (self.use_audit_group):\n            is_member = self.isUserMemberOfGroup(user, self.audit_attribute, self.audit_group)\n            if (is_member):\n                print "Duo. Authenticate for processAuditGroup. User \'" + user.getUserId() + "\' member of audit group"\n                print "Duo. Authenticate for processAuditGroup. Sending e-mail about user \'" + user.getUserId() + "\' login to", self.audit_email\n                \n                # Send e-mail to administrator\n                user_id = user.getUserId()\n                mailService = CdiUtil.bean(MailService)\n                subject = "User log in: " + user_id\n                body = "User log in: " + user_id\n                mailService.sendMail(self.audit_email, subject, body)\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=522F-CDC5,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=522F-CDC5,ou=scripts,o=jans entry:{'description': ['Sample Update User script'], 'displayName': ['update_user'], 'inum': ['522F-CDC5'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.user import UpdateUserType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\n\nimport java\n\nclass UpdateUser(UpdateUserType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Update user. Initialization"\n        print "Update user. Initialized successfully"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Update user. Destroy"\n        print "Update user. Destroyed successfully"\n        return True   \n\n    def getApiVersion(self):\n        return 11\n\n    def newUser(self, user, configurationAttributes):\n        print "Update user. newUser method"\n\n        return True\n\n    def addUser(self, user, persisted, configurationAttributes):\n        print "Update user. addUser method"\n\n        return True\n\n    def postAddUser(self, user, configurationAttributes):\n        print "Update user. postAddUser method"\n\n        return True\n\n    # Update user entry before persistent it\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\n    #   persisted is boolean value to specify if operation type: add/modify\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def updateUser(self, user, persisted, configurationAttributes):\n        print "Update user. updateUser method"\n\n        uid = user.getUid()\n        print "Update user. User uid: {}".format(uid)\n       \n        mail = uid + "@example.org"\n        user.setMail(mail)\n\n        return True\n\n    def postUpdateUser(self, user, configurationAttributes):\n        print "Update user. postUpdateUser method"\n\n        return True\n\n    def deleteUser(self, user, persisted, configurationAttributes):\n        print "Update user. deleteUser method"\n\n        return True\n\n    def postDeleteUser(self, user, configurationAttributes):\n        print "Update user. postDeleteUser method"\n\n        return True\n'], 'jansScrTyp': ['update_user'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=6EA0-8F0C,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=6EA0-8F0C,ou=scripts,o=jans entry:{'description': ['Sample User Registration script'], 'displayName': ['user_registration'], 'inum': ['6EA0-8F0C'], 'jansConfProperty': ['{"value1":"enable_user","value2":"false","description":""}'], 'jansLevel': ['90'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n# Author: Yuriy Movchan\r\n#\r\n\r\nfrom io.jans.model.custom.script.type.user import UserRegistrationType\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays, ArrayList\r\n\r\nimport java\r\n\r\nclass UserRegistration(UserRegistrationType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "User registration. Initialization"\r\n\r\n        self.enable_user = StringHelper.toBoolean(configurationAttributes.get("enable_user").getValue2(), False)\r\n\r\n        print "User registration. Initialized successfully"\r\n\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "User registration. Destroy"\r\n        print "User registration. Destroyed successfully"\r\n        return True   \r\n\r\n    # User registration init method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def initRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User registration. Init method"\r\n\r\n        return True\r\n\r\n    # User registration pre method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def preRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User registration. Pre method"\r\n\r\n        userStatus = "active"\r\n        if not self.enable_user:\r\n            userStatus = "inactive"\r\n\r\n        # Disable/Enable registered user\r\n        user.setStatus(userStatus)\r\n\r\n        return True\r\n\r\n    # User registration post method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def postRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User registration. Post method"\r\n\r\n        return True\r\n    \r\n    # User confirm New Registration method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def confirmRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User registration. Confirm registration method"\r\n\r\n        return True\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n'], 'jansScrTyp': ['user_registration'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=6EA0-8F0D,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=6EA0-8F0D,ou=scripts,o=jans entry:{'description': ['Sample Confirm User Registration  script'], 'displayName': ['user_confirm_registration'], 'inum': ['6EA0-8F0D'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n\r\nfrom io.jans.service.cdi.util import CdiUtil\r\nfrom io.jans.model.custom.script.type.user import UserRegistrationType\r\nfrom io.jans.service import MailService\r\nfrom io.jans.oxtrust.service import PersonService\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays, ArrayList\r\nfrom io.jans.config.oxtrust import AppConfiguration\r\nfrom javax.faces.context import ExternalContext\r\nfrom io.jans.oxtrust.service import ConfigurationService\r\n\r\nimport java\r\n\r\nclass UserRegistration(UserRegistrationType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "User Confirm registration. Initialization"\r\n        print "User Confirm registration. Initialized successfully"\r\n\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "User Confirm registration. Destroy"\r\n        print "User Confirm registration. Destroyed successfully"\r\n        return True   \r\n\r\n    # User registration init method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def initRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User Confirm registration. Init method"\r\n        #hostName = requestParameters.get("hostName")[0]\r\n        #print "HostName Initialization : %s" % hostName\r\n        return True\r\n\r\n    # User registration pre method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def preRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User Confirm registration. Pre method"\r\n        userStatus = "inactive"\r\n\r\n        # Disable/Enable registered user\r\n        user.setStatus(userStatus)\r\n        self.guid = StringHelper.getRandomString(16)\r\n        user.setGuid(self.guid)\r\n        return True\r\n\r\n    # User registration post method\r\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\r\n    #   requestParameters is java.util.Map<String, String[]>\r\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\r\n    def postRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User Confirm registration. Post method"\r\n        externalContext = CdiUtil.bean(ExternalContext)\r\n        contextPath = externalContext.getRequest().getContextPath()\r\n        hostName =  externalContext.getRequestServerName()\r\n        print "HostName from context : %s" % hostName\r\n        mailService = CdiUtil.bean(MailService)\r\n        subject = "Registration confirmation"\r\n        activationLink = "https://%s%s/confirm/registration.htm?code=%s" %(hostName, contextPath, self.guid)\r\n        body = "<h2 style=\'margin-left:10%%;color: #337ab7;\'>Welcome</h2><hr style=\'width:80%%;border: 1px solid #337ab7;\'></hr><div style=\'text-align:center;\'><p>Dear <span style=\'color: #337ab7;\'>%s</span>,</p><p>Your Account has been created, welcome to <span style=\'color: #337ab7;\'>%s</span>.</p><p>You are just one step way from activating your account on <span style=\'color: #337ab7;\'>%s</span>.</p><p>Click the button and start using your account.</p></div><a class=\'btn\' href=\'%s\'><button style=\'background: #337ab7; color: white; margin-left: 30%%; border-radius: 5px; border: 0px; padding: 5px;\' type=\'button\'>Activate your account now!</button></a>"  % (user.getUid(), hostName, hostName, activationLink)\r\n        print "User Confirm registration. Post method. Attempting to send e-mail to \'%s\' message \'%s\'" % (user.getMail(), body)\r\n        mailService.sendMail(user.getMail(), None, subject, body, body);\r\n        return True\r\n\r\n    def confirmRegistration(self, user, requestParameters, configurationAttributes):\r\n        print "User Confirm registration. Confirm method"\r\n        code_array = requestParameters.get("code")\r\n        if ArrayHelper.isEmpty(code_array):\r\n            print "User Confirm registration. Confirm method. code is empty"\r\n            return False\r\n\r\n        confirmation_code = code_array[0]\r\n        print "User Confirm registration. Confirm method. code: \'%s\'" % confirmation_code\r\n\r\n        if confirmation_code == None:\r\n            print "User Confirm registration. Confirm method. Confirmation code not exist in request"\r\n            return False\r\n\r\n        personService = CdiUtil.bean(PersonService)\r\n        user = personService.getPersonByAttribute("oxGuid", confirmation_code)\r\n        if user == None:\r\n            print "User Confirm registration. Confirm method. There is no user by confirmation code: \'%s\'" % confirmation_code\r\n            return False\r\n\r\n        if confirmation_code == user.getGuid():\r\n            user.setStatus("active")\r\n            user.setGuid("")\r\n            personService.updatePerson(user)\r\n            print "User Confirm registration. Confirm method. User \'%s\' confirmed his registration" % user.getUid()\r\n            return True\r\n\r\n        print "User Confirm registration. Confirm method. Confirmation code for user \'%s\' is invalid" % user.getUid()\r\n        return False\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n'], 'jansScrTyp': ['user_registration'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=8BAF-80D6,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=8BAF-80D6,ou=scripts,o=jans entry:{'description': ['Fido U2F authentication module'], 'displayName': ['u2f'], 'inum': ['8BAF-80D6'], 'jansConfProperty': ['{"value1":"u2f_application_id","value2":"https://test.dd.jans.io","description":""}', '{"value1":"u2f_server_uri","value2":"https://test.dd.jans.io","description":""}'], 'jansLevel': ['50'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2016, Janssen\r\n#\r\n# Author: Yuriy Movchan\r\n#\r\n\r\nimport java\r\nimport sys\r\nfrom javax.ws.rs.core import Response\r\nfrom javax.ws.rs import WebApplicationException\r\nfrom org.jboss.resteasy.client.exception import ResteasyClientException\r\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\r\nfrom io.jans.as.client.fido.u2f import FidoU2fClientFactory\r\nfrom io.jans.as.model.config import Constants\r\nfrom io.jans.as.server.security import Identity\r\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\r\nfrom io.jans.as.server.service import UserService\r\nfrom io.jans.as.service.fido.u2f import DeviceRegistrationService\r\nfrom io.jans.as.util import ServerUtil\r\nfrom io.jans.service.cdi.util import CdiUtil\r\nfrom io.jans.util import StringHelper\r\n\r\n\r\nclass PersonAuthentication(PersonAuthenticationType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "U2F. Initialization"\r\n\r\n        print "U2F. Initialization. Downloading U2F metadata"\r\n        u2f_server_uri = configurationAttributes.get("u2f_server_uri").getValue2()\r\n        u2f_server_metadata_uri = u2f_server_uri + "/.well-known/fido-u2f-configuration"\r\n\r\n        metaDataConfigurationService = FidoU2fClientFactory.instance().createMetaDataConfigurationService(u2f_server_metadata_uri)\r\n\r\n        max_attempts = 20\r\n        for attempt in range(1, max_attempts + 1):\r\n            try:\r\n                self.metaDataConfiguration = metaDataConfigurationService.getMetadataConfiguration()\r\n                break\r\n            except WebApplicationException, ex:\r\n                # Detect if last try or we still get Service Unavailable HTTP error\r\n                if (attempt == max_attempts) or (ex.getResponse().getStatus() != Response.Status.SERVICE_UNAVAILABLE.getStatusCode()):\r\n                    raise ex\r\n\r\n                java.lang.Thread.sleep(3000)\r\n                print "Attempting to load metadata: %d" % attempt\r\n        \r\n        print "U2F. Initialized successfully"\r\n        return True   \r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "U2F. Destroy"\r\n        print "U2F. Destroyed successfully"\r\n        return True\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n        \r\n    def getAuthenticationMethodClaims(self, requestParameters):\r\n        return None\r\n        \r\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\r\n        return True\r\n\r\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\r\n        return None\r\n\r\n    def authenticate(self, configurationAttributes, requestParameters, step):\r\n        authenticationService = CdiUtil.bean(AuthenticationService)\r\n\r\n        identity = CdiUtil.bean(Identity)\r\n        credentials = identity.getCredentials()\r\n\r\n        user_name = credentials.getUsername()\r\n\r\n        if (step == 1):\r\n            print "U2F. Authenticate for step 1"\r\n\r\n            user_password = credentials.getPassword()\r\n            logged_in = False\r\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\r\n                userService = CdiUtil.bean(UserService)\r\n                logged_in = authenticationService.authenticate(user_name, user_password)\r\n\r\n            if (not logged_in):\r\n                return False\r\n\r\n            return True\r\n        elif (step == 2):\r\n            print "U2F. Authenticate for step 2"\r\n\r\n            token_response = ServerUtil.getFirstValue(requestParameters, "tokenResponse")\r\n            if token_response == None:\r\n                print "U2F. Authenticate for step 2. tokenResponse is empty"\r\n                return False\r\n\r\n            auth_method = ServerUtil.getFirstValue(requestParameters, "authMethod")\r\n            if auth_method == None:\r\n                print "U2F. Authenticate for step 2. authMethod is empty"\r\n                return False\r\n\r\n            authenticationService = CdiUtil.bean(AuthenticationService)\r\n            user = authenticationService.getAuthenticatedUser()\r\n            if (user == None):\r\n                print "U2F. Prepare for step 2. Failed to determine user name"\r\n                return False\r\n\r\n            if (auth_method == \'authenticate\'):\r\n                print "U2F. Prepare for step 2. Call FIDO U2F in order to finish authentication workflow"\r\n                authenticationRequestService = FidoU2fClientFactory.instance().createAuthenticationRequestService(self.metaDataConfiguration)\r\n                authenticationStatus = authenticationRequestService.finishAuthentication(user.getUserId(), token_response)\r\n\r\n                if (authenticationStatus.getStatus() != Constants.RESULT_SUCCESS):\r\n                    print "U2F. Authenticate for step 2. Get invalid authentication status from FIDO U2F server"\r\n                    return False\r\n\r\n                return True\r\n            elif (auth_method == \'enroll\'):\r\n                print "U2F. Prepare for step 2. Call FIDO U2F in order to finish registration workflow"\r\n                registrationRequestService = FidoU2fClientFactory.instance().createRegistrationRequestService(self.metaDataConfiguration)\r\n                registrationStatus = registrationRequestService.finishRegistration(user.getUserId(), token_response)\r\n\r\n                if (registrationStatus.getStatus() != Constants.RESULT_SUCCESS):\r\n                    print "U2F. Authenticate for step 2. Get invalid registration status from FIDO U2F server"\r\n                    return False\r\n\r\n                return True\r\n            else:\r\n                print "U2F. Prepare for step 2. Authenticatiod method is invalid"\r\n                return False\r\n\r\n            return False\r\n        else:\r\n            return False\r\n\r\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\r\n        identity = CdiUtil.bean(Identity)\r\n\r\n        if (step == 1):\r\n            return True\r\n        elif (step == 2):\r\n            print "U2F. Prepare for step 2"\r\n\r\n            session = CdiUtil.bean(SessionIdService).getSessionId()\r\n            if session == None:\r\n                print "U2F. Prepare for step 2. Failed to determine session_id"\r\n                return False\r\n\r\n            authenticationService = CdiUtil.bean(AuthenticationService)\r\n            user = authenticationService.getAuthenticatedUser()\r\n            if (user == None):\r\n                print "U2F. Prepare for step 2. Failed to determine user name"\r\n                return False\r\n\r\n            u2f_application_id = configurationAttributes.get("u2f_application_id").getValue2()\r\n\r\n            # Check if user have registered devices\r\n            deviceRegistrationService = CdiUtil.bean(DeviceRegistrationService)\r\n\r\n            userInum = user.getAttribute("inum")\r\n\r\n            registrationRequest = None\r\n            authenticationRequest = None\r\n\r\n            deviceRegistrations = deviceRegistrationService.findUserDeviceRegistrations(userInum, u2f_application_id)\r\n            if (deviceRegistrations.size() > 0):\r\n                print "U2F. Prepare for step 2. Call FIDO U2F in order to start authentication workflow"\r\n\r\n                try:\r\n                    authenticationRequestService = FidoU2fClientFactory.instance().createAuthenticationRequestService(self.metaDataConfiguration)\r\n                    authenticationRequest = authenticationRequestService.startAuthentication(user.getUserId(), None, u2f_application_id, session.getId())\r\n                except ClientResponseFailure, ex:\r\n                    if (ex.getResponse().getResponseStatus() != Response.Status.NOT_FOUND):\r\n                        print "U2F. Prepare for step 2. Failed to start authentication workflow. Exception:", sys.exc_info()[1]\r\n                        return False\r\n            else:\r\n                print "U2F. Prepare for step 2. Call FIDO U2F in order to start registration workflow"\r\n                registrationRequestService = FidoU2fClientFactory.instance().createRegistrationRequestService(self.metaDataConfiguration)\r\n                registrationRequest = registrationRequestService.startRegistration(user.getUserId(), u2f_application_id, session.getId())\r\n\r\n            identity.setWorkingParameter("fido_u2f_authentication_request", ServerUtil.asJson(authenticationRequest))\r\n            identity.setWorkingParameter("fido_u2f_registration_request", ServerUtil.asJson(registrationRequest))\r\n\r\n            return True\r\n        elif (step == 3):\r\n            print "U2F. Prepare for step 3"\r\n\r\n            return True\r\n        else:\r\n            return False\r\n\r\n    def getExtraParametersForStep(self, configurationAttributes, step):\r\n        return None\r\n\r\n    def getCountAuthenticationSteps(self, configurationAttributes):\r\n        return 2\r\n\r\n    def getPageForStep(self, configurationAttributes, step):\r\n        if (step == 2):\r\n            return "/auth/u2f/login.xhtml"\r\n\r\n        return ""\r\n\r\n    def getNextStep(self, configurationAttributes, requestParameters, step):\r\n        return -1\r\n\r\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\r\n        print "Get external logout URL call"\r\n        return None\r\n\r\n    def logout(self, configurationAttributes, requestParameters):\r\n        return True\r\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=8BAF-80D7,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=8BAF-80D7,ou=scripts,o=jans entry:{'description': ['Fido2 authentication module'], 'displayName': ['fido2'], 'inum': ['8BAF-80D7'], 'jansConfProperty': ['{"value1":"fido2_server_uri","value2":"https://test.dd.jans.io","hide":false,"description":""}'], 'jansLevel': ['70'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom javax.ws.rs.core import Response\nfrom org.jboss.resteasy.client import ClientResponseFailure\nfrom org.jboss.resteasy.client.exception import ResteasyClientException\nfrom javax.ws.rs.core import Response\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.fido2.client import Fido2ClientFactory\nfrom io.jans.as.server.security import Identity\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.util import StringHelper\n\nfrom java.util.concurrent.locks import ReentrantLock\n\nimport java\nimport sys\ntry:\n    import json\nexcept ImportError:\n    import simplejson as json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Fido2. Initialization"\n\n        if not configurationAttributes.containsKey("fido2_server_uri"):\n            print "fido2_server_uri. Initialization. Property fido2_server_uri is not specified"\n            return False\n\n        self.fido2_server_uri = configurationAttributes.get("fido2_server_uri").getValue2()\n\n        self.fido2_domain = None\n        if configurationAttributes.containsKey("fido2_domain"):\n            self.fido2_domain = configurationAttributes.get("fido2_domain").getValue2()\n\n        self.metaDataLoaderLock = ReentrantLock()\n        self.metaDataConfiguration = None\n        \n        print "Fido2. Initialized successfully"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Fido2. Destroy"\n        print "Fido2. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        user_name = credentials.getUsername()\n\n        if step == 1:\n            print "Fido2. Authenticate for step 1"\n\n            user_password = credentials.getPassword()\n            logged_in = False\n            if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n                userService = CdiUtil.bean(UserService)\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if not logged_in:\n                return False\n\n            return True\n        elif step == 2:\n            print "Fido2. Authenticate for step 2"\n\n            token_response = ServerUtil.getFirstValue(requestParameters, "tokenResponse")\n            if token_response == None:\n                print "Fido2. Authenticate for step 2. tokenResponse is empty"\n                return False\n\n            auth_method = ServerUtil.getFirstValue(requestParameters, "authMethod")\n            if auth_method == None:\n                print "Fido2. Authenticate for step 2. authMethod is empty"\n                return False\n\n            authenticationService = CdiUtil.bean(AuthenticationService)\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "Fido2. Prepare for step 2. Failed to determine user name"\n                return False\n\n            if auth_method == \'authenticate\':\n                print "Fido2. Prepare for step 2. Call Fido2 in order to finish authentication flow"\n                assertionService = Fido2ClientFactory.instance().createAssertionService(self.metaDataConfiguration)\n                assertionStatus = assertionService.verify(token_response)\n                authenticationStatusEntity = assertionStatus.readEntity(java.lang.String)\n\n                if assertionStatus.getStatus() != Response.Status.OK.getStatusCode():\n                    print "Fido2. Authenticate for step 2. Get invalid authentication status from Fido2 server"\n                    return False\n\n                return True\n            elif auth_method == \'enroll\':\n                print "Fido2. Prepare for step 2. Call Fido2 in order to finish registration flow"\n                attestationService = Fido2ClientFactory.instance().createAttestationService(self.metaDataConfiguration)\n                attestationStatus = attestationService.verify(token_response)\n\n                if attestationStatus.getStatus() != Response.Status.OK.getStatusCode():\n                    print "Fido2. Authenticate for step 2. Get invalid registration status from Fido2 server"\n                    return False\n\n                return True\n            else:\n                print "Fido2. Prepare for step 2. Authentication method is invalid"\n                return False\n\n            return False\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n\n        if step == 1:\n            return True\n        elif step == 2:\n            print "Fido2. Prepare for step 2"\n\n            session = CdiUtil.bean(SessionIdService).getSessionId()\n            if session == None:\n                print "Fido2. Prepare for step 2. Failed to determine session_id"\n                return False\n\n            authenticationService = CdiUtil.bean(AuthenticationService)\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "Fido2. Prepare for step 2. Failed to determine user name"\n                return False\n\n            userName = user.getUserId()\n\n            metaDataConfiguration = self.getMetaDataConfiguration()\n            \n            assertionResponse = None\n            attestationResponse = None\n\n            # Check if user have registered devices\n            userService = CdiUtil.bean(UserService)\n            countFido2Devices = userService.countFidoAndFido2Devices(userName, self.fido2_domain)\n            if countFido2Devices > 0:\n                print "Fido2. Prepare for step 2. Call Fido2 endpoint in order to start assertion flow"\n\n                try:\n                    assertionService = Fido2ClientFactory.instance().createAssertionService(metaDataConfiguration)\n                    assertionRequest = json.dumps({\'username\': userName}, separators=(\',\', \':\'))\n                    assertionResponse = assertionService.authenticate(assertionRequest).readEntity(java.lang.String)\n                except ClientResponseFailure, ex:\n                    print "Fido2. Prepare for step 2. Failed to start assertion flow. Exception:", sys.exc_info()[1]\n                    return False\n            else:\n                print "Fido2. Prepare for step 2. Call Fido2 endpoint in order to start attestation flow"\n\n                try:\n                    attestationService = Fido2ClientFactory.instance().createAttestationService(metaDataConfiguration)\n                    attestationRequest = json.dumps({\'username\': userName, \'displayName\': userName, \'attestation\' : \'direct\'}, separators=(\',\', \':\'))\n                    attestationResponse = attestationService.register(attestationRequest).readEntity(java.lang.String)\n                except ClientResponseFailure, ex:\n                    print "Fido2. Prepare for step 2. Failed to start attestation flow. Exception:", sys.exc_info()[1]\n                    return False\n\n            identity.setWorkingParameter("fido2_assertion_request", ServerUtil.asJson(assertionResponse))\n            identity.setWorkingParameter("fido2_attestation_request", ServerUtil.asJson(attestationResponse))\n            print "Fido2. Prepare for step 2. Successfully start flow with next requests.\\nfido2_assertion_request: \'%s\'\\nfido2_attestation_request: \'%s\'" % ( assertionResponse, attestationResponse )\n\n            return True\n        elif step == 3:\n            print "Fido2. Prepare for step 3"\n\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 2\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getPageForStep(self, configurationAttributes, step):\n        if step == 2:\n            return "/auth/fido2/login.xhtml"\n\n        return ""\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None    \n        \n        \n    def getMetaDataConfiguration(self):\n        if self.metaDataConfiguration != None:\n            return self.metaDataConfiguration\n        \n        self.metaDataLoaderLock.lock()\n        # Make sure that another thread not loaded configuration already          \n        if self.metaDataConfiguration != None:\n            return self.metaDataConfiguration\n\n        try:\n            print "Fido2. Initialization. Downloading Fido2 metadata"\n            self.fido2_server_metadata_uri = self.fido2_server_uri + "/.well-known/fido2-configuration"\n            #self.fido2_server_metadata_uri = self.fido2_server_uri + "/fido2/restv1/fido2/configuration"\n\n            metaDataConfigurationService = Fido2ClientFactory.instance().createMetaDataConfigurationService(self.fido2_server_metadata_uri)\n    \n            max_attempts = 10\n            for attempt in range(1, max_attempts + 1):\n                try:\n                    self.metaDataConfiguration = metaDataConfigurationService.getMetadataConfiguration().readEntity(java.lang.String)\n                    return self.metaDataConfiguration\n                except ClientResponseFailure, ex:\n                    # Detect if last try or we still get Service Unavailable HTTP error\n                    if (attempt == max_attempts) or (ex.getResponse().getResponseStatus() != Response.Status.SERVICE_UNAVAILABLE):\n                        raise ex\n    \n                    java.lang.Thread.sleep(3000)\n                    print "Attempting to load metadata: %d" % attempt\n                except ResteasyClientException, ex:\n                    # Detect if last try or we still get Service Unavailable HTTP error\n                    if attempt == max_attempts:\n                        raise ex\n    \n                    java.lang.Thread.sleep(3000)\n                    print "Attempting to load metadata: %d" % attempt\n        finally:\n            self.metaDataLoaderLock.unlock()\n            \n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=92F0-BF9E,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=92F0-BF9E,ou=scripts,o=jans entry:{'description': ['Super Gluu authentication module'], 'displayName': ['super_gluu'], 'inum': ['92F0-BF9E'], 'jansConfProperty': ['{"value1":"qr_options","value2":"{ size: 500, mSize: 0.05 }","description":""}', '{"value1":"label","value2":"Super Gluu","description":""}', '{"value1":"registration_uri","value2":"https://test.dd.jans.io/identity/register","description":""}', '{"value1":"authentication_mode","value2":"two_step","description":""}', '{"value1":"notification_service_mode","value2":"gluu","description":""}', '{"value1":"credentials_file","value2":"/etc/certs/super_gluu_creds.json","description":""}', '{"value1":"supergluu_android_download_url","value2":"https://play.google.com/store/apps/details?id=gluu.org.super.gluu&hl=en_US","description":""}', '{"value1":"supergluu_ios_download_url","value2":"https://itunes.apple.com/us/app/super-gluu/id1093479646","description":""}'], 'jansLevel': ['60'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom com.google.android.gcm.server import Sender, Message\nfrom com.notnoop.apns import APNS\nfrom java.util import Arrays\nfrom org.apache.http.params import CoreConnectionPNames\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.model.config import ConfigurationFactory\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.service.fido.u2f import DeviceRegistrationService\nfrom io.jans.as.service.net import HttpService\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.util import StringHelper\nfrom io.jans.as.service.common import EncryptionService, UserService\nfrom io.jans.service import MailService\nfrom io.jans.as.service.push.sns import PushPlatform, PushSnsService \nfrom io.jans.oxnotify.client import NotifyClientFactory \nfrom java.util import Arrays, HashMap, IdentityHashMap, Date\nfrom java.time import ZonedDateTime\nfrom java.time.format import DateTimeFormatter\n\ntry:\n    from io.jans.oxd.license.client.js import Product\n    from io.jans.oxd.license.validator import LicenseValidator\n    has_license_api = True\nexcept ImportError:\n    print "Super-Janssen. Load. Failed to load licensing API"\n    has_license_api = False\n\nimport datetime\nimport urllib\n\nimport sys\nimport json\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Super-Janssen. Initialization"\n\n        if not configurationAttributes.containsKey("authentication_mode"):\n            print "Super-Janssen. Initialization. Property authentication_mode is mandatory"\n            return False\n\n        self.applicationId = None\n        if configurationAttributes.containsKey("application_id"):\n            self.applicationId = configurationAttributes.get("application_id").getValue2()\n\n        self.registrationUri = None\n        if configurationAttributes.containsKey("registration_uri"):\n            self.registrationUri = configurationAttributes.get("registration_uri").getValue2()\n\n        authentication_mode = configurationAttributes.get("authentication_mode").getValue2()\n        if StringHelper.isEmpty(authentication_mode):\n            print "Super-Janssen. Initialization. Failed to determine authentication_mode. authentication_mode configuration parameter is empty"\n            return False\n        \n        self.oneStep = StringHelper.equalsIgnoreCase(authentication_mode, "one_step")\n        self.twoStep = StringHelper.equalsIgnoreCase(authentication_mode, "two_step")\n\n        if not (self.oneStep or self.twoStep):\n            print "Super-Janssen. Initialization. Valid authentication_mode values are one_step and two_step"\n            return False\n        \n        self.enabledPushNotifications = self.initPushNotificationService(configurationAttributes)\n\n        self.androidUrl = None\n        if configurationAttributes.containsKey("supe.jans.android_download_url"):\n            self.androidUrl = configurationAttributes.get("supe.jans.android_download_url").getValue2()\n\n        self.IOSUrl = None\n        if configurationAttributes.containsKey("supe.jans.ios_download_url"):\n            self.IOSUrl = configurationAttributes.get("supe.jans.ios_download_url").getValue2()\n\n        self.customLabel = None\n        if configurationAttributes.containsKey("label"):\n            self.customLabel = configurationAttributes.get("label").getValue2()\n\n        self.customQrOptions = {}\n        if configurationAttributes.containsKey("qr_options"):\n            self.customQrOptions = configurationAttributes.get("qr_options").getValue2()\n\n        self.use_super.jans.group = False\n        if configurationAttributes.containsKey("super.jans.group"):\n            self.super.jans.group = configurationAttributes.get("super.jans.group").getValue2()\n            self.use_super.jans.group = True\n            print "Super-Janssen. Initialization. Using super.jans.only if user belong to group: %s" % self.super.jans.group\n\n        self.use_audit_group = False\n        if configurationAttributes.containsKey("audit_group"):\n            self.audit_group = configurationAttributes.get("audit_group").getValue2()\n\n            if (not configurationAttributes.containsKey("audit_group_email")):\n                print "Super-Janssen. Initialization. Property audit_group_email is not specified"\n                return False\n\n            self.audit_email = configurationAttributes.get("audit_group_email").getValue2()\n            self.use_audit_group = True\n\n            print "Super-Janssen. Initialization. Using audit group: %s" % self.audit_group\n            \n        if self.use_super.jans.group or self.use_audit_group:\n            if not configurationAttributes.containsKey("audit_attribute"):\n                print "Super-Janssen. Initialization. Property audit_attribute is not specified"\n                return False\n            else:\n                self.audit_attribute = configurationAttributes.get("audit_attribute").getValue2()\n\n        self.valid_license = False\n        # Removing or altering this block validation is against the terms of the license. \n        if has_license_api and configurationAttributes.containsKey("license_file"):\n            license_file = configurationAttributes.get("license_file").getValue2()\n\n            # Load license from file\n            f = open(license_file, \'r\')\n            try:\n                license = json.loads(f.read())\n            except:\n                print "Super-Janssen. Initialization. Failed to load license from file: %s" % license_file\n                return False\n            finally:\n                f.close()\n            \n            # Validate license\n            try:\n                self.license_content = LicenseValidator.validate(license["public_key"], license["public_password"], license["license_password"], license["license"],\n                                          Product.SUPER_GLUU, Date())\n                self.valid_license = self.license_content.isValid()\n            except:\n                print "Super-Janssen. Initialization. Failed to validate license. Exception: ", sys.exc_info()[1]\n                return False\n\n            print "Super-Janssen. Initialization. License status: \'%s\'. License metadata: \'%s\'" % (self.valid_license, self.license_content.getMetadata())\n\n        print "Super-Janssen. Initialized successfully. oneStep: \'%s\', twoStep: \'%s\', pushNotifications: \'%s\', customLabel: \'%s\'" % (self.oneStep, self.twoStep, self.enabledPushNotifications, self.customLabel)\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Super-Janssen. Destroy"\n\n        self.pushAndroidService = None\n        self.pushAppleService = None\n\n        print "Super-Janssen. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        identity = CdiUtil.bean(Identity)\n        credentials = identity.getCredentials()\n\n        session_attributes = identity.getSessionId().getSessionAttributes()\n\n        client_redirect_uri = self.getApplicationUri(session_attributes)\n        if client_redirect_uri == None:\n            print "Super-Janssen. Authenticate. redirect_uri is not set"\n            return False\n\n        self.setRequestScopedParameters(identity, step)\n\n        # Validate form result code and initialize QR code regeneration if needed (retry_current_step = True)\n        identity.setWorkingParameter("retry_current_step", False)\n        form_auth_result = ServerUtil.getFirstValue(requestParameters, "auth_result")\n        if StringHelper.isNotEmpty(form_auth_result):\n            print "Super-Janssen. Authenticate for step %s. Get auth_result: \'%s\'" % (step, form_auth_result)\n            if form_auth_result in [\'error\']:\n                return False\n\n            if form_auth_result in [\'timeout\']:\n                if ((step == 1) and self.oneStep) or ((step == 2) and self.twoStep):        \n                    print "Super-Janssen. Authenticate for step %s. Reinitializing current step" % step\n                    identity.setWorkingParameter("retry_current_step", True)\n                    return False\n\n        userService = CdiUtil.bean(UserService)\n        deviceRegistrationService = CdiUtil.bean(DeviceRegistrationService)\n        if step == 1:\n            print "Super-Janssen. Authenticate for step 1"\n\n            user_name = credentials.getUsername()\n            if self.oneStep:\n                session_device_status = self.getSessionDeviceStatus(session_attributes, user_name)\n                if session_device_status == None:\n                    return False\n\n                u2f_device_id = session_device_status[\'device_id\']\n\n                validation_result = self.validateSessionDeviceStatus(client_redirect_uri, session_device_status)\n                if validation_result:\n                    print "Super-Janssen. Authenticate for step 1. User successfully authenticated with u2f_device \'%s\'" % u2f_device_id\n                else:\n                    return False\n                    \n                if not session_device_status[\'one_step\']:\n                    print "Super-Janssen. Authenticate for step 1. u2f_device \'%s\' is not one step device" % u2f_device_id\n                    return False\n                    \n                # There are two steps only in enrollment mode\n                if session_device_status[\'enroll\']:\n                    return validation_result\n\n                identity.setWorkingParameter("super.jans.count_login_steps", 1)\n\n                user_inum = session_device_status[\'user_inum\']\n\n                u2f_device = deviceRegistrationService.findUserDeviceRegistration(user_inum, u2f_device_id, "oxId")\n                if u2f_device == None:\n                    print "Super-Janssen. Authenticate for step 1. Failed to load u2f_device \'%s\'" % u2f_device_id\n                    return False\n\n                logged_in = authenticationService.authenticate(user_name)\n                if not logged_in:\n                    print "Super-Janssen. Authenticate for step 1. Failed to authenticate user \'%s\'" % user_name\n                    return False\n\n                print "Super-Janssen. Authenticate for step 1. User \'%s\' successfully authenticated with u2f_device \'%s\'" % (user_name, u2f_device_id)\n                \n                return True\n            elif self.twoStep:\n                authenticated_user = self.processBasicAuthentication(credentials)\n                if authenticated_user == None:\n                    return False\n\n                if (self.use_super.jans.group):\n                    print "Super-Janssen. Authenticate for step 1. Checking if user belong to super.jans.group"\n                    is_member_super.jans.group = self.isUserMemberOfGroup(authenticated_user, self.audit_attribute, self.super.jans.group)\n                    if (is_member_super.jans.group):\n                        print "Super-Janssen. Authenticate for step 1. User \'%s\' member of super.jans.group" % authenticated_user.getUserId()\n                        super.jans.count_login_steps = 2\n                    else:\n                        if self.use_audit_group:\n                            self.processAuditGroup(authenticated_user, self.audit_attribute, self.audit_group)\n                        super.jans.count_login_steps = 1\n    \n                    identity.setWorkingParameter("super.jans.count_login_steps", super.jans.count_login_steps)\n                    \n                    if super.jans.count_login_steps == 1:\n                        return True\n    \n                auth_method = \'authenticate\'\n                enrollment_mode = ServerUtil.getFirstValue(requestParameters, "loginForm:registerButton")\n                if StringHelper.isNotEmpty(enrollment_mode):\n                    auth_method = \'enroll\'\n                \n                if auth_method == \'authenticate\':\n                    user_inum = userService.getUserInum(authenticated_user)\n                    u2f_devices_list = deviceRegistrationService.findUserDeviceRegistrations(user_inum, client_redirect_uri, "oxId")\n                    if u2f_devices_list.size() == 0:\n                        auth_method = \'enroll\'\n                        print "Super-Janssen. Authenticate for step 1. There is no U2F \'%s\' user devices associated with application \'%s\'. Changing auth_method to \'%s\'" % (user_name, client_redirect_uri, auth_method)\n    \n                print "Super-Janssen. Authenticate for step 1. auth_method: \'%s\'" % auth_method\n                \n                identity.setWorkingParameter("super.jans.auth_method", auth_method)\n\n                return True\n\n            return False\n        elif step == 2:\n            print "Super-Janssen. Authenticate for step 2"\n\n            user = authenticationService.getAuthenticatedUser()\n            if (user == None):\n                print "Super-Janssen. Authenticate for step 2. Failed to determine user name"\n                return False\n            user_name = user.getUserId()\n\n            session_attributes = identity.getSessionId().getSessionAttributes()\n\n            session_device_status = self.getSessionDeviceStatus(session_attributes, user_name)\n            if session_device_status == None:\n                return False\n\n            u2f_device_id = session_device_status[\'device_id\']\n\n            # There are two steps only in enrollment mode\n            if self.oneStep and session_device_status[\'enroll\']:\n                authenticated_user = self.processBasicAuthentication(credentials)\n                if authenticated_user == None:\n                    return False\n\n                user_inum = userService.getUserInum(authenticated_user)\n                \n                attach_result = deviceRegistrationService.attachUserDeviceRegistration(user_inum, u2f_device_id)\n\n                print "Super-Janssen. Authenticate for step 2. Result after attaching u2f_device \'%s\' to user \'%s\': \'%s\'" % (u2f_device_id, user_name, attach_result) \n\n                return attach_result\n            elif self.twoStep:\n                if user_name == None:\n                    print "Super-Janssen. Authenticate for step 2. Failed to determine user name"\n                    return False\n\n                validation_result = self.validateSessionDeviceStatus(client_redirect_uri, session_device_status, user_name)\n                if validation_result:\n                    print "Super-Janssen. Authenticate for step 2. User \'%s\' successfully authenticated with u2f_device \'%s\'" % (user_name, u2f_device_id)\n                else:\n                    return False\n                \n                super.jans.request = json.loads(session_device_status[\'super.jans.request\'])\n                auth_method = super.jans.request[\'method\']\n                if auth_method in [\'enroll\', \'authenticate\']:\n                    if validation_result and self.use_audit_group:\n                        user = authenticationService.getAuthenticatedUser()\n                        self.processAuditGroup(user, self.audit_attribute, self.audit_group)\n\n                    return validation_result\n\n                print "Super-Janssen. Authenticate for step 2. U2F auth_method is invalid"\n\n            return False\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        identity = CdiUtil.bean(Identity)\n        session_attributes = identity.getSessionId().getSessionAttributes()\n\n        client_redirect_uri = self.getApplicationUri(session_attributes)\n        if client_redirect_uri == None:\n            print "Super-Janssen. Prepare for step. redirect_uri is not set"\n            return False\n\n        self.setRequestScopedParameters(identity, step)\n\n        if step == 1:\n            print "Super-Janssen. Prepare for step 1"\n            if self.oneStep:\n                session = CdiUtil.bean(SessionIdService).getSessionId()\n                if session == None:\n                    print "Super-Janssen. Prepare for step 2. Failed to determine session_id"\n                    return False\n\n                issuer = CdiUtil.bean(ConfigurationFactory).getConfiguration().getIssuer()\n                super.jans.request_dictionary = {\'app\': client_redirect_uri,\n                                   \'issuer\': issuer,\n                                   \'state\': session.getId(),\n                                   \'licensed\': self.valid_license,\n                                   \'created\': DateTimeFormatter.ISO_OFFSET_DATE_TIME.format(ZonedDateTime.now().withNano(0))}\n\n                self.addGeolocationData(session_attributes, super.jans.request_dictionary)\n\n                super.jans.request = json.dumps(super.jans.request_dictionary, separators=(\',\',\':\'))\n                print "Super-Janssen. Prepare for step 1. Prepared super.jans.request:", super.jans.request\n    \n                identity.setWorkingParameter("super.jans.request", super.jans.request)\n            elif self.twoStep:\n                identity.setWorkingParameter("display_register_action", True)\n\n            return True\n        elif step == 2:\n            print "Super-Janssen. Prepare for step 2"\n            if self.oneStep:\n                return True\n\n            authenticationService = CdiUtil.bean(AuthenticationService)\n            user = authenticationService.getAuthenticatedUser()\n            if user == None:\n                print "Super-Janssen. Prepare for step 2. Failed to determine user name"\n                return False\n\n            if session_attributes.containsKey("super.jans.request"):\n               super.jans.request = session_attributes.get("super.jans.request")\n               if not StringHelper.equalsIgnoreCase(super.jans.request, "timeout"):\n                   print "Super-Janssen. Prepare for step 2. Request was generated already"\n                   return True\n            \n            session = CdiUtil.bean(SessionIdService).getSessionId()\n            if session == None:\n                print "Super-Janssen. Prepare for step 2. Failed to determine session_id"\n                return False\n\n            auth_method = session_attributes.get("super.jans.auth_method")\n            if StringHelper.isEmpty(auth_method):\n                print "Super-Janssen. Prepare for step 2. Failed to determine auth_method"\n                return False\n\n            print "Super-Janssen. Prepare for step 2. auth_method: \'%s\'" % auth_method\n            \n            issuer = CdiUtil.bean(ConfigurationFactory).getAppConfiguration().getIssuer()\n            super.jans.request_dictionary = {\'username\': user.getUserId(),\n                               \'app\': client_redirect_uri,\n                               \'issuer\': issuer,\n                               \'method\': auth_method,\n                               \'state\': session.getId(),\n                               \'licensed\': self.valid_license,\n                               \'created\': DateTimeFormatter.ISO_OFFSET_DATE_TIME.format(ZonedDateTime.now().withNano(0))}\n\n            self.addGeolocationData(session_attributes, super.jans.request_dictionary)\n\n            super.jans.request = json.dumps(super.jans.request_dictionary, separators=(\',\',\':\'))\n            print "Super-Janssen. Prepare for step 2. Prepared super.jans.request:", super.jans.request\n\n            identity.setWorkingParameter("super.jans.request", super.jans.request)\n            identity.setWorkingParameter("super.jans.auth_method", auth_method)\n\n            if auth_method in [\'authenticate\']:\n                self.sendPushNotification(client_redirect_uri, user, super.jans.request)\n\n            return True\n        else:\n            return False\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        # If user not pass current step change step to previous\n        identity = CdiUtil.bean(Identity)\n        retry_current_step = identity.getWorkingParameter("retry_current_step")\n        if retry_current_step:\n            print "Super-Janssen. Get next step. Retrying current step"\n\n            # Remove old QR code\n            identity.setWorkingParameter("super.jans.request", "timeout")\n\n            resultStep = step\n            return resultStep\n\n        return -1\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        if step == 1:\n            if self.oneStep:        \n                return Arrays.asList("super.jans.request")\n            elif self.twoStep:\n                return Arrays.asList("display_register_action")\n        elif step == 2:\n            return Arrays.asList("super.jans.auth_method", "super.jans.request")\n        \n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        identity = CdiUtil.bean(Identity)\n        if identity.isSetWorkingParameter("super.jans.count_login_steps"):\n            return identity.getWorkingParameter("super.jans.count_login_steps")\n        else:\n            return 2\n\n    def getPageForStep(self, configurationAttributes, step):\n        if step == 1:\n            if self.oneStep:        \n                return "/auth/super.jans.login.xhtml"\n        elif step == 2:\n            if self.oneStep:\n                return "/login.xhtml"\n            else:\n                identity = CdiUtil.bean(Identity)\n                authmethod = identity.getWorkingParameter("super.jans.auth_method")\n                print "Super-Janssen. authmethod \'%s\'" % authmethod\n                if authmethod == "enroll":\n                    return "/auth/super.jans.login.xhtml"\n                else:\n                    return "/auth/super.jans.login.xhtml"\n\n        return ""\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def processBasicAuthentication(self, credentials):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        user_name = credentials.getUsername()\n        user_password = credentials.getPassword()\n\n        logged_in = False\n        if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n            logged_in = authenticationService.authenticate(user_name, user_password)\n\n        if not logged_in:\n            return None\n\n        find_user_by_uid = authenticationService.getAuthenticatedUser()\n        if find_user_by_uid == None:\n            print "Super-Janssen. Process basic authentication. Failed to find user \'%s\'" % user_name\n            return None\n        \n        return find_user_by_uid\n\n    def validateSessionDeviceStatus(self, client_redirect_uri, session_device_status, user_name = None):\n        userService = CdiUtil.bean(UserService)\n        deviceRegistrationService = CdiUtil.bean(DeviceRegistrationService)\n\n        u2f_device_id = session_device_status[\'device_id\']\n\n        u2f_device = None\n        if session_device_status[\'enroll\'] and session_device_status[\'one_step\']:\n            u2f_device = deviceRegistrationService.findOneStepUserDeviceRegistration(u2f_device_id)\n            if u2f_device == None:\n                print "Super-Janssen. Validate session device status. There is no one step u2f_device \'%s\'" % u2f_device_id\n                return False\n        else:\n            # Validate if user has specified device_id enrollment\n            user_inum = userService.getUserInum(user_name)\n\n            if session_device_status[\'one_step\']:\n                user_inum = session_device_status[\'user_inum\']\n    \n            u2f_device = deviceRegistrationService.findUserDeviceRegistration(user_inum, u2f_device_id)\n            if u2f_device == None:\n                print "Super-Janssen. Validate session device status. There is no u2f_device \'%s\' associated with user \'%s\'" % (u2f_device_id, user_inum)\n                return False\n\n        if not StringHelper.equalsIgnoreCase(client_redirect_uri, u2f_device.application):\n            print "Super-Janssen. Validate session device status. u2f_device \'%s\' associated with other application \'%s\'" % (u2f_device_id, u2f_device.application)\n            return False\n        \n        return True\n\n    def getSessionDeviceStatus(self, session_attributes, user_name):\n        print "Super-Janssen. Get session device status"\n\n        if not session_attributes.containsKey("super.jans.request"):\n            print "Super-Janssen. Get session device status. There is no Super-Janssen request in session attributes"\n            return None\n\n        # Check session state extended\n        if not session_attributes.containsKey("session_custom_state"):\n            print "Super-Janssen. Get session device status. There is no session_custom_state in session attributes"\n            return None\n\n        session_custom_state = session_attributes.get("session_custom_state")\n        if not StringHelper.equalsIgnoreCase("approved", session_custom_state):\n            print "Super-Janssen. Get session device status. User \'%s\' not approve or not pass U2F authentication. session_custom_state: \'%s\'" % (user_name, session_custom_state)\n            return None\n\n        # Try to find device_id in session attribute\n        if not session_attributes.containsKey("oxpush2_u2f_device_id"):\n            print "Super-Janssen. Get session device status. There is no u2f_device associated with this request"\n            return None\n\n        # Try to find user_inum in session attribute\n        if not session_attributes.containsKey("oxpush2_u2f_device_user_inum"):\n            print "Super-Janssen. Get session device status. There is no user_inum associated with this request"\n            return None\n        \n        enroll = False\n        if session_attributes.containsKey("oxpush2_u2f_device_enroll"):\n            enroll = StringHelper.equalsIgnoreCase("true", session_attributes.get("oxpush2_u2f_device_enroll"))\n\n        one_step = False\n        if session_attributes.containsKey("oxpush2_u2f_device_one_step"):\n            one_step = StringHelper.equalsIgnoreCase("true", session_attributes.get("oxpush2_u2f_device_one_step"))\n                        \n        super.jans.request = session_attributes.get("super.jans.request")\n        u2f_device_id = session_attributes.get("oxpush2_u2f_device_id")\n        user_inum = session_attributes.get("oxpush2_u2f_device_user_inum")\n\n        session_device_status = {"super.jans.request": super.jans.request, "device_id": u2f_device_id, "user_inum" : user_inum, "enroll" : enroll, "one_step" : one_step}\n        print "Super-Janssen. Get session device status. session_device_status: \'%s\'" % (session_device_status)\n        \n        return session_device_status\n\n    def initPushNotificationService(self, configurationAttributes):\n        print "Super-Janssen. Initialize Native/SNS/Janssen notification services"\n\n        self.pushSnsMode = False\n        self.pushJanssenMode = False\n        if configurationAttributes.containsKey("notification_service_mode"):\n            notificationServiceMode = configurationAttributes.get("notification_service_mode").getValue2()\n            if StringHelper.equalsIgnoreCase(notificationServiceMode, "sns"):\n                return self.initSnsPushNotificationService(configurationAttributes)\n            elif StringHelper.equalsIgnoreCase(notificationServiceMode, .jans.):\n                return self.initJanssenPushNotificationService(configurationAttributes)\n\n        return self.initNativePushNotificationService(configurationAttributes)\n\n    def initNativePushNotificationService(self, configurationAttributes):\n        print "Super-Janssen. Initialize native notification services"\n        \n        creds = self.loadPushNotificationCreds(configurationAttributes)\n        if creds == None:\n            return False\n        \n        try:\n            android_creds = creds["android"]["gcm"]\n            ios_creds = creds["ios"]["apns"]\n        except:\n            print "Super-Janssen. Initialize native notification services. Invalid credentials file format"\n            return False\n        \n        self.pushAndroidService = None\n        self.pushAppleService = None\n        if android_creds["enabled"]:\n            self.pushAndroidService = Sender(android_creds["api_key"]) \n            print "Super-Janssen. Initialize native notification services. Created Android notification service"\n            \n        if ios_creds["enabled"]:\n            p12_file_path = ios_creds["p12_file_path"]\n            p12_password = ios_creds["p12_password"]\n\n            try:\n                encryptionService = CdiUtil.bean(EncryptionService)\n                p12_password = encryptionService.decrypt(p12_password)\n            except:\n                # Ignore exception. Password is not encrypted\n                print "Super-Janssen. Initialize native notification services. Assuming that \'p12_password\' password in not encrypted"\n\n            apnsServiceBuilder =  APNS.newService().withCert(p12_file_path, p12_password)\n            if ios_creds["production"]:\n                self.pushAppleService = apnsServiceBuilder.withProductionDestination().build()\n            else:\n                self.pushAppleService = apnsServiceBuilder.withSandboxDestination().build()\n\n            self.pushAppleServiceProduction = ios_creds["production"]\n\n            print "Super-Janssen. Initialize native notification services. Created iOS notification service"\n\n        enabled = self.pushAndroidService != None or self.pushAppleService != None\n\n        return enabled\n\n    def initSnsPushNotificationService(self, configurationAttributes):\n        print "Super-Janssen. Initialize SNS notification services"\n        self.pushSnsMode = True\n\n        creds = self.loadPushNotificationCreds(configurationAttributes)\n        if creds == None:\n            return False\n        \n        try:\n            sns_creds = creds["sns"]\n            android_creds = creds["android"]["sns"]\n            ios_creds = creds["ios"]["sns"]\n        except:\n            print "Super-Janssen. Initialize SNS notification services. Invalid credentials file format"\n            return False\n        \n        self.pushAndroidService = None\n        self.pushAppleService = None\n        if not (android_creds["enabled"] or ios_creds["enabled"]):\n            print "Super-Janssen. Initialize SNS notification services. SNS disabled for all platforms"\n            return False\n\n        sns_access_key = sns_creds["access_key"]\n        sns_secret_access_key = sns_creds["secret_access_key"]\n        sns_region = sns_creds["region"]\n\n        encryptionService = CdiUtil.bean(EncryptionService)\n\n        try:\n            sns_secret_access_key = encryptionService.decrypt(sns_secret_access_key)\n        except:\n            # Ignore exception. Password is not encrypted\n            print "Super-Janssen. Initialize SNS notification services. Assuming that \'sns_secret_access_key\' in not encrypted"\n        \n        pushSnsService = CdiUtil.bean(PushSnsService)\n        pushClient = pushSnsService.createSnsClient(sns_access_key, sns_secret_access_key, sns_region)\n\n        if android_creds["enabled"]:\n            self.pushAndroidService = pushClient\n            self.pushAndroidPlatformArn = android_creds["platform_arn"]\n            print "Super-Janssen. Initialize SNS notification services. Created Android notification service"\n\n        if ios_creds["enabled"]:\n            self.pushAppleService = pushClient \n            self.pushApplePlatformArn = ios_creds["platform_arn"]\n            self.pushAppleServiceProduction = ios_creds["production"]\n            print "Super-Janssen. Initialize SNS notification services. Created iOS notification service"\n\n        enabled = self.pushAndroidService != None or self.pushAppleService != None\n\n        return enabled\n\n    def initJanssenPushNotificationService(self, configurationAttributes):\n        print "Super-Janssen. Initialize Janssen notification services"\n\n        self.pushJanssenMode = True\n\n        creds = self.loadPushNotificationCreds(configurationAttributes)\n        if creds == None:\n            return False\n        \n        try:\n           .jans.conf = creds[.jans.]\n            android_creds = creds["android"][.jans.]\n            ios_creds = creds["ios"][.jans.]\n        except:\n            print "Super-Janssen. Initialize Janssen notification services. Invalid credentials file format"\n            return False\n        \n        self.pushAndroidService = None\n        self.pushAppleService = None\n        if not (android_creds["enabled"] or ios_creds["enabled"]):\n            print "Super-Janssen. Initialize Janssen notification services. Janssen disabled for all platforms"\n            return False\n\n       .jans.server_uri =.jans.conf["server_uri"]\n        notifyClientFactory = NotifyClientFactory.instance()\n        metadataConfiguration = None\n        try:\n            metadataConfiguration = notifyClientFactory.createMetaDataConfigurationService.jans.server_uri).getMetadataConfiguration()\n        except:\n            print "Super-Janssen. Initialize Janssen notification services. Failed to load metadata. Exception: ", sys.exc_info()[1]\n            return False\n\n       .jans.lient = notifyClientFactory.createNotifyService(metadataConfiguration)\n        encryptionService = CdiUtil.bean(EncryptionService)\n\n        if android_creds["enabled"]:\n           .jans.access_key = android_creds["access_key"]\n           .jans.secret_access_key = android_creds["secret_access_key"]\n    \n            try:\n               .jans.secret_access_key = encryptionService.decrypt.jans.secret_access_key)\n            except:\n                # Ignore exception. Password is not encrypted\n                print "Super-Janssen. Initialize Janssen notification services. Assuming that .jans.secret_access_key\' in not encrypted"\n            \n            self.pushAndroidService =.jans.lient \n            self.pushAndroidServiceAuth = notifyClientFactory.getAuthorization.jans.access_key,.jans.secret_access_key);\n            print "Super-Janssen. Initialize Janssen notification services. Created Android notification service"\n\n        if ios_creds["enabled"]:\n           .jans.access_key = ios_creds["access_key"]\n           .jans.secret_access_key = ios_creds["secret_access_key"]\n    \n            try:\n               .jans.secret_access_key = encryptionService.decrypt.jans.secret_access_key)\n            except:\n                # Ignore exception. Password is not encrypted\n                print "Super-Janssen. Initialize Janssen notification services. Assuming that .jans.secret_access_key\' in not encrypted"\n            \n            self.pushAppleService =.jans.lient \n            self.pushAppleServiceAuth = notifyClientFactory.getAuthorization.jans.access_key,.jans.secret_access_key);\n            print "Super-Janssen. Initialize Janssen notification services. Created iOS notification service"\n\n        enabled = self.pushAndroidService != None or self.pushAppleService != None\n\n        return enabled\n\n    def loadPushNotificationCreds(self, configurationAttributes):\n        print "Super-Janssen. Initialize notification services"\n        if not configurationAttributes.containsKey("credentials_file"):\n            return None\n\n        super.jans.creds_file = configurationAttributes.get("credentials_file").getValue2()\n\n        # Load credentials from file\n        f = open(super.jans.creds_file, \'r\')\n        try:\n            creds = json.loads(f.read())\n        except:\n            print "Super-Janssen. Initialize notification services. Failed to load credentials from file:", super.jans.creds_file\n            return None\n        finally:\n            f.close()\n\n        return creds\n\n    def sendPushNotification(self, client_redirect_uri, user, super.jans.request):\n        try:\n            self.sendPushNotificationImpl(client_redirect_uri, user, super.jans.request)\n        except:\n            print "Super-Janssen. Send push notification. Failed to send push notification: ", sys.exc_info()[1]\n\n    def sendPushNotificationImpl(self, client_redirect_uri, user, super.jans.request):\n        if not self.enabledPushNotifications:\n            return\n\n        user_name = user.getUserId()\n        print "Super-Janssen. Send push notification. Loading user \'%s\' devices" % user_name\n\n        send_notification = False\n        send_notification_result = True\n\n        userService = CdiUtil.bean(UserService)\n        deviceRegistrationService = CdiUtil.bean(DeviceRegistrationService)\n\n        user_inum = userService.getUserInum(user_name)\n\n        send_android = 0\n        send_ios = 0\n        u2f_devices_list = deviceRegistrationService.findUserDeviceRegistrations(user_inum, client_redirect_uri, "oxId", "oxDeviceData", "oxDeviceNotificationConf")\n        if u2f_devices_list.size() > 0:\n            for u2f_device in u2f_devices_list:\n                device_data = u2f_device.getDeviceData()\n\n                # Device data which Super-Janssen gets during enrollment\n                if device_data == None:\n                    continue\n\n                platform = device_data.getPlatform()\n                push_token = device_data.getPushToken()\n                debug = False\n\n                if StringHelper.equalsIgnoreCase(platform, "ios") and StringHelper.isNotEmpty(push_token):\n                    # Sending notification to iOS user\'s device\n                    if self.pushAppleService == None:\n                        print "Super-Janssen. Send push notification. Apple native push notification service is not enabled"\n                    else:\n                        send_notification = True\n                        \n                        title = "Super Janssen"\n                        message = "Confirm your sign in request to: %s" % client_redirect_uri\n\n                        if self.pushSnsMode or self.pushJanssenMode:\n                            pushSnsService = CdiUtil.bean(PushSnsService)\n                            targetEndpointArn = self.getTargetEndpointArn(deviceRegistrationService, pushSnsService, PushPlatform.APNS, user, u2f_device)\n                            if targetEndpointArn == None:\n                            \treturn\n\n                            send_notification = True\n    \n                            sns_push_request_dictionary = { "aps": \n                                                                { "badge": 0,\n                                                                  "alert" : {"body": message, "title" : title},\n                                                                  "category": "ACTIONABLE",\n                                                                  "content-available": "1",\n                                                                  "sound": \'default\'\n                                                           },\n                                                           "request" : super.jans.request\n                            }\n                            push_message = json.dumps(sns_push_request_dictionary, separators=(\',\',\':\'))\n    \n                            if self.pushSnsMode:\n                                apple_push_platform = PushPlatform.APNS\n                                if not self.pushAppleServiceProduction:\n                                    apple_push_platform = PushPlatform.APNS_SANDBOX\n        \n                                send_notification_result = pushSnsService.sendPushMessage(self.pushAppleService, apple_push_platform, targetEndpointArn, push_message, None)\n                                if debug:\n                                    print "Super-Janssen. Send iOS SNS push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\', apple_push_platform: \'%s\'" % (push_token, push_message, send_notification_result, apple_push_platform)\n                            elif self.pushJanssenMode:\n                                send_notification_result = self.pushAppleService.sendNotification(self.pushAppleServiceAuth, targetEndpointArn, push_message)\n                                if debug:\n                                    print "Super-Janssen. Send iOS Janssen push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\'" % (push_token, push_message, send_notification_result)\n                        else:\n                            additional_fields = { "request" : super.jans.request }\n    \n                            msgBuilder = APNS.newPayload().alertBody(message).alertTitle(title).sound("default")\n                            msgBuilder.category(\'ACTIONABLE\').badge(0)\n                            msgBuilder.forNewsstand()\n                            msgBuilder.customFields(additional_fields)\n                            push_message = msgBuilder.build()\n    \n                            send_notification_result = self.pushAppleService.push(push_token, push_message)\n                            if debug:\n                                print "Super-Janssen. Send iOS Native push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\'" % (push_token, push_message, send_notification_result)\n                        send_ios = send_ios + 1\n\n                if StringHelper.equalsIgnoreCase(platform, "android") and StringHelper.isNotEmpty(push_token):\n                    # Sending notification to Android user\'s device\n                    if self.pushAndroidService == None:\n                        print "Super-Janssen. Send native push notification. Android native push notification service is not enabled"\n                    else:\n                        send_notification = True\n\n                        title = "Super-Janssen"\n                        if self.pushSnsMode or self.pushJanssenMode:\n                            pushSnsService = CdiUtil.bean(PushSnsService)\n                            targetEndpointArn = self.getTargetEndpointArn(deviceRegistrationService, pushSnsService, PushPlatform.GCM, user, u2f_device)\n                            if targetEndpointArn == None:\n                            \treturn\n\n                            send_notification = True\n    \n                            sns_push_request_dictionary = { "collapse_key": "single",\n                                                            "content_available": True,\n                                                            "time_to_live": 60,\n                                                            "data": \n                                                                { "message" : super.jans.request,\n                                                                  "title" : title }\n                            }\n                            push_message = json.dumps(sns_push_request_dictionary, separators=(\',\',\':\'))\n    \n                            if self.pushSnsMode:\n                                send_notification_result = pushSnsService.sendPushMessage(self.pushAndroidService, PushPlatform.GCM, targetEndpointArn, push_message, None)\n                                if debug:\n                                    print "Super-Janssen. Send Android SNS push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\'" % (push_token, push_message, send_notification_result)\n                            elif self.pushJanssenMode:\n                                send_notification_result = self.pushAndroidService.sendNotification(self.pushAndroidServiceAuth, targetEndpointArn, push_message)\n                                if debug:\n                                    print "Super-Janssen. Send Android Janssen push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\'" % (push_token, push_message, send_notification_result)\n                        else:\n                            msgBuilder = Message.Builder().addData("message", super.jans.request).addData("title", title).collapseKey("single").contentAvailable(True)\n                            push_message = msgBuilder.build()\n    \n                            send_notification_result = self.pushAndroidService.send(push_message, push_token, 3)\n                            if debug:\n                                print "Super-Janssen. Send Android Native push notification. token: \'%s\', message: \'%s\', send_notification_result: \'%s\'" % (push_token, push_message, send_notification_result)\n                        send_android = send_android + 1\n\n        print "Super-Janssen. Send push notification. send_android: \'%s\', send_ios: \'%s\'" % (send_android, send_ios)\n\n    def getTargetEndpointArn(self, deviceRegistrationService, pushSnsService, platform, user, u2fDevice):\n        targetEndpointArn = None\n                             \n        # Return endpoint ARN if it created already\n        notificationConf = u2fDevice.getDeviceNotificationConf()\n        if StringHelper.isNotEmpty(notificationConf):\n            notificationConfJson = json.loads(notificationConf)\n            targetEndpointArn = notificationConfJson[\'sns_endpoint_arn\']\n            if StringHelper.isNotEmpty(targetEndpointArn):\n                print "Super-Janssen. Get target endpoint ARN. There is already created target endpoint ARN"\n                return targetEndpointArn\n\n        # Create endpoint ARN        \n        pushClient = None\n        pushClientAuth = None\n        platformApplicationArn = None\n        if platform == PushPlatform.GCM:\n            pushClient = self.pushAndroidService\n            if self.pushSnsMode:\n                platformApplicationArn = self.pushAndroidPlatformArn\n            if self.pushJanssenMode:\n                pushClientAuth = self.pushAndroidServiceAuth\n        elif platform == PushPlatform.APNS:\n            pushClient = self.pushAppleService\n            if self.pushSnsMode:\n                platformApplicationArn = self.pushApplePlatformArn\n            if self.pushJanssenMode:\n                pushClientAuth = self.pushAppleServiceAuth\n        else:\n            return None\n\n        deviceData = u2fDevice.getDeviceData()\n        pushToken = deviceData.getPushToken()\n        \n        print "Super-Janssen. Get target endpoint ARN. Attempting to create target endpoint ARN for user: \'%s\'" % user.getUserId()\n        if self.pushSnsMode:\n            targetEndpointArn = pushSnsService.createPlatformArn(pushClient, platformApplicationArn, pushToken, user)\n        else:\n            customUserData = pushSnsService.getCustomUserData(user)\n            registerDeviceResponse = pushClient.registerDevice(pushClientAuth, pushToken, customUserData);\n            if registerDeviceResponse != None and registerDeviceResponse.getStatusCode() == 200:\n                targetEndpointArn = registerDeviceResponse.getEndpointArn()\n        \n        if StringHelper.isEmpty(targetEndpointArn):\n\t        print "Super-Janssen. Failed to get endpoint ARN for user: \'%s\'" % user.getUserId()\n        \treturn None\n\n        print "Super-Janssen. Get target endpoint ARN. Create target endpoint ARN \'%s\' for user: \'%s\'" % (targetEndpointArn, user.getUserId())\n        \n        # Store created endpoint ARN in device entry\n        userInum = user.getAttribute("inum")\n        u2fDeviceUpdate = deviceRegistrationService.findUserDeviceRegistration(userInum, u2fDevice.getId())\n        u2fDeviceUpdate.setDeviceNotificationConf(\'{"sns_endpoint_arn" : "%s"}\' % targetEndpointArn)\n        deviceRegistrationService.updateDeviceRegistration(userInum, u2fDeviceUpdate)\n\n        return targetEndpointArn\n\n    def getApplicationUri(self, session_attributes):\n        if self.applicationId != None:\n            return self.applicationId\n            \n        if not session_attributes.containsKey("redirect_uri"):\n            return None\n\n        return session_attributes.get("redirect_uri")\n\n    def setRequestScopedParameters(self, identity, step):\n        downloadMap = HashMap()\n        if self.registrationUri != None:\n            identity.setWorkingParameter("external_registration_uri", self.registrationUri)\n\n        if self.androidUrl!= None and step == 1:\n            downloadMap.put("android", self.androidUrl)\n\n        if self.IOSUrl  != None and step == 1:\n            downloadMap.put("ios", self.IOSUrl)\n            \n        if self.customLabel != None:\n            identity.setWorkingParameter("super.jans.label", self.customLabel)\n            \n        identity.setWorkingParameter("download_url", downloadMap)\n        identity.setWorkingParameter("super.jans.qr_options", self.customQrOptions)\n\n    def addGeolocationData(self, session_attributes, super.jans.request_dictionary):\n        if session_attributes.containsKey("remote_ip"):\n            remote_ip = session_attributes.get("remote_ip")\n            if StringHelper.isNotEmpty(remote_ip):\n                print "Super-Janssen. Prepare for step 2. Adding req_ip and req_loc to super.jans.request"\n                super.jans.request_dictionary[\'req_ip\'] = remote_ip\n\n                remote_loc_dic = self.determineGeolocationData(remote_ip)\n                if remote_loc_dic == None:\n                    print "Super-Janssen. Prepare for step 2. Failed to determine remote location by remote IP \'%s\'" % remote_ip\n                    return\n\n                remote_loc = "%s, %s, %s" % ( remote_loc_dic[\'country\'], remote_loc_dic[\'regionName\'], remote_loc_dic[\'city\'] )\n                remote_loc_encoded = urllib.quote(remote_loc.encode(\'utf-8\'))\n                super.jans.request_dictionary[\'req_loc\'] = remote_loc_encoded\n\n    def determineGeolocationData(self, remote_ip):\n        print "Super-Janssen. Determine remote location. remote_ip: \'%s\'" % remote_ip\n        httpService = CdiUtil.bean(HttpService)\n\n        http_client = httpService.getHttpsClient()\n        http_client_params = http_client.getParams()\n        http_client_params.setIntParameter(CoreConnectionPNames.CONNECTION_TIMEOUT, 15 * 1000)\n        \n        geolocation_service_url = "http://ip-api.com/json/%s?fields=49177" % remote_ip\n        geolocation_service_headers = { "Accept" : "application/json" }\n\n        try:\n            http_service_response = httpService.executeGet(http_client, geolocation_service_url,  geolocation_service_headers)\n            http_response = http_service_response.getHttpResponse()\n        except:\n            print "Super-Janssen. Determine remote location. Exception: ", sys.exc_info()[1]\n            return None\n\n        try:\n            if not httpService.isResponseStastusCodeOk(http_response):\n                print "Super-Janssen. Determine remote location. Get invalid response from validation server: ", str(http_response.getStatusLine().getStatusCode())\n                httpService.consume(http_response)\n                return None\n    \n            response_bytes = httpService.getResponseContent(http_response)\n            response_string = httpService.convertEntityToString(response_bytes)\n            httpService.consume(http_response)\n        finally:\n            http_service_response.closeConnection()\n\n        if response_string == None:\n            print "Super-Janssen. Determine remote location. Get empty response from location server"\n            return None\n        \n        response = json.loads(response_string)\n        \n        if not StringHelper.equalsIgnoreCase(response[\'status\'], "success"):\n            print "Super-Janssen. Determine remote location. Get response with status: \'%s\'" % response[\'status\']\n            return None\n\n        return response\n\n    def isUserMemberOfGroup(self, user, attribute, group):\n        is_member = False\n        member_of_list = user.getAttributeValues(attribute)\n        if (member_of_list != None):\n            for member_of in member_of_list:\n                if StringHelper.equalsIgnoreCase(group, member_of) or member_of.endswith(group):\n                    is_member = True\n                    break\n\n        return is_member\n\n    def processAuditGroup(self, user, attribute, group):\n        is_member = self.isUserMemberOfGroup(user, attribute, group)\n        if (is_member):\n            print "Super-Janssen. Authenticate for processAuditGroup. User \'%s\' member of audit group" % user.getUserId()\n            print "Super-Janssen. Authenticate for processAuditGroup. Sending e-mail about user \'%s\' login to %s" % (user.getUserId(), self.audit_email)\n            \n            # Send e-mail to administrator\n            user_id = user.getUserId()\n            mailService = CdiUtil.bean(MailService)\n            subject = "User log in: %s" % user_id\n            body = "User log in: %s" % user_id\n            mailService.sendMail(self.audit_email, subject, body)\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=92F0-759E,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=92F0-759E,ou=scripts,o=jans entry:{'description': ['ThumbSignIn authentication module'], 'displayName': ['thumb_sign_in'], 'inum': ['92F0-759E'], 'jansConfProperty': ['{"value1":"ts_host","value2":"https://ts.host.com","description":""}', '{"value1":"ts_apiKey","value2":"ts_api_key","description":""}', '{"value1":"ts_apiSecret","value2":"ts_api_secret","description":""}'], 'jansLevel': ['50'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}', '{"value1":"usage_type","value2":"interactive","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# Author: ThumbSignIn\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.util import StringHelper\nfrom io.jans.as.util import ServerUtil\nfrom com.pramati.ts.thumbsignin_java_sdk import ThumbsigninApiController\nfrom org.json import JSONObject\nfrom io.jans.as.model.util import Base64Util\nfrom java.lang import String\n\nimport java\n\n\nclass PersonAuthentication(PersonAuthenticationType):\n\n    def __init__(self, current_time_millis):\n        self.currentTimeMillis = current_time_millis\n        self.thumbsigninApiController = ThumbsigninApiController()\n\n    def init(self, customScript, configuration_attributes):\n        print "ThumbSignIn. Initialization"\n\n        global ts_host\n        ts_host = configuration_attributes.get("ts_host").getValue2()\n        print "ThumbSignIn. Initialization. Value of ts_host is %s" % ts_host\n\n        global ts_api_key\n        ts_api_key = configuration_attributes.get("ts_apiKey").getValue2()\n        print "ThumbSignIn. Initialization. Value of ts_api_key is %s" % ts_api_key\n\n        global ts_api_secret\n        ts_api_secret = configuration_attributes.get("ts_apiSecret").getValue2()\n\n        global ts_statusPath\n        ts_statusPath = "/ts/secure/txn-status/"\n\n        global AUTHENTICATE\n        AUTHENTICATE = "authenticate"\n\n        global REGISTER\n        REGISTER = "register"\n\n        global TRANSACTION_ID\n        TRANSACTION_ID = "transactionId"\n\n        global USER_ID\n        USER_ID = "userId"\n\n        global USER_LOGIN_FLOW\n        USER_LOGIN_FLOW = "userLoginFlow"\n\n        global THUMBSIGNIN_AUTHENTICATION\n        THUMBSIGNIN_AUTHENTICATION = "ThumbSignIn_Authentication"\n\n        global THUMBSIGNIN_REGISTRATION\n        THUMBSIGNIN_REGISTRATION = "ThumbSignIn_Registration"\n\n        global THUMBSIGNIN_LOGIN_POST_REGISTRATION\n        THUMBSIGNIN_LOGIN_POST_REGISTRATION = "ThumbSignIn_RegistrationSucess"\n\n        global RELYING_PARTY_ID\n        RELYING_PARTY_ID = "relyingPartyId"\n\n        global RELYING_PARTY_LOGIN_URL\n        RELYING_PARTY_LOGIN_URL = "relyingPartyLoginUrl"\n\n        global TSI_LOGIN_PAGE\n        TSI_LOGIN_PAGE = "/auth/thumbsignin/tsLogin.xhtml"\n\n        global TSI_REGISTER_PAGE\n        TSI_REGISTER_PAGE = "/auth/thumbsignin/tsRegister.xhtml"\n\n        global TSI_LOGIN_POST_REGISTRATION_PAGE\n        TSI_LOGIN_POST_REGISTRATION_PAGE = "/auth/thumbsignin/tsRegistrationSuccess.xhtml"\n\n        print "ThumbSignIn. Initialized successfully"\n        return True\n\n    @staticmethod\n    def set_relying_party_login_url(identity):\n        print "ThumbSignIn. Inside set_relying_party_login_url..."\n        session_id = identity.getSessionId()\n        session_attribute = session_id.getSessionAttributes()\n        state_jwt_token = session_attribute.get("state")\n        print "ThumbSignIn. Value of state_jwt_token is %s" % state_jwt_token\n        relying_party_login_url = ""\n        if (state_jwt_token is None) or ("." not in state_jwt_token):\n            print "ThumbSignIn. Value of state parameter is not in the format of JWT Token"\n            identity.setWorkingParameter(RELYING_PARTY_LOGIN_URL, relying_party_login_url)\n            return None\n\n        state_jwt_token_array = String(state_jwt_token).split("\\\\.")\n        state_jwt_token_payload = state_jwt_token_array[1]\n        state_payload_str = String(Base64Util.base64urldecode(state_jwt_token_payload), "UTF-8")\n        state_payload_json = JSONObject(state_payload_str)\n        print "ThumbSignIn. Value of state JWT token Payload is %s" % state_payload_json\n        if state_payload_json.has("additional_claims"):\n            additional_claims = state_payload_json.get("additional_claims")\n            relying_party_id = additional_claims.get(RELYING_PARTY_ID)\n            print "ThumbSignIn. Value of relying_party_id is %s" % relying_party_id\n            identity.setWorkingParameter(RELYING_PARTY_ID, relying_party_id)\n\n            if String(relying_party_id).startsWith("google.com"):\n                # google.com/a/unphishableenterprise.com\n                relying_party_id_array = String(relying_party_id).split("/")\n                google_domain = relying_party_id_array[2]\n                print "ThumbSignIn. Value of google_domain is %s" % google_domain\n                relying_party_login_url = "https://www.google.com/accounts/AccountChooser?hd="+ google_domain + "%26continue=https://apps.google.com/user/hub"\n                # elif (String(relying_party_id).startsWith("xyz")):\n                # relying_party_login_url = "xyz.com"\n            else:\n                # If relying_party_login_url is empty, Janssen\'s default login URL will be used\n                relying_party_login_url = ""\n\n        print "ThumbSignIn. Value of relying_party_login_url is %s" % relying_party_login_url\n        identity.setWorkingParameter(RELYING_PARTY_LOGIN_URL, relying_party_login_url)\n        return None\n\n    def initialize_thumbsignin(self, identity, request_path):\n        # Invoking the authenticate/register ThumbSignIn API via the Java SDK\n        thumbsignin_response = self.thumbsigninApiController.handleThumbSigninRequest(request_path, ts_api_key, ts_api_secret)\n        print "ThumbSignIn. Value of thumbsignin_response is %s" % thumbsignin_response\n\n        thumbsignin_response_json = JSONObject(thumbsignin_response)\n        transaction_id = thumbsignin_response_json.get(TRANSACTION_ID)\n        status_request_type = "authStatus" if request_path == AUTHENTICATE else "regStatus"\n        status_request = status_request_type + "/" + transaction_id\n        print "ThumbSignIn. Value of status_request is %s" % status_request\n\n        authorization_header = self.thumbsigninApiController.getAuthorizationHeaderJsonStr(status_request, ts_api_key, ts_api_secret)\n        print "ThumbSignIn. Value of authorization_header is %s" % authorization_header\n        # {"authHeader":"HmacSHA256 Credential=X,SignedHeaders=accept;content-type;x-ts-date,Signature=X","XTsDate":"X"}\n        authorization_header_json = JSONObject(authorization_header)\n        auth_header = authorization_header_json.get("authHeader")\n        x_ts_date = authorization_header_json.get("XTsDate")\n\n        tsi_response_key = "authenticateResponseJsonStr" if request_path == AUTHENTICATE else "registerResponseJsonStr"\n        identity.setWorkingParameter(tsi_response_key, thumbsignin_response)\n        identity.setWorkingParameter("authorizationHeader", auth_header)\n        identity.setWorkingParameter("xTsDate", x_ts_date)\n        return None\n\n    def prepareForStep(self, configuration_attributes, request_parameters, step):\n        print "ThumbSignIn. Inside prepareForStep. Step %d" % step\n        identity = CdiUtil.bean(Identity)\n        authentication_service = CdiUtil.bean(AuthenticationService)\n\n        identity.setWorkingParameter("ts_host", ts_host)\n        identity.setWorkingParameter("ts_statusPath", ts_statusPath)\n\n        self.set_relying_party_login_url(identity)\n\n        if step == 1 or step == 3:\n            print "ThumbSignIn. Prepare for step 1"\n            self.initialize_thumbsignin(identity, AUTHENTICATE)\n            return True\n\n        elif step == 2:\n            print "ThumbSignIn. Prepare for step 2"\n            if identity.isSetWorkingParameter(USER_LOGIN_FLOW):\n                user_login_flow = identity.getWorkingParameter(USER_LOGIN_FLOW)\n                print "ThumbSignIn. Value of user_login_flow is %s" % user_login_flow\n            user = authentication_service.getAuthenticatedUser()\n            if user is None:\n                print "ThumbSignIn. Prepare for step 2. Failed to determine user name"\n                return False\n            user_name = user.getUserId()\n            print "ThumbSignIn. Prepare for step 2. user_name: " + user_name\n            if user_name is None:\n                return False\n            identity.setWorkingParameter(USER_ID, user_name)\n            self.initialize_thumbsignin(identity, REGISTER + "/" + user_name)\n            return True\n        else:\n            return False\n\n    def get_user_id_from_thumbsignin(self, request_parameters):\n        transaction_id = ServerUtil.getFirstValue(request_parameters, TRANSACTION_ID)\n        print "ThumbSignIn. Value of transaction_id is %s" % transaction_id\n        get_user_request = "getUser/" + transaction_id\n        print "ThumbSignIn. Value of get_user_request is %s" % get_user_request\n\n        get_user_response = self.thumbsigninApiController.handleThumbSigninRequest(get_user_request, ts_api_key, ts_api_secret)\n        print "ThumbSignIn. Value of get_user_response is %s" % get_user_response\n        get_user_response_json = JSONObject(get_user_response)\n        thumbsignin_user_id = get_user_response_json.get(USER_ID)\n        print "ThumbSignIn. Value of thumbsignin_user_id is %s" % thumbsignin_user_id\n        return thumbsignin_user_id\n\n    def authenticate(self, configuration_attributes, request_parameters, step):\n        print "ThumbSignIn. Inside authenticate. Step %d" % step\n        authentication_service = CdiUtil.bean(AuthenticationService)\n        identity = CdiUtil.bean(Identity)\n\n        identity.setWorkingParameter("ts_host", ts_host)\n        identity.setWorkingParameter("ts_statusPath", ts_statusPath)\n\n        if step == 1 or step == 3:\n            print "ThumbSignIn. Authenticate for Step %d" % step\n\n            login_flow = ServerUtil.getFirstValue(request_parameters, "login_flow")\n            print "ThumbSignIn. Value of login_flow parameter is %s" % login_flow\n\n            # Logic for ThumbSignIn Authentication Flow (Either step 1 or step 3)\n            if login_flow == THUMBSIGNIN_AUTHENTICATION or login_flow == THUMBSIGNIN_LOGIN_POST_REGISTRATION:\n                identity.setWorkingParameter(USER_LOGIN_FLOW, login_flow)\n                print "ThumbSignIn. Value of userLoginFlow is %s" % identity.getWorkingParameter(USER_LOGIN_FLOW)\n                logged_in_status = authentication_service.authenticate(self.get_user_id_from_thumbsignin(request_parameters))\n                print "ThumbSignIn. logged_in status : %r" % logged_in_status\n                return logged_in_status\n\n            # Logic for traditional login flow (step 1)\n            print "ThumbSignIn. User credentials login flow"\n            identity.setWorkingParameter(USER_LOGIN_FLOW, THUMBSIGNIN_REGISTRATION)\n            print "ThumbSignIn. Value of userLoginFlow is %s" % identity.getWorkingParameter(USER_LOGIN_FLOW)\n            logged_in = self.authenticate_user_credentials(identity, authentication_service)\n            print "ThumbSignIn. Status of User Credentials based Authentication : %r" % logged_in\n\n            # When the traditional login fails, reinitialize the ThumbSignIn data before sending error response to UI\n            if not logged_in:\n                self.initialize_thumbsignin(identity, AUTHENTICATE)\n                return False\n\n            print "ThumbSignIn. Authenticate successful for step %d" % step\n            return True\n\n        elif step == 2:\n            print "ThumbSignIn. Registration flow (step 2)"\n            self.verify_user_login_flow(identity)\n\n            user = self.get_authenticated_user_from.jans.authentication_service)\n            if user is None:\n                print "ThumbSignIn. Registration flow (step 2). Failed to determine user name"\n                return False\n\n            user_name = user.getUserId()\n            print "ThumbSignIn. Registration flow (step 2) successful. user_name: %s" % user_name\n            return True\n\n        else:\n            return False\n\n    def authenticate_user_credentials(self, identity, authentication_service):\n        credentials = identity.getCredentials()\n        user_name = credentials.getUsername()\n        user_password = credentials.getPassword()\n        print "ThumbSignIn. user_name: " + user_name\n        logged_in = False\n        if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n            logged_in = self.authenticate_user_in.jans.ldap(authentication_service, user_name, user_password)\n        return logged_in\n\n    @staticmethod\n    def authenticate_user_in.jans.ldap(authentication_service, user_name, user_password):\n        return authentication_service.authenticate(user_name, user_password)\n\n    @staticmethod\n    def get_authenticated_user_from.jans.authentication_service):\n        return authentication_service.getAuthenticatedUser()\n\n    @staticmethod\n    def verify_user_login_flow(identity):\n        if identity.isSetWorkingParameter(USER_LOGIN_FLOW):\n            user_login_flow = identity.getWorkingParameter(USER_LOGIN_FLOW)\n            print "ThumbSignIn. Value of user_login_flow is %s" % user_login_flow\n        else:\n            identity.setWorkingParameter(USER_LOGIN_FLOW, THUMBSIGNIN_REGISTRATION)\n            print "ThumbSignIn. Setting the value of user_login_flow to %s" % identity.getWorkingParameter(USER_LOGIN_FLOW)\n\n    def getExtraParametersForStep(self, configuration_attributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configuration_attributes):\n        print "ThumbSignIn. Inside getCountAuthenticationSteps.."\n        identity = CdiUtil.bean(Identity)\n\n        user_login_flow = identity.getWorkingParameter(USER_LOGIN_FLOW)\n        print "ThumbSignIn. Value of userLoginFlow is %s" % user_login_flow\n        if user_login_flow == THUMBSIGNIN_AUTHENTICATION:\n            print "ThumbSignIn. Total Authentication Steps is: 1"\n            return 1\n        print "ThumbSignIn. Total Authentication Steps is: 3"\n        return 3\n\n    def getPageForStep(self, configuration_attributes, step):\n        print "ThumbSignIn. Inside getPageForStep. Step %d" % step\n        if step == 3:\n            return TSI_LOGIN_POST_REGISTRATION_PAGE\n        thumbsignin_page = TSI_REGISTER_PAGE if step == 2 else TSI_LOGIN_PAGE\n        return thumbsignin_page\n\n    def destroy(self, configurationAttributes):\n        print "ThumbSignIn. Destroy"\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=A51E-76DA,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=A51E-76DA,ou=scripts,o=jans entry:{'description': ['Sample authentication module'], 'displayName': ['basic'], 'inum': ['A51E-76DA'], 'jansLevel': ['10'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.util import StringHelper\n\nimport java\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print "Basic. Initialization"\n        print "Basic. Initialized successfully"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Basic. Destroy"\n        print "Basic. Destroyed successfully"\n        return True\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def getApiVersion(self):\n        return 11\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        if (step == 1):\n            print "Basic. Authenticate for step 1"\n\n            identity = CdiUtil.bean(Identity)\n            credentials = identity.getCredentials()\n\n            user_name = credentials.getUsername()\n            user_password = credentials.getPassword()\n\n            logged_in = False\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if (not logged_in):\n                return False\n\n            return True\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            print "Basic. Prepare for Step 1"\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return ""\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=A910-56AB,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=A910-56AB,ou=scripts,o=jans entry:{'description': ['Sample script for SCIM events'], 'displayName': ['scim_event_handler'], 'inum': ['A910-56AB'], 'jansConfProperty': ['{"value1":"testProp1","value2":"Test value 1","description":""}', '{"value1":"testProp2","value2":"Test value 2","description":""}'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxTrust is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2014, Janssen\n#\n# Author: Jose Gonzalez\n#\nfrom io.jans.model.custom.script.type.scim import ScimType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\nfrom io.jans.oxtrust.ldap.service import PersonService\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.oxtrust.model import JanssenCustomPerson\n\nimport java\n\nclass ScimEventHandler(ScimType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "ScimEventHandler (init): Initialized successfully"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "ScimEventHandler (destroy): Destroyed successfully"\n        return True   \n\n    def getApiVersion(self):\n        #return 2 if you want the post* scripts being executed\n        return 11\n\n    def createUser(self, user, configurationAttributes):\n\n        print "ScimEventHandler (createUser): Current id = " + user.getUid()\n\n        testProp1 = configurationAttributes.get("testProp1").getValue2()\n        testProp2 = configurationAttributes.get("testProp2").getValue2()\n\n        print "ScimEventHandler (createUser): testProp1 = " + testProp1\n        print "ScimEventHandler (createUser): testProp2 = " + testProp2\n\n        return True\n\n    def updateUser(self, user, configurationAttributes):\n        personService = CdiUtil.bean(PersonService)\n        oldUser = personService.getPersonByUid(user.getUid())\n        print "ScimEventHandler (updateUser): Old displayName %s" % oldUser.getDisplayName()\n        print "ScimEventHandler (updateUser): New displayName " + user.getDisplayName()\n        return True\n\n    def deleteUser(self, user, configurationAttributes):\n        print "ScimEventHandler (deleteUser): Current id = " + user.getUid()\n        return True\n\n    def createGroup(self, group, configurationAttributes):\n        print "ScimEventHandler (createGroup): Current displayName = " + group.getDisplayName()\n        return True\n\n    def updateGroup(self, group, configurationAttributes):\n        print "ScimEventHandler (updateGroup): Current displayName = " + group.getDisplayName()\n        return True\n\n    def deleteGroup(self, group, configurationAttributes):\n        print "ScimEventHandler (deleteGroup): Current displayName = " + group.getDisplayName()\n        return True\n        \n    def postCreateUser(self, user, configurationAttributes):\n        return True\n\n    def postUpdateUser(self, user, configurationAttributes):\n        return True\n\n    def postDeleteUser(self, user, configurationAttributes):\n        return True\n\n    def postUpdateGroup(self, group, configurationAttributes):\n        return True\n\n    def postCreateGroup(self, group, configurationAttributes):\n        return True\n\n    def postDeleteGroup(self, group, configurationAttributes):\n        return True'], 'jansScrTyp': ['scim'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=DAA9-B788,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=DAA9-B788,ou=scripts,o=jans entry:{'description': ['Sample Client Registration script'], 'displayName': ['client_registration'], 'inum': ['DAA9-B788'], 'jansConfProperty': ['{"value1":"client_redirect_uris","value2":"https://client.example.com/example1, https://client.example.com/example2","description":""}'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.client import ClientRegistrationType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.service import ScopeService\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList, HashSet\n\nimport java\n\nclass ClientRegistration(ClientRegistrationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Client registration. Initialization"\n        \n        self.clientRedirectUrisSet = self.prepareClientRedirectUris(configurationAttributes)\n\n        print "Client registration. Initialized successfully"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Client registration. Destroy"\n        print "Client registration. Destroyed successfully"\n        return True   \n\n    # Update client entry before persistent it\n    #   registerRequest is io.jans.as.client.RegisterRequest\n    #   client is io.jans.as.model.registration.Client\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def createClient(self, registerRequest, client, configurationAttributes):\n        print "Client registration. CreateClient method"\n\n        redirectUris = client.getRedirectUris()\n        print "Client registration. Redirect Uris: %s" % redirectUris\n\n        addAddressScope = False\n        for redirectUri in redirectUris:\n            if (self.clientRedirectUrisSet.contains(redirectUri)):\n                addAddressScope = True\n                break\n        \n        print "Client registration. Is add address scope: %s" % addAddressScope\n\n        if addAddressScope:\n            currentScopes = client.getScopes()\n            print "Client registration. Current scopes: %s" % currentScopes\n            \n            scopeService = CdiUtil.bean(ScopeService)\n            addressScope = scopeService.getScopeByDisplayName("address")\n            newScopes = ArrayHelper.addItemToStringArray(currentScopes, addressScope.getDn())\n    \n            print "Client registration. Result scopes: %s" % newScopes\n            client.setScopes(newScopes)\n\n        return True\n\n    # Update client entry before persistent it\n    #   registerRequest is io.jans.as.client.RegisterRequest\n    #   client is io.jans.as.model.registration.Client\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def updateClient(self, registerRequest, client, configurationAttributes):\n        print "Client registration. UpdateClient method"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def prepareClientRedirectUris(self, configurationAttributes):\n        clientRedirectUrisSet = HashSet()\n        if not configurationAttributes.containsKey("client_redirect_uris"):\n            return clientRedirectUrisSet\n\n        clientRedirectUrisList = configurationAttributes.get("client_redirect_uris").getValue2()\n        if StringHelper.isEmpty(clientRedirectUrisList):\n            print "Client registration. The property client_redirect_uris is empty"\n            return clientRedirectUrisSet    \n\n        clientRedirectUrisArray = StringHelper.split(clientRedirectUrisList, ",")\n        if ArrayHelper.isEmpty(clientRedirectUrisArray):\n            print "Client registration. No clients specified in client_redirect_uris property"\n            return clientRedirectUrisSet\n        \n        # Convert to HashSet to quick search\n        i = 0\n        count = len(clientRedirectUrisArray)\n        while i < count:\n            uris = clientRedirectUrisArray[i]\n            clientRedirectUrisSet.add(uris)\n            i = i + 1\n\n        return clientRedirectUrisSet\n\n    # Returns secret key which will be used to validate Software Statement if HMAC algorithm is used (e.g. HS256, HS512). Invoked if oxauth conf property softwareStatementValidationType=SCRIPT which is default/fallback value.\n    # context is reference of io.jans.as.service.external.context.DynamicClientRegistrationContext (in https://github.com/JanssenFederation/oxauth project )\n    def getSoftwareStatementHmacSecret(self, context):\n        return ""\n\n    # Returns JWKS which will be used to validate Software Statement if keys are used (e.g. RS256). Invoked if oxauth conf property softwareStatementValidationType=SCRIPT which is default/fallback value.\n    # context is reference of io.jans.as.service.external.context.DynamicClientRegistrationContext (in https://github.com/JanssenFederation/oxauth project )\n    def getSoftwareStatementJwks(self, context):\n        return ""\n'], 'jansScrTyp': ['client_registration'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=09A0-93D6,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=09A0-93D6,ou=scripts,o=jans entry:{'description': ['Twilio SMS authentication module'], 'displayName': ['twilio_sms'], 'inum': ['09A0-93D6'], 'jansConfProperty': ['{"value1":"twilio_sid","value2":"","description":"Twilio account SID"}', '{"value1":"twilio_token","value2":"","description":"Twilio API token"}', '{"value1":"from_number","value2":"","description":"Twilio phone number with SMS capabilities"}'], 'jansLevel': ['50'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\r\n# Copyright (c) 2018, Janssen\r\n#\r\n# Author: Jose Gonzalez\r\n# Author: Gasmyr Mougang\r\n\r\nfrom io.jans.service.cdi.util import CdiUtil\r\nfrom io.jans.as.server.security import Identity\r\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\r\nfrom io.jans.as.server.service import AuthenticationService\r\nfrom io.jans.as.server.service import UserService\r\nfrom io.jans.as.server.service import SessionIdService\r\nfrom io.jans.as.util import ServerUtil\r\nfrom io.jans.util import StringHelper, ArrayHelper\r\nfrom java.util import Arrays\r\nfrom javax.faces.application import FacesMessage\r\nfrom io.jans.jsf2.message import FacesMessages\r\n\r\nimport com.twilio.Twilio as Twilio\r\nimport com.twilio.rest.api.v2010.account.Message as Message\r\nimport com.twilio.type.PhoneNumber as PhoneNumber\r\nimport org.codehaus.jettison.json.JSONArray as JSONArray\r\n\r\n\r\nimport java\r\nimport random\r\nimport jarray\r\n\r\nclass PersonAuthentication(PersonAuthenticationType):\r\n    def __init__(self, currentTimeMillis):\r\n        self.currentTimeMillis = currentTimeMillis\r\n        self.mobile_number = None\r\n        self.identity = CdiUtil.bean(Identity)\r\n\r\n    def init(self, customScript, configurationAttributes):\r\n        print "=============================================="\r\n        print "===TWILIO SMS INITIALIZATION=================="\r\n        print "=============================================="\r\n        self.ACCOUNT_SID = None\r\n        self.AUTH_TOKEN = None\r\n        self.FROM_NUMBER = None\r\n\r\n        # Get Custom Properties\r\n        try:\r\n            self.ACCOUNT_SID = configurationAttributes.get("twilio_sid").getValue2()\r\n        except:\r\n            print \'TwilioSMS, Missing required configuration attribute "twilio_sid"\'\r\n\r\n        try:\r\n            self.AUTH_TOKEN = configurationAttributes.get("twilio_token").getValue2()\r\n        except:\r\n            print\'TwilioSMS, Missing required configuration attribute "twilio_token"\'\r\n        try:\r\n            self.FROM_NUMBER = configurationAttributes.get("from_number").getValue2()\r\n        except:\r\n            print\'TwilioSMS, Missing required configuration attribute "from_number"\'\r\n\r\n        if None in (self.ACCOUNT_SID, self.AUTH_TOKEN, self.FROM_NUMBER):\r\n            print "twilio_sid, twilio_token, from_number is empty ... returning False"\r\n            return False\r\n\r\n        print "===TWILIO SMS INITIALIZATION DONE PROPERLY====="  \r\n        return True\r\n\r\n    def destroy(self, configurationAttributes):\r\n        print "Twilio SMS. Destroy"\r\n        print "Twilio SMS. Destroyed successfully"\r\n        return True\r\n\r\n    def getApiVersion(self):\r\n        return 11\r\n        \r\n    def getAuthenticationMethodClaims(self, requestParameters):\r\n        return None\r\n        \r\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\r\n        return True\r\n\r\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\r\n        return None\r\n\r\n    def authenticate(self, configurationAttributes, requestParameters, step):\r\n        print "=============================================="\r\n        print "====TWILIO SMS AUTHENCATION==================="\r\n        print "=============================================="\r\n        userService = CdiUtil.bean(UserService)\r\n        authenticationService = CdiUtil.bean(AuthenticationService)\r\n        sessionIdService = CdiUtil.bean(SessionIdService)\r\n        facesMessages = CdiUtil.bean(FacesMessages)\r\n        facesMessages.setKeepMessages()\r\n\r\n        session_attributes = self.identity.getSessionId().getSessionAttributes()\r\n        form_passcode = ServerUtil.getFirstValue(requestParameters, "passcode")\r\n        form_name = ServerUtil.getFirstValue(requestParameters, "TwilioSmsloginForm")\r\n\r\n        print "TwilioSMS. form_response_passcode: %s" % str(form_passcode)\r\n\r\n        if step == 1:\r\n            print "=============================================="\r\n            print "=TWILIO SMS STEP 1 | Password Authentication=="\r\n            print "=============================================="\r\n            credentials = self.identity.getCredentials()\r\n            user_name = credentials.getUsername()\r\n            user_password = credentials.getPassword()\r\n            logged_in = False\r\n            if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\r\n                logged_in = authenticationService.authenticate(user_name, user_password)\r\n\r\n            if not logged_in:\r\n                return False\r\n\r\n            # Get the Person\'s number and generate a code\r\n            foundUser = None\r\n            try:\r\n                foundUser = authenticationService.getAuthenticatedUser()\r\n            except:\r\n                print \'TwilioSMS, Error retrieving user %s from LDAP\' % (user_name)\r\n                return False\r\n\r\n            try:\r\n                isVerified = foundUser.getAttribute("phoneNumberVerified")\r\n                if isVerified:\r\n                    self.mobile_number = foundUser.getAttribute("employeeNumber")\r\n                if  self.mobile_number == None:\r\n                    self.mobile_number = foundUser.getAttribute("mobile")\r\n                if  self.mobile_number == None:\r\n                    self.mobile_number = foundUser.getAttribute("telephoneNumber")\r\n                if  self.mobile_number == None:\r\n                    print "TwilioSMS, Error finding mobile number for user \'%s\'" % user_name    \r\n                    \r\n            except:\r\n                facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to determine mobile phone number")\r\n                print \'TwilioSMS, Error finding mobile number for "%s". Exception: %s` % (user_name, sys.exc_info()[1])`\'\r\n                return False\r\n\r\n            # Generate Random six digit code and store it in array\r\n            code = random.randint(100000, 999999)\r\n\r\n            # Get code and save it in LDAP temporarily with special session entry\r\n            self.identity.setWorkingParameter("code", code)\r\n            sessionId = sessionIdService.getSessionId() # fetch from persistence\r\n            sessionId.getSessionAttributes().put("code", code)\r\n\r\n            try:\r\n                Twilio.init(self.ACCOUNT_SID, self.AUTH_TOKEN);\r\n                message = Message.creator(PhoneNumber(self.mobile_number), PhoneNumber(self.FROM_NUMBER), str(code)).create();\r\n                print "++++++++++++++++++++++++++++++++++++++++++++++"\r\n                print \'TwilioSMs, Message Sid: %s\' % (message.getSid())\r\n                print \'TwilioSMs, User phone: %s\' % (self.mobile_number)\r\n                print "++++++++++++++++++++++++++++++++++++++++++++++"\r\n                sessionId.getSessionAttributes().put("mobile_number", self.mobile_number)\r\n                sessionId.getSessionAttributes().put("mobile", self.mobile_number)\r\n                sessionIdService.updateSessionId(sessionId)\r\n                self.identity.setWorkingParameter("mobile_number", self.mobile_number)\r\n                self.identity.getSessionId().getSessionAttributes().put("mobile_number",self.mobile_number)\r\n                self.identity.setWorkingParameter("mobile", self.mobile_number)\r\n                self.identity.getSessionId().getSessionAttributes().put("mobile",self.mobile_number)\r\n                print "++++++++++++++++++++++++++++++++++++++++++++++"\r\n                print "Number: %s" % (self.identity.getWorkingParameter("mobile_number"))\r\n                print "Mobile: %s" % (self.identity.getWorkingParameter("mobile"))\r\n                print "++++++++++++++++++++++++++++++++++++++++++++++"\r\n                print "========================================"\r\n                print "===TWILIO SMS FIRST STEP DONE PROPERLY=="\r\n                print "========================================"\r\n                return True\r\n            except Exception, ex:\r\n                facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to send message to mobile phone")\r\n                print "TwilioSMS. Error sending message to Twilio"\r\n                print "TwilioSMS. Unexpected error:", ex\r\n\r\n            return False\r\n        elif step == 2:\r\n            # Retrieve the session attribute\r\n            print "=============================================="\r\n            print "=TWILIO SMS STEP 2 | Password Authentication=="\r\n            print "=============================================="\r\n            code = session_attributes.get("code")\r\n            print \'=======> Session code is "%s"\' % str(code)\r\n            sessionIdService = CdiUtil.bean(SessionIdService)\r\n            sessionId = sessionIdService.getSessionId() # fetch from persistence\r\n            code = sessionId.getSessionAttributes().get("code")\r\n            print \'=======> Database code is "%s"\' % str(code)\r\n            self.identity.setSessionId(sessionId)\r\n            print "=============================================="\r\n            print "TwilioSMS. Code: %s" % str(code)\r\n            print "=============================================="\r\n            if code is None:\r\n                print "TwilioSMS. Failed to find previously sent code"\r\n                return False\r\n\r\n            if form_passcode is None:\r\n                print "TwilioSMS. Passcode is empty"\r\n                return False\r\n\r\n            if len(form_passcode) != 6:\r\n                print "TwilioSMS. Passcode from response is not 6 digits: %s" % form_passcode\r\n                return False\r\n\r\n            if form_passcode == code:\r\n                print "TiwlioSMS, SUCCESS! User entered the same code!"\r\n                print "========================================"\r\n                print "===TWILIO SMS SECOND STEP DONE PROPERLY"\r\n                print "========================================"\r\n                return True\r\n\r\n            print "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" \r\n            print "TwilioSMS. FAIL! User entered the wrong code! %s != %s" % (form_passcode, code)\r\n            print "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" \r\n            facesMessages.add(FacesMessage.SEVERITY_ERROR, "Incorrect Twilio code, please try again.")\r\n            print "================================================"\r\n            print "===TWILIO SMS SECOND STEP FAILED: INCORRECT CODE"\r\n            print "================================================"\r\n            return False\r\n\r\n        print "TwilioSMS. ERROR: step param not found or != (1|2)"\r\n\r\n        return False\r\n\r\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\r\n        if step == 1:\r\n            print "TwilioSMS. Prepare for Step 1"\r\n            return True\r\n        elif step == 2:\r\n            print "TwilioSMS. Prepare for Step 2"\r\n            return True\r\n        return False\r\n\r\n    def getExtraParametersForStep(self, configurationAttributes, step):\r\n        if step == 2:\r\n            return Arrays.asList("code")\r\n\r\n        return None\r\n\r\n    def getCountAuthenticationSteps(self, configurationAttributes):\r\n        return 2\r\n\r\n    def getPageForStep(self, configurationAttributes, step):\r\n        if step == 2:\r\n            return "/auth/otp_sms/otp_sms.xhtml"\r\n\r\n        return ""\r\n        \r\n    def getNextStep(self, configurationAttributes, requestParameters, step):\r\n        return -1\r\n\r\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\r\n        print "Get external logout URL call"\r\n        return None\r\n        \r\n    def logout(self, configurationAttributes, requestParameters):\r\n        return True\r\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=09A0-93D7,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=09A0-93D7,ou=scripts,o=jans entry:{'description': ['SMPP SMS authentication module'], 'displayName': ['smpp'], 'inum': ['09A0-93D7'], 'jansConfProperty': ['{"value1":"smpp_server","value2":"","description":"IP or FQDN of SMPP server"}', '{"value1":"smpp_port","value2":"","description":"TCP port of the SMPP server"}', '{"value1":"system_id","value2":"","description":"Use if SMPP server requires authentication"}', '{"value1":"password","value2":"","description":"Use if SMPP server requires authentication"}', '{"value1":"source_addr_ton","value2":"","description":"Type of number, eg ALPHANUMERIC, INTERNATIONAL"}', '{"value1":"source_addr","value2":"","description":"From number/name"}'], 'jansLevel': ['45'], 'jansModuleProperty': ['{"value1":"usage_type","value2":"interactive","description":""}', '{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n# Copyright (c) 2019, Tele2\n\n# Author: Jose Gonzalez\n# Author: Gasmyr Mougang\n# Author: Stefan Andersson\n\nfrom java.util import Arrays, Date\nfrom java.io import IOException\nfrom java.lang import Enum\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.as.util import ServerUtil\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom javax.faces.application import FacesMessage\nfrom io.jans.jsf2.message import FacesMessages\n\nfrom org.jsmpp import InvalidResponseException, PDUException\nfrom org.jsmpp.bean import Alphabet, BindType, ESMClass, GeneralDataCoding, MessageClass, NumberingPlanIndicator, RegisteredDelivery, SMSCDeliveryReceipt, TypeOfNumber\nfrom org.jsmpp.extra import NegativeResponseException, ResponseTimeoutException\nfrom org.jsmpp.session import BindParameter, SMPPSession\nfrom org.jsmpp.util import AbsoluteTimeFormatter, TimeFormatter\nimport random\n\n\nclass SmppAttributeError(Exception):\n    pass\n\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n        self.identity = CdiUtil.bean(Identity)\n\n    def get_and_parse_smpp_config(self, config, attribute, _type = None,  convert = False, optional = False, default_desc = None):\n        try:\n            value = config.get(attribute).getValue2()\n        except:\n            if default_desc:\n                default_desc = " using default \'{}\'".format(default_desc)\n            else:\n                default_desc = ""\n\n            if optional:\n                raise SmppAttributeError("SMPP missing optional configuration attribute \'{}\'{}".format(attribute, default_desc))\n            else:\n                raise SmppAttributeError("SMPP missing required configuration attribute \'{}\'".format(attribute))\n\n        if _type and issubclass(_type, Enum):\n            try:\n                return getattr(_type, value)\n            except AttributeError:\n                raise SmppAttributeError("SMPP could not find attribute \'{}\' in {}".format(attribute, _type))\n\n        if convert:\n            try:\n                value = int(value)\n            except AttributeError:\n                try:\n                    value = int(value, 16)\n                except AttributeError:\n                    raise SmppAttributeError("SMPP could not parse value \'{}\' of attribute \'{}\'".format(value, attribute))\n\n        return value\n\n    def init(self, customScript, configurationAttributes):\n        print("SMPP Initialization")\n\n        self.TIME_FORMATTER = AbsoluteTimeFormatter()\n\n        self.SMPP_SERVER = None\n        self.SMPP_PORT = None\n\n        self.SYSTEM_ID = None\n        self.PASSWORD = None\n\n        # Setup some good defaults for TON, NPI and source (from) address\n        # TON (Type of Number), NPI (Number Plan Indicator)\n        self.SRC_ADDR_TON = TypeOfNumber.ALPHANUMERIC    # Alphanumeric\n        self.SRC_ADDR_NPI = NumberingPlanIndicator.ISDN  # ISDN (E163/E164)\n        self.SRC_ADDR = "Janssen OTP"\n\n        # Don\'t touch these unless you know what your doing, we don\'t handle number reformatting for\n        # any other type than international.\n        self.DST_ADDR_TON = TypeOfNumber.INTERNATIONAL   # International\n        self.DST_ADDR_NPI = NumberingPlanIndicator.ISDN  # ISDN (E163/E164)\n\n        # Priority flag and data_coding bits\n        self.PRIORITY_FLAG = 3  # Very Urgent (ANSI-136), Emergency (IS-95)\n        self.DATA_CODING_ALPHABET = Alphabet.ALPHA_DEFAULT  # SMS default alphabet\n        self.DATA_CODING_MESSAGE_CLASS = MessageClass.CLASS1  # EM (Mobile Equipment (mobile memory), normal message\n\n        # Required server settings\n        try:\n            self.SMPP_SERVER = self.get_and_parse_smpp_config(configurationAttributes, "smpp_server")\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.SMPP_PORT = self.get_and_parse_smpp_config(configurationAttributes, "smpp_port", convert = True)\n        except SmppAttributeError as e:\n            print(e)\n\n        if None in (self.SMPP_SERVER, self.SMPP_PORT):\n            print("SMPP smpp_server and smpp_port is empty, will not enable SMPP service")\n            return False\n\n        # Optional system_id and password for bind auth\n        try:\n            self.SYSTEM_ID = self.get_and_parse_smpp_config(configurationAttributes, "system_id", optional = True)\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.PASSWORD = self.get_and_parse_smpp_config(configurationAttributes, "password", optional = True)\n        except SmppAttributeError as e:\n            print(e)\n\n        if None in (self.SYSTEM_ID, self.PASSWORD):\n            print("SMPP Authentication disabled")\n\n        # From number and to number settings\n        try:\n            self.SRC_ADDR_TON = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "source_addr_ton",\n                _type = TypeOfNumber,\n                optional = True,\n                default_desc = self.SRC_ADDR_TON\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.SRC_ADDR_NPI = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "source_addr_npi",\n                _type = NumberingPlanIndicator,\n                optional = True,\n                default_desc = self.SRC_ADDR_NPI\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.SRC_ADDR = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "source_addr",\n                optional = True,\n                default_desc = self.SRC_ADDR\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.DST_ADDR_TON = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "dest_addr_ton",\n                _type = TypeOfNumber,\n                optional = True,\n                default_desc = self.DST_ADDR_TON\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.DST_ADDR_NPI = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "dest_addr_npi",\n                _type = NumberingPlanIndicator,\n                optional = True,\n                default_desc = self.DST_ADDR_NPI\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        # Priority flag and data coding, don\'t touch these unless you know what your doing...\n        try:\n            self.PRIORITY_FLAG = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "priority_flag",\n                convert = True,\n                optional = True,\n                default_desc = "3 (Very Urgent, Emergency)"\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.DATA_CODING_ALPHABET = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "data_coding_alphabet",\n                _type = Alphabet,\n                optional = True,\n                default_desc = self.DATA_CODING_ALPHABET\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        try:\n            self.DATA_CODING_MESSAGE_CLASS = self.get_and_parse_smpp_config(\n                configurationAttributes,\n                "data_coding_alphabet",\n                _type = MessageClass,\n                optional = True,\n                default_desc = self.DATA_CODING_MESSAGE_CLASS\n            )\n        except SmppAttributeError as e:\n            print(e)\n\n        print("SMPP Initialized successfully")\n        return True\n\n    def destroy(self, configurationAttributes):\n        print("SMPP Destroy")\n        print("SMPP Destroyed successfully")\n        return True\n\n    def getApiVersion(self):\n        return 11\n        \n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n        \n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        userService = CdiUtil.bean(UserService)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        facesMessages = CdiUtil.bean(FacesMessages)\n        facesMessages.setKeepMessages()\n\n        session_attributes = self.identity.getSessionId().getSessionAttributes()\n        form_passcode = ServerUtil.getFirstValue(requestParameters, "passcode")\n\n        print("SMPP form_response_passcode: {}".format(str(form_passcode)))\n\n        if step == 1:\n            print("SMPP Step 1 Password Authentication")\n            credentials = self.identity.getCredentials()\n\n            user_name = credentials.getUsername()\n            user_password = credentials.getPassword()\n\n            logged_in = False\n            if StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password):\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if not logged_in:\n                return False\n\n            # Get the Person\'s number and generate a code\n            foundUser = None\n            try:\n                foundUser = authenticationService.getAuthenticatedUser()\n            except:\n                print("SMPP Error retrieving user {} from LDAP".format(user_name))\n                return False\n\n            mobile_number = None\n            try:\n                isVerified = foundUser.getAttribute("phoneNumberVerified")\n                if isVerified:\n                    mobile_number = foundUser.getAttribute("employeeNumber")\n                if not mobile_number:\n                    mobile_number = foundUser.getAttribute("mobile")\n                if not mobile_number:\n                    mobile_number = foundUser.getAttribute("telephoneNumber")\n                if not mobile_number:\n                    facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to determine mobile phone number")\n                    print("SMPP Error finding mobile number for user \'{}\'".format(user_name))\n                    return False\n            except Exception as e:\n                facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to determine mobile phone number")\n                print("SMPP Error finding mobile number for {}: {}".format(user_name, e))\n                return False\n\n            # Generate Random six digit code\n            code = random.randint(100000, 999999)\n\n            # Get code and save it in LDAP temporarily with special session entry\n            self.identity.setWorkingParameter("code", code)\n\n            self.identity.setWorkingParameter("mobile_number", mobile_number)\n            self.identity.getSessionId().getSessionAttributes().put("mobile_number", mobile_number)\n            if not self.sendMessage(mobile_number, str(code)):\n                facesMessages.add(FacesMessage.SEVERITY_ERROR, "Failed to send message to mobile phone")\n                return False\n\n            return True\n        elif step == 2:\n            # Retrieve the session attribute\n            print("SMPP Step 2 SMS/OTP Authentication")\n            code = session_attributes.get("code")\n            print("SMPP Code: {}".format(str(code)))\n\n            if code is None:\n                print("SMPP Failed to find previously sent code")\n                return False\n\n            if form_passcode is None:\n                print("SMPP Passcode is empty")\n                return False\n\n            if len(form_passcode) != 6:\n                print("SMPP Passcode from response is not 6 digits: {}".format(form_passcode))\n                return False\n\n            if form_passcode == code:\n                print("SMPP SUCCESS! User entered the same code!")\n                return True\n\n            print("SMPP failed, user entered the wrong code! {} != {}".format(form_passcode, code))\n            facesMessages.add(facesMessage.SEVERITY_ERROR, "Incorrect SMS code, please try again.")\n            return False\n\n        print("SMPP ERROR: step param not found or != (1|2)")\n        return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if step == 1:\n            print("SMPP Prepare for Step 1")\n            return True\n        elif step == 2:\n            print("SMPP Prepare for Step 2")\n            return True\n\n        return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        if step == 2:\n            return Arrays.asList("code")\n\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 2\n\n    def getPageForStep(self, configurationAttributes, step):\n        if step == 2:\n            return "/auth/otp_sms/otp_sms.xhtml"\n\n        return ""\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print "Get external logout URL call"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n\n    def sendMessage(self, number, code):\n        status = False\n        session = SMPPSession()\n        session.setTransactionTimer(10000)\n\n        # We only handle international destination number reformatting.\n        # All others may vary by configuration decisions taken on SMPP\n        # server side which we have no clue about.\n        if self.DST_ADDR_TON == TypeOfNumber.INTERNATIONAL and number.startswith("+"):\n            number = number[1:]\n\n        try:\n            print("SMPP Connecting")\n            reference_id = session.connectAndBind(\n                self.SMPP_SERVER,\n                self.SMPP_PORT,\n                BindParameter(\n                    BindType.BIND_TX,\n                    self.SYSTEM_ID,\n                    self.PASSWORD,\n                    None,\n                    self.SRC_ADDR_TON,\n                    self.SRC_ADDR_NPI,\n                    None\n                )\n            )\n            print("SMPP Connected to server with system id {}".format(reference_id))\n\n            try:\n                message_id = session.submitShortMessage(\n                    "CMT",\n                    self.SRC_ADDR_TON,\n                    self.SRC_ADDR_NPI,\n                    self.SRC_ADDR,\n                    self.DST_ADDR_TON,\n                    self.DST_ADDR_NPI,\n                    number,\n                    ESMClass(),\n                    0,\n                    self.PRIORITY_FLAG,\n                    self.TIME_FORMATTER.format(Date()),\n                    None,\n                    RegisteredDelivery(SMSCDeliveryReceipt.DEFAULT),\n                    0,\n                    GeneralDataCoding(\n                        self.DATA_CODING_ALPHABET,\n                        self.DATA_CODING_MESSAGE_CLASS,\n                        False\n                    ),\n                    0,\n                    code\n                )\n                print("SMPP Message \'{}\' sent to #{} with message id {}".format(code, number, message_id))\n                status = True\n            except PDUException as e:\n                print("SMPP Invalid PDU parameter: {}".format(e))\n            except ResponseTimeoutException as e:\n                print("SMPP Response timeout: {}".format(e))\n            except InvalidResponseException as e:\n                print("SMPP Receive invalid response: {}".format(e))\n            except NegativeResponseException as e:\n                print("SMPP Receive negative response: {}".format(e))\n            except IOException as e:\n                print("SMPP IO error occured: {}".format(e))\n            finally:\n                session.unbindAndClose()\n        except IOException as e:\n            print("SMPP Failed connect and bind to host: {}".format(e))\n\n        return status\n'], 'jansScrTyp': ['person_authentication'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=DAA9-B789,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=DAA9-B789,ou=scripts,o=jans entry:{'description': ['Sample Application Session script'], 'displayName': ['application_session'], 'inum': ['DAA9-B789'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.session import ApplicationSessionType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.persist import PersistenceEntryManager\nfrom io.jans.as.model.config import StaticConfiguration\nfrom io.jans.as.model.ldap import TokenLdap\nfrom javax.faces.application import FacesMessage\nfrom io.jans.jsf2.message import FacesMessages\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom io.jans.as.model.config import Constants\nfrom java.util import Arrays, ArrayList\nfrom io.jans.as.service.external.session import SessionEventType\n\nimport java\n\nclass ApplicationSession(ApplicationSessionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Application session. Initialization"\n\n        self.entryManager = CdiUtil.bean(PersistenceEntryManager)\n        self.staticConfiguration = CdiUtil.bean(StaticConfiguration)\n\n        print "Application session. Initialized successfully"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print "Application session. Destroy"\n        print "Application session. Destroyed successfully"\n        return True   \n\n    def getApiVersion(self):\n        return 11\n\n    # Called each time specific session event occurs\n    # event is io.jans.as.service.external.session.SessionEvent\n    def onEvent(self, event):\n        if event.getType() == SessionEventType.AUTHENTICATED:\n            print "Session is authenticated, session: " + event.getSessionId().getId()\n        return\n\n    # Application calls it at start session request to allow notify 3rd part systems\n    #   httpRequest is javax.servlet.http.HttpServletRequest\n    #   sessionId is io.jans.as.model.common.SessionId\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def startSession(self, httpRequest, sessionId, configurationAttributes):\n        print "Application session. Starting external session"\n\n        user_name = sessionId.getSessionAttributes().get(Constants.AUTHENTICATED_USER)\n\n        first_session = self.isFirstSession(user_name)\n        if not first_session:\n            facesMessages = CdiUtil.bean(FacesMessages)\n            facesMessages.add(FacesMessage.SEVERITY_ERROR, "Please, end active session first!")\n            return False\n\n        print "Application session. External session started successfully"\n        return True\n\n    # Application calls it at end session request to allow notify 3rd part systems\n    #   httpRequest is javax.servlet.http.HttpServletRequest\n    #   sessionId is io.jans.as.model.common.SessionId\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def endSession(self, httpRequest, sessionId, configurationAttributes):\n        print "Application session. Starting external session end"\n\n        print "Application session. External session ended successfully"\n        return True\n\n    def isFirstSession(self, user_name):\n        tokenLdap = TokenLdap()\n        tokenLdap.setDn(self.staticConfiguration.getBaseDn().getClients())\n        tokenLdap.setUserId(user_name)\n\n        tokenLdapList = self.entryManager.findEntries(tokenLdap, 1)\n        print "Application session. isFirstSession. Get result: \'%s\'" % tokenLdapList\n\n        if (tokenLdapList != None) and (tokenLdapList.size() > 0):\n            print "Application session. isFirstSession: False"\n            return False\n\n        print "Application session. isFirstSession: True"\n        return True\n'], 'jansScrTyp': ['application_session'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=DAA9-BA60,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=DAA9-BA60,ou=scripts,o=jans entry:{'description': ['Consent Gathering script'], 'displayName': ['consent_gathering'], 'inum': ['DAA9-BA60'], 'jansLevel': ['10'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2017, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.authz import ConsentGatheringType\nfrom io.jans.util import StringHelper\n\nimport java\nimport random\n\nclass ConsentGathering(ConsentGatheringType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Consent-Gathering. Initializing ..."\n        print "Consent-Gathering. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Consent-Gathering. Destroying ..."\n        print "Consent-Gathering. Destroyed successfully"\n\n        return True\n\n    def getApiVersion(self):\n        return 1\n\n    # Main consent-gather method. Must return True (if gathering performed successfully) or False (if fail).\n    # All user entered values can be access via Map<String, String> context.getPageAttributes()\n    def authorize(self, step, context): # context is reference of io.jans.as.service.external.context.ConsentGatheringContext\n        print "Consent-Gathering. Authorizing..."\n\n        if step == 1:\n            allowButton = context.getRequestParameters().get("authorizeForm:allowButton")\n            if (allowButton != None) and (len(allowButton) > 0):\n                print "Consent-Gathering. Authorization success for step 1"\n                return True\n\n            print "Consent-Gathering. Authorization declined for step 1"\n        elif step == 2:\n            allowButton = context.getRequestParameters().get("authorizeForm:allowButton")\n            if (allowButton != None) and (len(allowButton) > 0):\n                print "Consent-Gathering. Authorization success for step 2"\n                return True\n\n            print "Consent-Gathering. Authorization declined for step 2"\n\n        return False\n\n    def getNextStep(self, step, context):\n        return -1\n\n    def prepareForStep(self, step, context):\n        if not context.isAuthenticated():\n            print "User is not authenticated. Aborting authorization flow ..."\n            return False\n\n        if step == 2:\n            pageAttributes = context.getPageAttributes()\n            \n            # Generate random consent gathering request\n            consentRequest = "Requested transaction #%s approval for the amount of sum $ %s.00" % ( random.randint(100000, 1000000), random.randint(1, 100) )\n            pageAttributes.put("consent_request", consentRequest)\n            return True\n\n        return True\n\n    def getStepsCount(self, context):\n        return 11\n\n    def getPageForStep(self, step, context):\n        if step == 1:\n            return "/authz/authorize.xhtml"\n        elif step == 2:\n            return "/authz/transaction.xhtml"\n\n        return ""\n'], 'jansScrTyp': ['consent_gathering'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=8AF7.D82A,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=8AF7.D82A,ou=scripts,o=jans entry:{'displayName': ['persistence_extension'], 'inum': ['8AF7.D82A'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.model.custom.script.type.persistence import PersistenceType\nfrom io.jans.util import StringHelper\nfrom io.jans.persist.operation.auth import PasswordEncryptionHelper\nfrom io.jans.persist.operation.auth import PasswordEncryptionMethod\n\nimport java\n\nclass PersistenceExtension(PersistenceType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Persistence extension. Initialization"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Persistence extension. Destroy"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def onAfterCreate(self, context, configurationAttributes):\n        print "Persistence extension. Method: onAfterCreate"\n\n    def onAfterDestroy(self, context, configurationAttributes):\n        print "Persistence extension. Method: onAfterDestroy"\n\n    def createHashedPassword(self, credential):\n        print "Persistence extension. Method: createHashedPassword"\n\n        hashed_password= PasswordEncryptionHelper.createStoragePassword(credential, PasswordEncryptionMethod.HASH_METHOD_PKCS5S2)\n\n        return hashed_password\n\n    def compareHashedPasswords(self, credential, storedCredential):\n        print "Persistence extension. Method: compareHashedPasswords"\n        \n        auth_result = PasswordEncryptionHelper.compareCredentials(credential, storedCredential)\n\n        return auth_result \n'], 'jansScrTyp': ['persistence_extension'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=8AF7.D82B,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=8AF7.D82B,ou=scripts,o=jans entry:{'displayName': ['idp'], 'inum': ['8AF7.D82B'], 'jansLevel': ['100'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxShibboleth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.idp import IdpType\nfrom io.jans.util import StringHelper\nfrom io.jans.idp.externalauth import AuthenticatedNameTranslator\nfrom net.shibboleth.idp.authn.principal import UsernamePrincipal, IdPAttributePrincipal\nfrom net.shibboleth.idp.authn import ExternalAuthentication\nfrom net.shibboleth.idp.attribute import IdPAttribute, StringAttributeValue\nfrom net.shibboleth.idp.authn.context import AuthenticationContext, ExternalAuthenticationContext\nfrom net.shibboleth.idp.attribute.context import AttributeContext\nfrom javax.security.auth import Subject\nfrom java.util import Collections, HashMap, HashSet, ArrayList, Arrays\n\nimport java\n\nclass IdpExtension(IdpType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Idp extension. Initialization"\n        \n        self.defaultNameTranslator = AuthenticatedNameTranslator()\n        \n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Idp extension. Destroy"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Translate attributes from user profile\n    #   context is io.jans.idp.externalauth.TranslateAttributesContext (https://github.com/JanssenFederation/shib-oxauth-authn3/blob/master/src/main/java/io.jans.idp/externalauth/TranslateAttributesContext.java)\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def translateAttributes(self, context, configurationAttributes):\n        print "Idp extension. Method: translateAttributes"\n        \n        # Return False to use default method\n        #return False\n        \n        request = context.getRequest()\n        userProfile = context.getUserProfile()\n        principalAttributes = self.defaultNameTranslator.produceIdpAttributePrincipal(userProfile.getAttributes())\n        print "Idp extension. Converted user profile: \'%s\' to attribute principal: \'%s\'" % (userProfile, principalAttributes)\n\n        if not principalAttributes.isEmpty():\n            print "Idp extension. Found attributes from oxAuth. Processing..."\n            \n            # Start: Custom part\n            # Add givenName attribute\n            givenNameAttribute = IdPAttribute("jansEnrollmentCode")\n            givenNameAttribute.setValues(ArrayList(Arrays.asList(StringAttributeValue("Dummy"))))\n            principalAttributes.add(IdPAttributePrincipal(givenNameAttribute))\n            print "Idp extension. Updated attribute principal: \'%s\'" % principalAttributes\n            # End: Custom part\n\n            principals = HashSet()\n            principals.addAll(principalAttributes)\n            principals.add(UsernamePrincipal(userProfile.getId()))\n\n            request.setAttribute(ExternalAuthentication.SUBJECT_KEY, Subject(False, Collections.singleton(principals),\n                Collections.emptySet(), Collections.emptySet()))\n\n            print "Created an IdP subject instance with principals containing attributes for: \'%s\'" % userProfile.getId()\n\n            if False:\n                idpAttributes = ArrayList()\n                for principalAttribute in principalAttributes:\n                    idpAttributes.add(principalAttribute.getAttribute())\n    \n                request.setAttribute(ExternalAuthentication.ATTRIBUTES_KEY, idpAttributes)\n    \n                authenticationKey = context.getAuthenticationKey()\n                profileRequestContext = ExternalAuthentication.getProfileRequestContext(authenticationKey, request)\n                authContext = profileRequestContext.getSubcontext(AuthenticationContext)\n                extContext = authContext.getSubcontext(ExternalAuthenticationContext)\n    \n                extContext.setSubject(Subject(False, Collections.singleton(principals), Collections.emptySet(), Collections.emptySet()));\n    \n                extContext.getSubcontext(AttributeContext, True).setUnfilteredIdPAttributes(idpAttributes)\n                extContext.getSubcontext(AttributeContext).setIdPAttributes(idpAttributes)\n        else:\n            print "No attributes released from oxAuth. Creating an IdP principal for: \'%s\'" % userProfile.getId()\n            request.setAttribute(ExternalAuthentication.PRINCIPAL_NAME_KEY, userProfile.getId())\n\n        #Return True to specify that default method is not needed\n        return False\n\n    # Update attributes before releasing them\n    #   context is io.jans.idp.consent.processor.PostProcessAttributesContext (https://github.com/JanssenFederation/shib-oxauth-authn3/blob/master/src/main/java/io.jans.idp/consent/processor/PostProcessAttributesContext.java)\n    #   configurationAttributes is java.util.Map<String, SimpleCustomProperty>\n    def updateAttributes(self, context, configurationAttributes):\n        print "Idp extension. Method: updateAttributes"\n        attributeContext = context.getAttributeContext()\n\n        customAttributes = HashMap()\n        customAttributes.putAll(attributeContext.getIdPAttributes())\n\n        # Remove givenName attribute\n        customAttributes.remove("givenName")\n\n        # Update surname attribute\n        if customAttributes.containsKey("sn"):\n            customAttributes.get("sn").setValues(ArrayList(Arrays.asList(StringAttributeValue("Dummy"))))\n        \n        # Set updated attributes\n        attributeContext.setIdPAttributes(customAttributes.values())\n\n        return True\n'], 'jansScrTyp': ['idp'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=2D3E.5A03,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=2D3E.5A03,ou=scripts,o=jans entry:{'objectClass': ['top', 'jansCustomScr'], 'description': ['Update token sample script'], 'displayName': ['update_token_sample'], 'inum': ['2D3E.5A03'], 'jansEnabled': ['false'], 'jansLevel': ['1'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['12'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2021, Gluu\n#\n# Author: Yuriy Movchan\n#\n#\n\nfrom io.jans.model.custom.script.type.token import UpdateTokenType\n\nclass UpdateToken(UpdateTokenType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print "Update token script. Initializing ..."\n        print "Update token script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Update token script. Destroying ..."\n        print "Update token script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - indicates that script applied changes\n    # This method is called after adding headers and claims. Hence script can override them\n    # Note :\n    # jsonWebResponse - is io.jans.as.model.token.JsonWebResponse, you can use any method to manipulate JWT\n    # context is reference of io.jans.as.server.service.external.context.ExternalUpdateTokenContext (in https://github.com/JanssenProject/jans-auth-server project, )\n    def modifyIdToken(self, jsonWebResponse, context):\n        print "Update token script. Modify idToken: %s" % jsonWebResponse\n\n        jsonWebResponse.getHeader().setClaim("custom_header_name", "custom_header_value")\n        jsonWebResponse.getClaims().setClaim("custom_claim_name", "custom_claim_value")\n\n        print "Update token script. After modify idToken: %s" % jsonWebResponse\n        return True\n'], 'jansScrTyp': ['update_token'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Querying LDAP for dn inum=C1BA-C1BA,ou=scripts,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=C1BA-C1BA,ou=scripts,o=jans entry:{'description': ['Firebase notification sender'], 'displayName': ['firebase_ciba_end_user_notification'], 'inum': ['C1BA-C1BA'], 'jansLevel': ['10'], 'jansModuleProperty': ['{"value1":"location_type","value2":"ldap","description":""}'], 'jansRevision': ['1'], 'jansScr': ['# oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n#\n# Author: Milton BO\n#\n#\n\nfrom io.jans.as.client.fcm import FirebaseCloudMessagingResponse\nfrom io.jans.as.client.fcm import FirebaseCloudMessagingClient\nfrom io.jans.as.client.fcm import FirebaseCloudMessagingRequest\nfrom io.jans.as.util import RedirectUri\nfrom io.jans.model.custom.script.type.ciba import EndUserNotificationType\nfrom java.lang import String\nfrom java.util import UUID\n\nclass EndUserNotification(EndUserNotificationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, configurationAttributes):\n        print "Firebase EndUserNotification script. Initializing ..."\n        print "Firebase EndUserNotification script. Initialized successfully"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print "Firebase EndUserNotification script. Destroying ..."\n        print "Firebase EndUserNotification script. Destroyed successfully"\n        return True\n\n    def getApiVersion(self):\n        return 1\n\n    # Returns boolean true or false depending on the process, if the notification\n    # is sent successfully or not.\n    def notifyEndUser(self, context):\n        print \'Sending push notification using Firebase Cloud Messaging\'\n        appConfiguration = context.getAppConfiguration()\n        encryptionService = context.getEncryptionService()\n        clientId = appConfiguration.getBackchannelClientId()\n        redirectUri = appConfiguration.getBackchannelRedirectUri()\n        url = appConfiguration.getCibaEndUserNotificationConfig().getNotificationUrl()\n        key = encryptionService.decrypt(appConfiguration.getCibaEndUserNotificationConfig().getNotificationKey(), True)\n        to = context.getDeviceRegistrationToken()\n        title = "oxAuth Authentication Request"\n        body = "Client Initiated Backchannel Authentication (CIBA)"\n\n        authorizationRequestUri = RedirectUri(appConfiguration.getAuthorizationEndpoint())\n        authorizationRequestUri.addResponseParameter("client_id", clientId)\n        authorizationRequestUri.addResponseParameter("response_type", "id_token")\n        authorizationRequestUri.addResponseParameter("scope", context.getScope())\n        authorizationRequestUri.addResponseParameter("acr_values", context.getAcrValues())\n        authorizationRequestUri.addResponseParameter("redirect_uri", redirectUri)\n        authorizationRequestUri.addResponseParameter("state", UUID.randomUUID().toString())\n        authorizationRequestUri.addResponseParameter("nonce", UUID.randomUUID().toString())\n        authorizationRequestUri.addResponseParameter("prompt", "consent")\n        authorizationRequestUri.addResponseParameter("auth_req_id", context.getAuthReqId())\n\n        clickAction = authorizationRequestUri.toString()\n\n        firebaseCloudMessagingRequest = FirebaseCloudMessagingRequest(key, to, title, body, clickAction)\n        firebaseCloudMessagingClient = FirebaseCloudMessagingClient(url)\n        firebaseCloudMessagingClient.setRequest(firebaseCloudMessagingRequest)\n        firebaseCloudMessagingResponse = firebaseCloudMessagingClient.exec()\n\n        responseStatus = firebaseCloudMessagingResponse.getStatus()\n        print "CIBA: firebase cloud messaging result status " + str(responseStatus)\n        return (responseStatus >= 200 and responseStatus < 300 )\n\n'], 'jansScrTyp': ['ciba_end_user_notification'], 'objectClass': ['top', 'jansCustomScr'], 'jansEnabled': ['false'], 'jansProgLng': ['python']}
11:35:29 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-auth/people.ldif
11:35:29 06/21/21 Querying LDAP for dn inum=e14aac95-476c-42a3-b2f6-5dd9da6d6c15,ou=people,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=e14aac95-476c-42a3-b2f6-5dd9da6d6c15,ou=people,o=jans entry:{'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'inum': ['e14aac95-476c-42a3-b2f6-5dd9da6d6c15'], 'uid': ['admin'], 'givenName': ['Admin'], 'middleName': ['Admin'], 'nickname': ['Admin'], 'sn': ['User'], 'userPassword': ['{SSHA}c0k4gZ2w+ANBu6guaojYfV+CV0N1v/08'], 'jansStatus': ['active'], 'memberOf': ['inum=60B7,ou=groups,o=jans'], 'displayName': ['Default Admin User'], 'mail': ['admin@test.dd.jans.io'], 'emailVerified': ['true']}
11:35:29 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-auth/groups.ldif
11:35:29 06/21/21 Querying LDAP for dn inum=60B7,ou=groups,o=jans
11:35:29 06/21/21 Adding LDAP dn:inum=60B7,ou=groups,o=jans entry:{'objectClass': ['top', 'jansGrp'], 'inum': ['60B7'], 'jansStatus': ['active'], 'displayName': ['Jannsen Manager Group'], 'description': ['This group is for administrative purpose, with full acces to users'], 'member': ['inum=e14aac95-476c-42a3-b2f6-5dd9da6d6c15,ou=people,o=jans']}
11:35:29 06/21/21 Installing Jans-Config-Api
11:35:29 06/21/21 Bind to database
11:35:29 06/21/21 Created dir: /opt/jans/jans-config-api
11:35:29 06/21/21 Created dir: /opt/jans/jans-config-api/config
11:35:29 06/21/21 Created dir: /opt/jans/jans-config-api/logs
11:35:29 06/21/21 Created dir: /opt/jans/jans-setup/output/jans-config-api
11:35:29 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jans-config-api
11:35:29 06/21/21 Copying file /opt/jans/jans-setup/static/system/systemd/jans-config-api.service to /etc/systemd/system
11:35:29 06/21/21 Copied /opt/jans/jans-setup/static/system/systemd/jans-config-api.service to /etc/systemd/system
11:35:29 06/21/21 Copying file /opt/dist/jans/jans-config-api-runner.jar to /opt/jans/jans-config-api
11:35:29 06/21/21 Copied /opt/dist/jans/jans-config-api-runner.jar to /opt/jans/jans-config-api
11:35:29 06/21/21 Copying file /opt/jans/jans-setup/static/system/initd/jans-config-api to /opt/dist/scripts
11:35:29 06/21/21 Copied /opt/jans/jans-setup/static/system/initd/jans-config-api to /opt/dist/scripts
11:35:29 06/21/21 Running: /bin/chmod +x /opt/dist/scripts/jans-config-api
11:35:29 06/21/21 Running: /usr/bin/systemctl enable jans-config-api
11:35:29 06/21/21 Run: /usr/bin/systemctl enable jans-config-api with result code: 0
11:35:29 06/21/21 Reading file /opt/jans/jans-setup/setup_app/data/jans-config-api-swagger.yaml
11:35:30 06/21/21 Checking ID for client jca_client_id
11:35:30 06/21/21 Searching database for dn ou=clients,o=jans with filter (&(inum=1801.*)(objectClass=jansClnt))
11:35:30 06/21/21 Client ID for jca_client_id was created as 1801.0e9613e2-804e-487b-9696-84bb8045b895
11:35:30 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-config-api/application.properties
11:35:30 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-config-api/application.properties
11:35:30 06/21/21 Writing file /opt/jans/jans-setup/output/jans-config-api/application.properties
11:35:30 06/21/21 Copying file /opt/jans/jans-setup/output/jans-config-api/application.properties to /opt/jans/jans-config-api/config
11:35:30 06/21/21 Copied /opt/jans/jans-setup/output/jans-config-api/application.properties to /opt/jans/jans-config-api/config
11:35:30 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/jans-config-api/scopes.ldif, /opt/jans/jans-setup/output/jans-config-api/clients.ldif 
11:35:30 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-config-api/scopes.ldif
11:35:30 06/21/21 Querying LDAP for dn inum=1800.71CF52,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.71CF52,ou=scopes,o=jans entry:{'description': ['View Auth Server properties related information'], 'displayName': ['Config API scope https://jans.io/oauth/jans-auth-server/config/properties.readonly'], 'inum': ['1800.71CF52'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/jans-auth-server/config/properties.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.23F516,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.23F516,ou=scopes,o=jans entry:{'description': ['Manage Auth Server properties related information'], 'displayName': ['Config API scope https://jans.io/oauth/jans-auth-server/config/properties.write'], 'inum': ['1800.23F516'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/jans-auth-server/config/properties.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.B1125F,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.B1125F,ou=scopes,o=jans entry:{'description': ['View FIDO2 related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/fido2.readonly'], 'inum': ['1800.B1125F'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/fido2.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.02C5BE,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.02C5BE,ou=scopes,o=jans entry:{'description': ['Manage FIDO2 related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/fido2.write'], 'inum': ['1800.02C5BE'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/fido2.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.CC7D1C,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.CC7D1C,ou=scopes,o=jans entry:{'description': ['View attribute related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/attributes.readonly'], 'inum': ['1800.CC7D1C'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/attributes.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.5D52F6,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.5D52F6,ou=scopes,o=jans entry:{'description': ['Manage attribute related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/attributes.write'], 'inum': ['1800.5D52F6'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/attributes.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.3F631C,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.3F631C,ou=scopes,o=jans entry:{'description': ['Delete attribute related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/attributes.delete'], 'inum': ['1800.3F631C'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/attributes.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.576FA9,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.576FA9,ou=scopes,o=jans entry:{'description': ['View ACRS related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/acrs.readonly'], 'inum': ['1800.576FA9'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/acrs.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.14906B,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.14906B,ou=scopes,o=jans entry:{'description': ['Manage ACRS related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/acrs.write'], 'inum': ['1800.14906B'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/acrs.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.78E26D,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.78E26D,ou=scopes,o=jans entry:{'description': ['View LDAP database related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/ldap.readonly'], 'inum': ['1800.78E26D'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/ldap.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.0A40B5,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.0A40B5,ou=scopes,o=jans entry:{'description': ['Manage LDAP database related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/ldap.write'], 'inum': ['1800.0A40B5'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/ldap.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.36E9E2,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.36E9E2,ou=scopes,o=jans entry:{'description': ['Delete LDAP database related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/ldap.delete'], 'inum': ['1800.36E9E2'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/ldap.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.7434DD,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.7434DD,ou=scopes,o=jans entry:{'description': ['View Couchbase database information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/couchbase.readonly'], 'inum': ['1800.7434DD'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/couchbase.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.CCB907,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.CCB907,ou=scopes,o=jans entry:{'description': ['Manage Couchbase database related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/couchbase.write'], 'inum': ['1800.CCB907'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/couchbase.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.36EA8D,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.36EA8D,ou=scopes,o=jans entry:{'description': ['Delete Couchbase database related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/database/couchbase.delete'], 'inum': ['1800.36EA8D'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/database/couchbase.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.6E4537,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.6E4537,ou=scopes,o=jans entry:{'description': ['View cache scripts information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scripts.readonly'], 'inum': ['1800.6E4537'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scripts.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.6EAFBC,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.6EAFBC,ou=scopes,o=jans entry:{'description': ['Manage scripts related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scripts.write'], 'inum': ['1800.6EAFBC'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scripts.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.4D6C46,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.4D6C46,ou=scopes,o=jans entry:{'description': ['Delete scripts related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scripts.delete'], 'inum': ['1800.4D6C46'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scripts.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.160ED7,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.160ED7,ou=scopes,o=jans entry:{'description': ['View cache related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/cache.readonly'], 'inum': ['1800.160ED7'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/cache.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.70AEDC,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.70AEDC,ou=scopes,o=jans entry:{'description': ['Manage cache related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/cache.write'], 'inum': ['1800.70AEDC'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/cache.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.BF6E92,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.BF6E92,ou=scopes,o=jans entry:{'description': ['View SMTP related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/smtp.readonly'], 'inum': ['1800.BF6E92'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/smtp.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.DE2CE9,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.DE2CE9,ou=scopes,o=jans entry:{'description': ['Manage SMTP related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/smtp.write'], 'inum': ['1800.DE2CE9'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/smtp.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.AA88E9,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.AA88E9,ou=scopes,o=jans entry:{'description': ['Delete SMTP related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/smtp.delete'], 'inum': ['1800.AA88E9'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/smtp.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.0384AD,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.0384AD,ou=scopes,o=jans entry:{'description': ['View logging related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/logging.readonly'], 'inum': ['1800.0384AD'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/logging.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.F1A6B9,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.F1A6B9,ou=scopes,o=jans entry:{'description': ['Manage logging related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/logging.write'], 'inum': ['1800.F1A6B9'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/logging.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.0A9979,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.0A9979,ou=scopes,o=jans entry:{'description': ['View JWKS related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/jwks.readonly'], 'inum': ['1800.0A9979'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/jwks.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.AFE86F,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.AFE86F,ou=scopes,o=jans entry:{'description': ['Manage JWKS related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/jwks.write'], 'inum': ['1800.AFE86F'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/jwks.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.EFB0CC,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.EFB0CC,ou=scopes,o=jans entry:{'description': ['View clients related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/openid/clients.readonly'], 'inum': ['1800.EFB0CC'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/openid/clients.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.B61F69,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.B61F69,ou=scopes,o=jans entry:{'description': ['Manage clients related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/openid/clients.write'], 'inum': ['1800.B61F69'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/openid/clients.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:30 06/21/21 Querying LDAP for dn inum=1800.5E824B,ou=scopes,o=jans
11:35:30 06/21/21 Adding LDAP dn:inum=1800.5E824B,ou=scopes,o=jans entry:{'description': ['Delete clients related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/openid/clients.delete'], 'inum': ['1800.5E824B'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/openid/clients.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.EF8727,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.EF8727,ou=scopes,o=jans entry:{'description': ['View scope related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scopes.readonly'], 'inum': ['1800.EF8727'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scopes.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.E489B8,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.E489B8,ou=scopes,o=jans entry:{'description': ['Manage scope related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scopes.write'], 'inum': ['1800.E489B8'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scopes.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.610BA5,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.610BA5,ou=scopes,o=jans entry:{'description': ['Delete scope related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/scopes.delete'], 'inum': ['1800.610BA5'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/scopes.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.6731FB,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.6731FB,ou=scopes,o=jans entry:{'description': ['View UMA Resource related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/uma/resources.readonly'], 'inum': ['1800.6731FB'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/uma/resources.readonly'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.E4EBE7,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.E4EBE7,ou=scopes,o=jans entry:{'description': ['Manage UMA Resource related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/uma/resources.write'], 'inum': ['1800.E4EBE7'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/uma/resources.write'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Querying LDAP for dn inum=1800.0D8D8D,ou=scopes,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1800.0D8D8D,ou=scopes,o=jans entry:{'description': ['Delete UMA Resource related information'], 'displayName': ['Config API scope https://jans.io/oauth/config/uma/resources.delete'], 'inum': ['1800.0D8D8D'], 'jansAttrs': ['{"spontaneousClientId": null, "spontaneousClientScopes": [], "showInConfigurationEndpoint": false}'], 'jansDefScope': ['false'], 'jansId': ['https://jans.io/oauth/config/uma/resources.delete'], 'jansScopeTyp': ['oauth2'], 'objectclass': ['top', 'jansScope']}
11:35:31 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-config-api/clients.ldif
11:35:31 06/21/21 Querying LDAP for dn inum=1801.0e9613e2-804e-487b-9696-84bb8045b895,ou=clients,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1801.0e9613e2-804e-487b-9696-84bb8045b895,ou=clients,o=jans entry:{'del': ['false'], 'displayName': ['Jans Config Api Client'], 'inum': ['1801.0e9613e2-804e-487b-9696-84bb8045b895'], 'jansAccessTknAsJwt': ['false'], 'jansAccessTknSigAlg': ['RS256'], 'jansAppTyp': ['web'], 'jansAttrs': ['{"tlsClientAuthSubjectDn":"","runIntrospectionScriptBeforeAccessTokenAsJwtCreationAndIncludeClaims":false,"keepClientAuthorizationAfterExpiration":false,"allowSpontaneousScopes":false,"spontaneousScopes":[],"spontaneousScopeScriptDns":[],"backchannelLogoutUri":[],"backchannelLogoutSessionRequired":false,"additionalAudience":[],"postAuthnScripts":[],"consentGatheringScripts":[],"introspectionScripts":[],"rptClaimsScripts":[]}'], 'jansClntSecret': ['H2QjtLYwppD4HqzxpItG0A=='], 'jansDisabled': ['false'], 'jansGrantTyp': ['authorization_code', 'refresh_token', 'client_credentials'], 'jansIdTknSignedRespAlg': ['RS256'], 'jansInclClaimsInIdTkn': ['false'], 'jansLogoutSessRequired': ['false'], 'jansPersistClntAuthzs': ['true'], 'jansRedirectURI': ['https://test.dd.jans.io/admin-ui', 'http://localhost:4100'], 'jansRequireAuthTime': ['false'], 'jansRespTyp': ['code'], 'jansRptAsJwt': ['false'], 'jansScope': ['inum=1800.71CF52,ou=scopes,o=jans', 'inum=1800.23F516,ou=scopes,o=jans', 'inum=1800.B1125F,ou=scopes,o=jans', 'inum=1800.02C5BE,ou=scopes,o=jans', 'inum=1800.CC7D1C,ou=scopes,o=jans', 'inum=1800.5D52F6,ou=scopes,o=jans', 'inum=1800.3F631C,ou=scopes,o=jans', 'inum=1800.576FA9,ou=scopes,o=jans', 'inum=1800.14906B,ou=scopes,o=jans', 'inum=1800.78E26D,ou=scopes,o=jans', 'inum=1800.0A40B5,ou=scopes,o=jans', 'inum=1800.36E9E2,ou=scopes,o=jans', 'inum=1800.7434DD,ou=scopes,o=jans', 'inum=1800.CCB907,ou=scopes,o=jans', 'inum=1800.36EA8D,ou=scopes,o=jans', 'inum=1800.6E4537,ou=scopes,o=jans', 'inum=1800.6EAFBC,ou=scopes,o=jans', 'inum=1800.4D6C46,ou=scopes,o=jans', 'inum=1800.160ED7,ou=scopes,o=jans', 'inum=1800.70AEDC,ou=scopes,o=jans', 'inum=1800.BF6E92,ou=scopes,o=jans', 'inum=1800.DE2CE9,ou=scopes,o=jans', 'inum=1800.AA88E9,ou=scopes,o=jans', 'inum=1800.0384AD,ou=scopes,o=jans', 'inum=1800.F1A6B9,ou=scopes,o=jans', 'inum=1800.0A9979,ou=scopes,o=jans', 'inum=1800.AFE86F,ou=scopes,o=jans', 'inum=1800.EFB0CC,ou=scopes,o=jans', 'inum=1800.B61F69,ou=scopes,o=jans', 'inum=1800.5E824B,ou=scopes,o=jans', 'inum=1800.EF8727,ou=scopes,o=jans', 'inum=1800.E489B8,ou=scopes,o=jans', 'inum=1800.610BA5,ou=scopes,o=jans', 'inum=1800.6731FB,ou=scopes,o=jans', 'inum=1800.E4EBE7,ou=scopes,o=jans', 'inum=1800.0D8D8D,ou=scopes,o=jans'], 'jansSubjectTyp': ['pairwise'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['false'], 'objectClass': ['top', 'jansClnt']}
11:35:31 06/21/21 Checking ID for client jca_test_client_id
11:35:31 06/21/21 Searching database for dn ou=clients,o=jans with filter (&(inum=1802.*)(objectClass=jansClnt))
11:35:31 06/21/21 Client ID for jca_test_client_id was created as 1802.2786585a-a886-425a-b5c0-317ef4339179
11:35:31 06/21/21 Searching database for dn ou=scopes,o=jans with filter (&(inum=1800.*)(objectClass=jansScope))
11:35:31 06/21/21 Loding Jans Config Api test data
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/test/jans-config-api/data/jans-config-api.ldif
11:35:31 06/21/21 Writing file /opt/jans/jans-setup/output/jans-config-api/jans-config-api.ldif
11:35:31 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/jans-config-api/jans-config-api.ldif 
11:35:31 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-config-api/jans-config-api.ldif
11:35:31 06/21/21 Querying LDAP for dn inum=1802.2786585a-a886-425a-b5c0-317ef4339179,ou=clients,o=jans
11:35:31 06/21/21 Adding LDAP dn:inum=1802.2786585a-a886-425a-b5c0-317ef4339179,ou=clients,o=jans entry:{'objectClass': ['jansClnt', 'top'], 'del': ['FALSE'], 'displayName': ['Jans Config Api Client'], 'inum': ['1802.2786585a-a886-425a-b5c0-317ef4339179'], 'jansAccessTknAsJwt': ['FALSE'], 'jansAccessTknSigAlg': ['RS256'], 'jansAppTyp': ['web'], 'jansAttrs': ['{"tlsClientAuthSubjectDn":"","runIntrospectionScriptBeforeAccessTokenAsJwtCreationAndIncludeClaims":false,"keepClientAuthorizationAfterExpiration":false,"allowSpontaneousScopes":false,"spontaneousScopes":[],"spontaneousScopeScriptDns":[],"backchannelLogoutUri":[],"backchannelLogoutSessionRequired":false,"additionalAudience":[],"postAuthnScripts":[],"consentGatheringScripts":[],"introspectionScripts":[],"rptClaimsScripts":[]}'], 'jansClntSecret': ['JJvRQzjTnxeDoGA5iQ4+6g=='], 'jansDisabled': ['FALSE'], 'jansGrantTyp': ['authorization_code', 'client_credentials', 'refresh_token'], 'jansIdTknSignedRespAlg': ['RS256'], 'jansInclClaimsInIdTkn': ['FALSE'], 'jansLogoutSessRequired': ['FALSE'], 'jansPersistClntAuthzs': ['TRUE'], 'jansRequireAuthTime': ['FALSE'], 'jansRespTyp': ['code'], 'jansRptAsJwt': ['FALSE'], 'jansSubjectTyp': ['pairwise'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['FALSE'], 'jansScope': ['inum=1800.71CF52,ou=scopes,o=jans', 'inum=1800.23F516,ou=scopes,o=jans', 'inum=1800.B1125F,ou=scopes,o=jans', 'inum=1800.02C5BE,ou=scopes,o=jans', 'inum=1800.CC7D1C,ou=scopes,o=jans', 'inum=1800.5D52F6,ou=scopes,o=jans', 'inum=1800.3F631C,ou=scopes,o=jans', 'inum=1800.576FA9,ou=scopes,o=jans', 'inum=1800.14906B,ou=scopes,o=jans', 'inum=1800.78E26D,ou=scopes,o=jans', 'inum=1800.0A40B5,ou=scopes,o=jans', 'inum=1800.36E9E2,ou=scopes,o=jans', 'inum=1800.7434DD,ou=scopes,o=jans', 'inum=1800.CCB907,ou=scopes,o=jans', 'inum=1800.36EA8D,ou=scopes,o=jans', 'inum=1800.6E4537,ou=scopes,o=jans', 'inum=1800.6EAFBC,ou=scopes,o=jans', 'inum=1800.4D6C46,ou=scopes,o=jans', 'inum=1800.160ED7,ou=scopes,o=jans', 'inum=1800.70AEDC,ou=scopes,o=jans', 'inum=1800.BF6E92,ou=scopes,o=jans', 'inum=1800.DE2CE9,ou=scopes,o=jans', 'inum=1800.AA88E9,ou=scopes,o=jans', 'inum=1800.0384AD,ou=scopes,o=jans', 'inum=1800.F1A6B9,ou=scopes,o=jans', 'inum=1800.0A9979,ou=scopes,o=jans', 'inum=1800.AFE86F,ou=scopes,o=jans', 'inum=1800.EFB0CC,ou=scopes,o=jans', 'inum=1800.B61F69,ou=scopes,o=jans', 'inum=1800.5E824B,ou=scopes,o=jans', 'inum=1800.EF8727,ou=scopes,o=jans', 'inum=1800.E489B8,ou=scopes,o=jans', 'inum=1800.610BA5,ou=scopes,o=jans', 'inum=1800.6731FB,ou=scopes,o=jans', 'inum=1800.E4EBE7,ou=scopes,o=jans', 'inum=1800.0D8D8D,ou=scopes,o=jans']}
11:35:31 06/21/21 Installing Jans-Fido2
11:35:31 06/21/21 Bind to database
11:35:31 06/21/21 Running: /bin/mkdir -p /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Running: /bin/mkdir -p /etc/jans/conf/fido2/mds/cert
11:35:31 06/21/21 Running: /bin/mkdir -p /etc/jans/conf/fido2/mds/toc
11:35:31 06/21/21 Running: /bin/mkdir -p /etc/jans/conf/fido2/server_metadata
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/system/systemd/jans-fido2.service to /etc/systemd/system
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/system/systemd/jans-fido2.service to /etc/systemd/system
11:35:31 06/21/21 Installing jetty service jans-fido2...
11:35:31 06/21/21 Preparing jans-fido2 service base folders
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2/custom
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2/custom/pages
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2/custom/i18n
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2/custom/static
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-fido2/custom/libs
11:35:31 06/21/21 Preparing jans-fido2 service base configuration
11:35:31 06/21/21 Running: /opt/jre/bin/java -jar /opt/jetty/start.jar jetty.home=/opt/jetty jetty.base=/opt/jans/jetty/jans-fido2 --add-to-start=server,deploy,resources,http,http-forwarded,threadpool,console-capture,jsp
11:35:31 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jetty/jans-fido2
11:35:31 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-fido2
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-fido2
11:35:31 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-fido2
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-fido2 to /etc/default
11:35:31 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-fido2 to /etc/default
11:35:31 06/21/21 Running: /bin/chown root:root /etc/default/jans-fido2
11:35:31 06/21/21 Running: /bin/chmod +x /opt/dist/scripts/jans-fido2
11:35:31 06/21/21 Creating 'jetty.conf' tmpfiles daemon file
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:31 06/21/21 Copied /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:31 06/21/21 Running: /bin/chown root:root /usr/lib/tmpfiles.d/jetty.conf
11:35:31 06/21/21 Running: /bin/chmod 644 /usr/lib/tmpfiles.d/jetty.conf
11:35:31 06/21/21 Copying file /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-fido2
11:35:31 06/21/21 Copied /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-fido2
11:35:31 06/21/21 Seeting jetty parameter jetty.httpConfig.sendServerVersion=false for service jans-fido2
11:35:31 06/21/21 Reading file /opt/jans/jetty/jans-fido2/start.ini
11:35:31 06/21/21 Writing file /opt/jans/jetty/jans-fido2/start.ini
11:35:31 06/21/21 Running: cp -f /opt/jans/jetty/jans-fido2/start.ini /opt/jans/jetty/jans-fido2/start.ini.jans-1.0.0-1~
11:35:31 06/21/21 Copying fido.war into jetty webapps folder...
11:35:31 06/21/21 Copying file /opt/dist/jans/jans-fido2.war to /opt/jans/jetty/jans-fido2/webapps
11:35:31 06/21/21 Copied /opt/dist/jans/jans-fido2.war to /opt/jans/jetty/jans-fido2/webapps
11:35:31 06/21/21 Running: /usr/bin/systemctl enable jans-fido2
11:35:31 06/21/21 Run: /usr/bin/systemctl enable jans-fido2 with result code: 0
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/fido2/authenticator_cert/yubico-u2f-ca-cert.crt to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/fido2/authenticator_cert/yubico-u2f-ca-cert.crt to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/fido2/authenticator_cert/HyperFIDO_CA_Cert_V1.pem to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/fido2/authenticator_cert/HyperFIDO_CA_Cert_V1.pem to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/fido2/authenticator_cert/HyperFIDO_CA_Cert_V2.pem to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/fido2/authenticator_cert/HyperFIDO_CA_Cert_V2.pem to /etc/jans/conf/fido2/authenticator_cert
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/fido2/mds_toc_cert/metadata-root-ca.cer to /etc/jans/conf/fido2/mds/cert
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/fido2/mds_toc_cert/metadata-root-ca.cer to /etc/jans/conf/fido2/mds/cert
11:35:31 06/21/21 Copied tree /opt/jans/jans-setup/static/auth/fido2/server_metadata to /etc/jans/conf/fido2/server_metadata
11:35:31 06/21/21 Running: /bin/mkdir -p /etc/jans/conf/fido2/apple
11:35:31 06/21/21 Copying file /opt/dist/app/Apple_WebAuthn_Root_CA.pem to /etc/jans/conf/fido2/apple
11:35:31 06/21/21 Copied /opt/dist/app/Apple_WebAuthn_Root_CA.pem to /etc/jans/conf/fido2/apple
11:35:31 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-fido2/dynamic-conf.json
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-fido2/dynamic-conf.json
11:35:31 06/21/21 Writing file /opt/jans/jans-setup/output/jans-fido2/dynamic-conf.json
11:35:31 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-fido2/static-conf.json
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-fido2/static-conf.json
11:35:31 06/21/21 Writing file /opt/jans/jans-setup/output/jans-fido2/static-conf.json
11:35:31 06/21/21 Loading file /opt/jans/jans-setup/output/jans-fido2/dynamic-conf.json
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/output/jans-fido2/dynamic-conf.json
11:35:31 06/21/21 Loading file /opt/jans/jans-setup/output/jans-fido2/static-conf.json
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/output/jans-fido2/static-conf.json
11:35:31 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-fido2/fido2.ldif
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-fido2/fido2.ldif
11:35:31 06/21/21 Writing file /opt/jans/jans-setup/output/jans-fido2/fido2.ldif
11:35:31 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-app.xml
11:35:31 06/21/21 Writing file /opt/jans/jetty/jans-fido2/webapps/jans-fido2.xml
11:35:31 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/jans-fido2/fido2.ldif 
11:35:31 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-fido2/fido2.ldif
11:35:31 06/21/21 Querying LDAP for dn ou=jans-fido2,ou=configuration,o=jans
11:35:31 06/21/21 Adding LDAP dn:ou=jans-fido2,ou=configuration,o=jans entry:{'jansConfDyn': ['{\n   "issuer":"https://test.dd.jans.io",\n   "baseEndpoint":"https://test.dd.jans.io/fido2/restv1",\n   "cleanServiceInterval":60,\n   "cleanServiceBatchChunkSize":10000,\n   "useLocalCache":true,\n   "disableJdkLogger":true,\n   "loggingLevel":"INFO",\n   "loggingLayout":"text",\n   "externalLoggerConfiguration":"",\n   "metricReporterInterval":300,\n   "metricReporterKeepDataDays":15,\n   "metricReporterEnabled":true,\n   "personCustomObjectClassList":[\n      "jansCustomPerson",\n      "jansPerson"\n   ],\n   "fido2Configuration":{\n      "authenticatorCertsFolder":"/etc/jans/conf/fido2/authenticator_cert",\n      "mdsCertsFolder":"/etc/jans/conf/fido2/mds/cert",\n      "mdsTocsFolder":"/etc/jans/conf/fido2/mds/toc",\n      "serverMetadataFolder":"/etc/jans/conf/fido2/server_metadata",\n      "requestedCredentialTypes":[\n         "RS256",\n         "ES256"\n      ],\n      "requestedParties":[\n         {\n            "name":"https://test.dd.jans.io",\n            "domains":[\n               "test.dd.jans.io"\n            ]\n         }\n      ],\n      "userAutoEnrollment":false,\n      "unfinishedRequestExpiration":180,\n      "authenticationHistoryExpiration":1296000\n   }\n}'], 'jansConfStatic': ['{\n    "baseDn":{\n        "configuration":"ou=configuration,o=jans",\n        "people":"ou=people,o=jans",\n        "scripts": "ou=scripts,o=jans",\n        "metric":"ou=statistic,o=metric",\n        "sessions":"ou=sessions,o=jans"\n    }\n}\n'], 'jansRevision': ['1'], 'objectClass': ['top', 'jansAppConf'], 'ou': ['fido2']}
11:35:31 06/21/21 Installing Jans-Scim
11:35:31 06/21/21 Bind to database
11:35:31 06/21/21 Created dir: /opt/jans/jans-setup/output/jans-scim
11:35:31 06/21/21 Copying file /opt/jans/jans-setup/static/system/systemd/jans-scim.service to /etc/systemd/system
11:35:31 06/21/21 Copied /opt/jans/jans-setup/static/system/systemd/jans-scim.service to /etc/systemd/system
11:35:31 06/21/21 Copying scim.war into jetty webapps folder...
11:35:31 06/21/21 Installing jetty service jans-scim...
11:35:31 06/21/21 Preparing jans-scim service base folders
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim/custom
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim/custom/pages
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim/custom/i18n
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim/custom/static
11:35:31 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-scim/custom/libs
11:35:31 06/21/21 Preparing jans-scim service base configuration
11:35:31 06/21/21 Running: /opt/jre/bin/java -jar /opt/jetty/start.jar jetty.home=/opt/jetty jetty.base=/opt/jans/jetty/jans-scim --add-to-start=server,deploy,resources,http,http-forwarded,console-capture,jsp,websocket
11:35:32 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jetty/jans-scim
11:35:32 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-scim
11:35:32 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-scim
11:35:32 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-scim
11:35:32 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-scim to /etc/default
11:35:32 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-scim to /etc/default
11:35:32 06/21/21 Running: /bin/chown root:root /etc/default/jans-scim
11:35:32 06/21/21 Running: /bin/chmod +x /opt/dist/scripts/jans-scim
11:35:32 06/21/21 Creating 'jetty.conf' tmpfiles daemon file
11:35:32 06/21/21 Copying file /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:32 06/21/21 Copied /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:32 06/21/21 Running: /bin/chown root:root /usr/lib/tmpfiles.d/jetty.conf
11:35:32 06/21/21 Running: /bin/chmod 644 /usr/lib/tmpfiles.d/jetty.conf
11:35:32 06/21/21 Copying file /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-scim
11:35:32 06/21/21 Copied /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-scim
11:35:32 06/21/21 Seeting jetty parameter jetty.httpConfig.sendServerVersion=false for service jans-scim
11:35:32 06/21/21 Reading file /opt/jans/jetty/jans-scim/start.ini
11:35:32 06/21/21 Writing file /opt/jans/jetty/jans-scim/start.ini
11:35:32 06/21/21 Running: cp -f /opt/jans/jetty/jans-scim/start.ini /opt/jans/jetty/jans-scim/start.ini.jans-1.0.0-1~
11:35:32 06/21/21 Copying file /opt/dist/jans/jans-scim.war to /opt/jans/jetty/jans-scim/webapps
11:35:32 06/21/21 Copied /opt/dist/jans/jans-scim.war to /opt/jans/jetty/jans-scim/webapps
11:35:32 06/21/21 Running: /usr/bin/systemctl enable jans-scim
11:35:32 06/21/21 Run: /usr/bin/systemctl enable jans-scim with result code: 0
11:35:32 06/21/21 Generating jans-scim configuration
11:35:32 06/21/21 Reading file /opt/jans/jans-setup/setup_app/data/jans-scim-openapi.yaml
11:35:33 06/21/21 Checking ID for client scim_client_id
11:35:33 06/21/21 Searching database for dn ou=clients,o=jans with filter (&(inum=1201.*)(objectClass=jansClnt))
11:35:33 06/21/21 Client ID for scim_client_id was created as 1201.d1ec48fa-6302-4142-a560-25f2c8cd5b5b
11:35:33 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-scim/dynamic-conf.json
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-scim/dynamic-conf.json
11:35:33 06/21/21 Writing file /opt/jans/jans-setup/output/jans-scim/dynamic-conf.json
11:35:33 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-scim/static-conf.json
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-scim/static-conf.json
11:35:33 06/21/21 Writing file /opt/jans/jans-setup/output/jans-scim/static-conf.json
11:35:33 06/21/21 Loading file /opt/jans/jans-setup/output/jans-scim/dynamic-conf.json
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/output/jans-scim/dynamic-conf.json
11:35:33 06/21/21 Loading file /opt/jans/jans-setup/output/jans-scim/static-conf.json
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/output/jans-scim/static-conf.json
11:35:33 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-scim/configuration.ldif
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-scim/configuration.ldif
11:35:33 06/21/21 Writing file /opt/jans/jans-setup/output/jans-scim/configuration.ldif
11:35:33 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/jans-scim/configuration.ldif, /opt/jans/jans-setup/output/jans-scim/scopes.ldif, /opt/jans/jans-setup/output/jans-scim/clients.ldif 
11:35:33 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-scim/configuration.ldif
11:35:33 06/21/21 Querying LDAP for dn ou=jans-scim,ou=configuration,o=jans
11:35:33 06/21/21 Adding LDAP dn:ou=jans-scim,ou=configuration,o=jans entry:{'jansConfDyn': ['{\n    "baseDN":"o=jans",\n\n    "applicationUrl":"https://test.dd.jans.io",\n    "baseEndpoint":"https://test.dd.jans.io/jans-scim/restv1",\n\n    "personCustomObjectClass":"jansCustomPerson",\n\n    "oxAuthIssuer":"https://test.dd.jans.io",\n    "umaIssuer":"https://test.dd.jans.io",\n\n    "scimUmaClientKeyId":"",\n\n    "rptConnectionPoolUseConnectionPooling":true,\n    "rptConnectionPoolMaxTotal":200,\n    "rptConnectionPoolDefaultMaxPerRoute":20,\n    "rptConnectionPoolValidateAfterInactivity":10,\n    "rptConnectionPoolCustomKeepAliveTimeout":5,\n    "maxCount": 200,\n\n    "useLocalCache":true,\n\n    "disableJdkLogger":true,\n    "loggingLevel":"INFO",\n    "loggingLayout":"text",\n    "externalLoggerConfiguration":"",\n\n    "metricReporterInterval":300,\n    "metricReporterKeepDataDays":15,\n    "metricReporterEnabled":true\n}\n'], 'jansConfStatic': ['{\n    "baseDn":{\n        "configuration":"ou=configuration,o=jans",\n        "people":"ou=people,o=jans",\n        "scripts": "ou=scripts,o=jans",\n        "metric":"ou=statistic,o=metric"\n    }\n}\n'], 'jansRevision': ['1'], 'objectClass': ['top', 'jansAppConf'], 'ou': ['scim']}
11:35:33 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-scim/scopes.ldif
11:35:33 06/21/21 Querying LDAP for dn inum=1200.5BF072,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.5BF072,ou=scopes,o=jans entry:{'description': ['Query user resources'], 'displayName': ['Scim users.read'], 'inum': ['1200.5BF072'], 'jansId': ['https://jans.io/scim/users.read'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.A3B561,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.A3B561,ou=scopes,o=jans entry:{'description': ['Modify user resources'], 'displayName': ['Scim users.write'], 'inum': ['1200.A3B561'], 'jansId': ['https://jans.io/scim/users.write'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.4E2CEA,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.4E2CEA,ou=scopes,o=jans entry:{'description': ['Query group resources'], 'displayName': ['Scim groups.read'], 'inum': ['1200.4E2CEA'], 'jansId': ['https://jans.io/scim/groups.read'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.2E5EB3,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.2E5EB3,ou=scopes,o=jans entry:{'description': ['Modify group resources'], 'displayName': ['Scim groups.write'], 'inum': ['1200.2E5EB3'], 'jansId': ['https://jans.io/scim/groups.write'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.DCDD0B,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.DCDD0B,ou=scopes,o=jans entry:{'description': ['Query fido resources'], 'displayName': ['Scim fido.read'], 'inum': ['1200.DCDD0B'], 'jansId': ['https://jans.io/scim/fido.read'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.E970DB,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.E970DB,ou=scopes,o=jans entry:{'description': ['Modify fido resources'], 'displayName': ['Scim fido.write'], 'inum': ['1200.E970DB'], 'jansId': ['https://jans.io/scim/fido.write'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.7EEE68,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.7EEE68,ou=scopes,o=jans entry:{'description': ['Query fido 2 resources'], 'displayName': ['Scim fido2.read'], 'inum': ['1200.7EEE68'], 'jansId': ['https://jans.io/scim/fido2.read'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.913068,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.913068,ou=scopes,o=jans entry:{'description': ['Modify fido 2 resources'], 'displayName': ['Scim fido2.write'], 'inum': ['1200.913068'], 'jansId': ['https://jans.io/scim/fido2.write'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.C29A1B,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.C29A1B,ou=scopes,o=jans entry:{'description': ['Access the root .search endpoint'], 'displayName': ['Scim all-resources.search'], 'inum': ['1200.C29A1B'], 'jansId': ['https://jans.io/scim/all-resources.search'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Querying LDAP for dn inum=1200.A31CFE,ou=scopes,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1200.A31CFE,ou=scopes,o=jans entry:{'description': ['Send requests to the bulk endpoint'], 'displayName': ['Scim bulk'], 'inum': ['1200.A31CFE'], 'jansId': ['https://jans.io/scim/bulk'], 'jansScopeTyp': ['oauth'], 'objectclass': ['top', 'jansScope']}
11:35:33 06/21/21 Importing entries from /opt/jans/jans-setup/output/jans-scim/clients.ldif
11:35:33 06/21/21 Querying LDAP for dn inum=1201.d1ec48fa-6302-4142-a560-25f2c8cd5b5b,ou=clients,o=jans
11:35:33 06/21/21 Adding LDAP dn:inum=1201.d1ec48fa-6302-4142-a560-25f2c8cd5b5b,ou=clients,o=jans entry:{'displayName': ['SCIM client'], 'inum': ['1201.d1ec48fa-6302-4142-a560-25f2c8cd5b5b'], 'jansAccessTknSigAlg': ['RS256'], 'jansAppTyp': ['native'], 'jansAttrs': ['{}'], 'jansClntSecret': ['2nsNrzJPRpgaWD6HB2vs0A=='], 'jansGrantTyp': ['client_credentials'], 'jansScope': ['inum=1200.5BF072,ou=scopes,o=jans', 'inum=1200.A3B561,ou=scopes,o=jans', 'inum=1200.4E2CEA,ou=scopes,o=jans', 'inum=1200.2E5EB3,ou=scopes,o=jans', 'inum=1200.DCDD0B,ou=scopes,o=jans', 'inum=1200.E970DB,ou=scopes,o=jans', 'inum=1200.7EEE68,ou=scopes,o=jans', 'inum=1200.913068,ou=scopes,o=jans', 'inum=1200.C29A1B,ou=scopes,o=jans', 'inum=1200.A31CFE,ou=scopes,o=jans'], 'jansSubjectTyp': ['pairwise'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'objectClass': ['top', 'jansClnt']}
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-app.xml
11:35:33 06/21/21 Writing file /opt/jans/jetty/jans-scim/webapps/jans-scim.xml
11:35:33 06/21/21 Installing Jans-Eleven
11:35:33 06/21/21 Bind to database
11:35:33 06/21/21 Copying file /opt/jans/jans-setup/static/system/systemd/jans-eleven.service to /etc/systemd/system
11:35:33 06/21/21 Copied /opt/jans/jans-setup/static/system/systemd/jans-eleven.service to /etc/systemd/system
11:35:33 06/21/21 Installing softhsm
11:35:33 06/21/21 Installing jetty service jans-eleven...
11:35:33 06/21/21 Preparing jans-eleven service base folders
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven/custom
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven/custom/pages
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven/custom/i18n
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven/custom/static
11:35:33 06/21/21 Running: /bin/mkdir -p /opt/jans/jetty/jans-eleven/custom/libs
11:35:33 06/21/21 Preparing jans-eleven service base configuration
11:35:33 06/21/21 Running: /opt/jre/bin/java -jar /opt/jetty/start.jar jetty.home=/opt/jetty jetty.base=/opt/jans/jetty/jans-eleven --add-to-start=server,deploy,resources,http,http-forwarded,console-capture,jsp,websocket
11:35:33 06/21/21 Running: /bin/chown -R jetty:jetty /opt/jans/jetty/jans-eleven
11:35:33 06/21/21 Rendering template /opt/jans/jans-setup/templates/jetty/jans-eleven
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jetty/jans-eleven
11:35:33 06/21/21 Writing file /opt/jans/jans-setup/output/jetty/jans-eleven
11:35:33 06/21/21 Copying file /opt/jans/jans-setup/output/jetty/jans-eleven to /etc/default
11:35:33 06/21/21 Copied /opt/jans/jans-setup/output/jetty/jans-eleven to /etc/default
11:35:33 06/21/21 Running: /bin/chown root:root /etc/default/jans-eleven
11:35:33 06/21/21 Running: /bin/chmod +x /opt/dist/scripts/jans-eleven
11:35:33 06/21/21 Creating 'jetty.conf' tmpfiles daemon file
11:35:33 06/21/21 Copying file /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:33 06/21/21 Copied /opt/jans/jans-setup/templates/jetty.conf.tmpfiles.d to /usr/lib/tmpfiles.d/jetty.conf
11:35:33 06/21/21 Running: /bin/chown root:root /usr/lib/tmpfiles.d/jetty.conf
11:35:33 06/21/21 Running: /bin/chmod 644 /usr/lib/tmpfiles.d/jetty.conf
11:35:33 06/21/21 Copying file /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-eleven
11:35:33 06/21/21 Copied /opt/jetty/bin/jetty.sh to /opt/dist/app/jans-eleven
11:35:33 06/21/21 Seeting jetty parameter jetty.httpConfig.sendServerVersion=false for service jans-eleven
11:35:33 06/21/21 Reading file /opt/jans/jetty/jans-eleven/start.ini
11:35:33 06/21/21 Writing file /opt/jans/jetty/jans-eleven/start.ini
11:35:33 06/21/21 Running: cp -f /opt/jans/jetty/jans-eleven/start.ini /opt/jans/jetty/jans-eleven/start.ini.jans-1.0.0-1~
11:35:33 06/21/21 Copying /opt/dist/jans/jans-eleven.war into jetty webapps folder...
11:35:33 06/21/21 Copying file /opt/dist/jans/jans-eleven.war to /opt/jans/jetty/jans-eleven/webapps
11:35:33 06/21/21 Copied /opt/dist/jans/jans-eleven.war to /opt/jans/jetty/jans-eleven/webapps
11:35:33 06/21/21 Running: /usr/bin/systemctl enable jans-eleven
11:35:33 06/21/21 Run: /usr/bin/systemctl enable jans-eleven with result code: 0
11:35:33 06/21/21 Rendering template /opt/jans/jans-setup/templates/jans-eleven/jans-eleven.json
11:35:33 06/21/21 Reading file /opt/jans/jans-setup/templates/jans-eleven/jans-eleven.json
11:35:33 06/21/21 Writing file /opt/jans/jans-setup/output/jans-eleven/jans-eleven.json
11:35:33 06/21/21 Copying file /opt/jans/jans-setup/output/jans-eleven/jans-eleven.json to /etc/jans/conf
11:35:33 06/21/21 Copied /opt/jans/jans-setup/output/jans-eleven/jans-eleven.json to /etc/jans/conf
11:35:33 06/21/21 Installing Jans-Cli
11:35:33 06/21/21 Installing Jans Cli
11:35:33 06/21/21 Running: /bin/ln -s /opt/jans/jans-cli/config_cli.py /opt/jans/jans-cli/config-cli.py
11:35:33 06/21/21 Running: /bin/ln -s /opt/jans/jans-cli/config_cli.py /opt/jans/jans-cli/scim-cli.py
11:35:33 06/21/21 Running: /bin/chmod +x /opt/jans/jans-cli/config_cli.py
11:35:33 06/21/21 Saving properties to /opt/jans/jans-setup/setup.properties.last
11:35:36 06/21/21 Running: /usr/bin/systemctl stop opendj
11:35:38 06/21/21 Run: /usr/bin/systemctl stop opendj with result code: 0
11:35:38 06/21/21 Running: /usr/bin/systemctl start opendj
11:35:43 06/21/21 Run: /usr/bin/systemctl start opendj with result code: 0
11:35:43 06/21/21 Running: /bin/chown -R jetty:root /etc/certs
11:35:43 06/21/21 Running: /bin/chmod -R 660 /etc/certs
11:35:43 06/21/21 Running: /bin/chmod u+X /etc/certs
11:35:43 06/21/21 Running: /usr/bin/systemctl stop cron
11:35:43 06/21/21 Run: /usr/bin/systemctl stop cron with result code: 0
11:35:43 06/21/21 Running: /usr/bin/systemctl start cron
11:35:43 06/21/21 Run: /usr/bin/systemctl start cron with result code: 0
11:35:45 06/21/21 Running: /usr/bin/systemctl stop opendj
11:35:48 06/21/21 Run: /usr/bin/systemctl stop opendj with result code: 0
11:35:48 06/21/21 Running: /usr/bin/systemctl start opendj
11:35:53 06/21/21 Run: /usr/bin/systemctl start opendj with result code: 0
11:35:55 06/21/21 Running: /usr/bin/systemctl stop apache2
11:35:55 06/21/21 Run: /usr/bin/systemctl stop apache2 with result code: 0
11:35:55 06/21/21 Running: /usr/bin/systemctl start apache2
11:35:55 06/21/21 Run: /usr/bin/systemctl start apache2 with result code: 0
11:35:57 06/21/21 Running: /usr/bin/systemctl stop jans-auth
11:35:57 06/21/21 Run: /usr/bin/systemctl stop jans-auth with result code: 0
11:35:57 06/21/21 Running: /usr/bin/systemctl start jans-auth
11:36:13 06/21/21 Run: /usr/bin/systemctl start jans-auth with result code: 0
11:36:15 06/21/21 Running: /usr/bin/systemctl stop jans-config-api
11:36:16 06/21/21 Run: /usr/bin/systemctl stop jans-config-api with result code: 0
11:36:16 06/21/21 Running: /usr/bin/systemctl start jans-config-api
11:36:16 06/21/21 Run: /usr/bin/systemctl start jans-config-api with result code: 0
11:36:18 06/21/21 Running: /usr/bin/systemctl stop jans-fido2
11:36:18 06/21/21 Run: /usr/bin/systemctl stop jans-fido2 with result code: 0
11:36:18 06/21/21 Running: /usr/bin/systemctl start jans-fido2
11:36:30 06/21/21 Run: /usr/bin/systemctl start jans-fido2 with result code: 0
11:36:32 06/21/21 Running: /usr/bin/systemctl stop jans-scim
11:36:32 06/21/21 Run: /usr/bin/systemctl stop jans-scim with result code: 0
11:36:32 06/21/21 Running: /usr/bin/systemctl start jans-scim
11:36:44 06/21/21 Run: /usr/bin/systemctl start jans-scim with result code: 0
11:36:46 06/21/21 Running: /usr/bin/systemctl stop jans-eleven
11:36:46 06/21/21 Run: /usr/bin/systemctl stop jans-eleven with result code: 0
11:36:46 06/21/21 Running: /usr/bin/systemctl start jans-eleven
11:36:50 06/21/21 Run: /usr/bin/systemctl start jans-eleven with result code: 0

#### start test data load

11:36:50 06/21/21 Loading test data
11:36:50 06/21/21 Re-binding database
11:36:50 06/21/21 Bind to database
11:36:50 06/21/21 Making LDAP Conncetion
11:36:50 06/21/21 Making LDAP Connection to host localhost:1636 with user cn=directory manager
11:36:50 06/21/21 Checking Internet conncetion
11:36:50 06/21/21 Encoding test passwords
11:36:50 06/21/21 Rendering test templates
11:36:50 06/21/21 Reading file /opt/jans/jans-setup/templates/test/jans-auth/server/config-oxauth-test-ldap.properties.nrnd
11:36:50 06/21/21 Writing file /opt/jans/jans-setup/output/test/jans-auth/server/config-oxauth-test.properties
11:36:50 06/21/21 Running: /bin/mkdir -p /opt/jans/jans-setup/output/test/jans-auth/server
11:36:50 06/21/21 Rendering templates folder: /opt/jans/jans-setup/templates/test
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/docs/oxauth-config-update.md
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/docs/oxauth-config-update.md
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/scim-client/client/config-scim-test.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/scim-client/client/config-scim-test.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/scim-client/data/scim-test-data-user.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data-user.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/scim-client/data/scim-test-data.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/scim-client/schema/scim_test_manual_update.schema
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/scim-client/schema/scim_test_manual_update.schema
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/scim-client/schema/103-scim_test.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/scim-client/schema/103-scim_test.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-config-api/client/config-api-server.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-config-api/client/config-api-server.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-config-api/client/config-api-test.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-config-api/client/config-api-test.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-config-api/data/jans-config-api.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-config-api/data/jans-config-api.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/client/config-oxauth-test-data.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/client/config-oxauth-test-data.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/data/oxauth-test-data.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/data/oxauth-test-data-user.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data-user.ldif
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/server/config-build.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/server/config-build.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/server/config-oxauth-test-data.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/server/config-oxauth-test-data.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/server/config-oxauth.properties
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/server/config-oxauth.properties
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/schema/oxauth_index.txt
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/schema/oxauth_index.txt
11:36:50 06/21/21 Rendering template /opt/jans/jans-setup/templates/test/jans-auth/schema/102-oxauth_test.ldif
11:36:50 06/21/21 Writing rendered template /opt/jans/jans-setup/output/test/jans-auth/schema/102-oxauth_test.ldif
11:36:50 06/21/21 Loading test ldif files
11:36:50 06/21/21 Importing ldif file(s): /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data.ldif, /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data.ldif, /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data-user.ldif, /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data-user.ldif 
11:36:50 06/21/21 Importing entries from /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data.ldif
11:36:50 06/21/21 Querying LDAP for dn inum=18CC,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=18CC,ou=attributes,o=jans entry:{'description': ['Jans Client Application Type'], 'displayName': ['Jans Client Application Type'], 'inum': ['18CC'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansAppTyp'], 'jansAttrOrigin': ['jansClnt'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansClaimName': ['jansAppType'], 'jansStatus': ['active'], 'objectClass': ['jansAttr', 'top'], 'urn': ['urn:jans:dir:attribute-def:jansAppTyp']}
11:36:50 06/21/21 Querying LDAP for dn inum=18CD,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=18CD,ou=attributes,o=jans entry:{'description': ['Jans Client ID Token Signed Response Algorithm'], 'displayName': ['Jans Client ID Token Signed Response Algorithm'], 'inum': ['18CD'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansIdTknSignedRespAlg'], 'jansAttrOrigin': ['jansClnt'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansClaimName': ['jansIdTknSignedRespAlg'], 'jansStatus': ['active'], 'objectClass': ['jansAttr', 'top'], 'urn': ['urn:jans:dir:attribute-def:jansIdTknSignedRespAlg']}
11:36:50 06/21/21 Querying LDAP for dn inum=18CE,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=18CE,ou=attributes,o=jans entry:{'description': ['Jans Client Redirect URI'], 'displayName': ['Jans Client Redirect URI'], 'inum': ['18CE'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansRedirectURI'], 'jansAttrOrigin': ['jansClnt'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansClaimName': ['jansRedirectURI'], 'jansStatus': ['active'], 'objectClass': ['jansAttr', 'top'], 'urn': ['urn:jans:dir:attribute-def:jansRedirectURI']}
11:36:50 06/21/21 Querying LDAP for dn inum=18CF,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=18CF,ou=attributes,o=jans entry:{'description': ['Jans Client Scope'], 'displayName': ['Jans Client Scope'], 'inum': ['18CF'], 'jansAttrEditTyp': ['admin'], 'jansAttrName': ['jansScope'], 'jansAttrOrigin': ['jansClnt'], 'jansAttrTyp': ['string'], 'jansAttrViewTyp': ['admin', 'user'], 'jansClaimName': ['jansScope'], 'jansStatus': ['active'], 'objectClass': ['jansAttr', 'top'], 'urn': ['urn:jans:dir:attribute-def:jansScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=6609,ou=attributes,o=jans entry:{'changetype': ['modify'], 'jansStatus': ['active'], 'replace': ['jansStatus']}
11:36:50 06/21/21 LDAP modify replace dn:inum=43F1,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=764C,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=C17A,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=D491,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=341A,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify replace dn:inum=10B2,ou=scopes,o=jans entry:{'changetype': ['modify'], 'jansDefScope': ['true'], 'replace': ['jansDefScope']}
11:36:50 06/21/21 LDAP modify add dn:inum=341A,ou=scopes,o=jans entry:{'changetype': ['modify'], 'add': ['jansClaim'], 'jansClaim': ['inum=18CF,ou=attributes,o=jans', 'inum=18CC,ou=attributes,o=jans', 'inum=18CD,ou=attributes,o=jans', 'inum=18CE,ou=attributes,o=jans']}
11:36:50 06/21/21 Querying LDAP for dn inum=7D01,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=7D01,ou=scopes,o=jans entry:{'description': ['Dynamic scope org_name'], 'inum': ['7D01'], 'jansDefScope': ['true'], 'jansId': ['org_name'], 'jansScopeTyp': ['dynamic'], 'jansScrDn': ['inum=031C-5621,ou=scripts,o=jans'], 'objectClass': ['top', 'jansScope']}
11:36:50 06/21/21 Querying LDAP for dn inum=7D02,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=7D02,ou=scopes,o=jans entry:{'description': ['Dynamic scope work_phone'], 'inum': ['7D02'], 'jansDefScope': ['true'], 'jansId': ['work_phone'], 'jansScopeTyp': ['dynamic'], 'jansScrDn': ['inum=031C-5622,ou=scripts,o=jans'], 'objectClass': ['top', 'jansScope']}
11:36:50 06/21/21 Querying LDAP for dn inum=0465-1DEA,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=0465-1DEA,ou=scopes,o=jans entry:{'description': ['Custom scope for tests'], 'inum': ['@DBE5-84F8-631A-9172CD07-49BE0465-1DEA'], 'jansClaim': ['inum=D2E0,ou=attributes,o=jans'], 'jansDefScope': ['true'], 'jansId': ['test'], 'jansScopeTyp': ['openid'], 'objectClass': ['jansScope', 'top']}
11:36:50 06/21/21 Querying LDAP for dn inum=FF81-2D39,ou=clients,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=FF81-2D39,ou=clients,o=jans entry:{'displayName': ["Jans Test Client (don't remove)"], 'inum': ['FF81-2D39'], 'jansAppTyp': ['web'], 'jansClaimRedirectURI': ['https://test.dd.jans.io/jans-auth/restv1/uma/gather_claims'], 'jansClntSecret': ['/jQfeEF4+BK2c2YYy1Ig+A=='], 'jansGrantTyp': ['authorization_code', 'implicit', 'refresh_token', 'client_credentials'], 'jansIdTknSignedRespAlg': ['RS256'], 'jansRedirectURI': ['https://test.dd.jans.io/jans-auth-rp/home.htm', 'https://client.example.com/cb', 'https://client.example.com/cb1', 'https://client.example.com/cb2'], 'jansRespTyp': ['token', 'code', 'id_token'], 'jansScope': ['inum=F0C4,ou=scopes,o=jans', 'inum=10B2,ou=scopes,o=jans', 'inum=764C,ou=scopes,o=jans', 'inum=43F1,ou=scopes,o=jans', 'inum=341A,ou=scopes,o=jans', 'inum=6D99,ou=scopes,o=jans'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['true'], 'objectClass': ['top', 'jansClnt']}
11:36:50 06/21/21 Querying LDAP for dn inum=AB77-1A2B,ou=clients,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=AB77-1A2B,ou=clients,o=jans entry:{'displayName': ["Jans Test Resource Server Client (don't remove)"], 'inum': ['AB77-1A2B'], 'jansAppTyp': ['web'], 'jansClaimRedirectURI': ['https://test.dd.jans.io/jans-auth/restv1/uma/gather_claims'], 'jansClntSecret': ['4xUI3+ElNiGCNA5ATS1PuA=='], 'jansGrantTyp': ['authorization_code', 'implicit', 'refresh_token', 'client_credentials'], 'jansIdTknSignedRespAlg': ['RS256'], 'jansRedirectURI': ['https://client.example.com/cb'], 'jansRespTyp': ['code', 'id_token'], 'jansScope': ['inum=6D99,ou=scopes,o=jans', 'inum=7D90,ou=scopes,o=jans'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['true'], 'objectClass': ['top', 'jansClnt']}
11:36:50 06/21/21 Querying LDAP for dn inum=3E20,ou=clients,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=3E20,ou=clients,o=jans entry:{'displayName': ["Jans Test Requesting Party Client (don't remove)"], 'inum': ['3E20'], 'jansAppTyp': ['web'], 'jansClntSecret': ['xMhV6v+OoDXsiu+EMgMguQ=='], 'jansGrantTyp': ['authorization_code', 'implicit', 'refresh_token', 'client_credentials'], 'jansIdTknSignedRespAlg': ['RS256'], 'jansRedirectURI': ['https://client.example.com/cb'], 'jansRespTyp': ['code', 'id_token'], 'jansTknEndpointAuthMethod': ['client_secret_basic'], 'jansTrustedClnt': ['true'], 'objectClass': ['top', 'jansClnt']}
11:36:50 06/21/21 Querying LDAP for dn inum=5214-40D1,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=5214-40D1,ou=scopes,o=jans entry:{'displayName': ['View'], 'inum': ['5214-40D1'], 'jansId': ['http://photoz.example.com/dev/scopes/view'], 'jansScopeTyp': ['uma'], 'jansUmaPolicyScrDn': ['inum=2DAF-F995,ou=scripts,o=@1736-179E-AA60-16B28F7C-B9AB,o=jans'], 'objectClass': ['jansScope', 'top']}
11:36:50 06/21/21 Querying LDAP for dn inum=B6EA-B301,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=B6EA-B301,ou=scopes,o=jans entry:{'displayName': ['Add/Edit'], 'inum': ['B6EA-B301'], 'jansId': ['modify'], 'jansScopeTyp': ['uma'], 'objectClass': ['jansScope', 'top']}
11:36:50 06/21/21 Querying LDAP for dn inum=03F8-EDD7,ou=scopes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=03F8-EDD7,ou=scopes,o=jans entry:{'displayName': ['All'], 'inum': ['03F8-EDD7'], 'jansId': ['http://photoz.example.com/dev/scopes/all'], 'jansScopeTyp': ['uma'], 'objectClass': ['jansScope', 'top']}
11:36:50 06/21/21 Querying LDAP for dn jansId=a55ede29-8f5a-461d-b06e-76caee8d40b5,ou=sector_identifiers,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=a55ede29-8f5a-461d-b06e-76caee8d40b5,ou=sector_identifiers,o=jans entry:{'jansId': ['a55ede29-8f5a-461d-b06e-76caee8d40b5'], 'jansRedirectURI': ['https://www.jans.org', 'http://localhost:80/jans-auth-rp/home.htm', 'https://localhost:8443/jans-auth-rp/home.htm', 'https://test.dd.jans.io/jans-auth-rp/home.htm', 'https://test.dd.jans.io/jans-auth-client/test/resources/jwks.json', 'https://client.example.org/callback', 'https://client.example.org/callback2', 'https://client.other_company.example.net/callback', 'https://client.example.com/cb', 'https://client.example.com/cb1', 'https://client.example.com/cb2'], 'objectClass': ['top', 'jansSectorIdentifier']}
11:36:50 06/21/21 Querying LDAP for dn jansId=840ef58d-a7d0-4986-af7b-71ed0089ce61,ou=sector_identifiers,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=840ef58d-a7d0-4986-af7b-71ed0089ce61,ou=sector_identifiers,o=jans entry:{'jansId': ['840ef58d-a7d0-4986-af7b-71ed0089ce61'], 'jansRedirectURI': ['https://example.com/bad_sector_identifier'], 'objectClass': ['top', 'jansSectorIdentifier']}
11:36:50 06/21/21 LDAP modify replace dn:inum=031C-5621,ou=scripts,o=jans entry:{'changetype': ['modify'], 'jansEnabled': ['true'], 'replace': ['jansEnabled']}
11:36:50 06/21/21 LDAP modify replace dn:inum=031C-5622,ou=scripts,o=jans entry:{'changetype': ['modify'], 'jansEnabled': ['true'], 'replace': ['jansEnabled']}
11:36:50 06/21/21 LDAP modify replace dn:ou=configuration,o=jans entry:{'changetype': ['modify'], 'jansAuthMode': ['basic'], 'replace': ['jansAuthMode']}
11:36:50 06/21/21 Importing entries from /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data.ldif
11:36:50 06/21/21 Querying LDAP for dn inum=ADA6,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=ADA6,ou=attributes,o=jans entry:{'description': ['Scim First custom attribute'], 'displayName': ['Scim Custom First'], 'inum': ['ADA6'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['scimCustomFirst'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['string'], 'jansMultivaluedAttr': ['false'], 'jansSAML1URI': ['urn:jans:dir:attribute-def:scimCustomFirst'], 'jansSAML2URI': ['urn:oid:scimCustomFirst'], 'jansAttrViewTyp': ['admin'], 'jansScimCustomAttr': ['true'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr']}
11:36:50 06/21/21 Querying LDAP for dn inum=70F0,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=70F0,ou=attributes,o=jans entry:{'description': ['Scim Second custom attribute'], 'displayName': ['Scim Custom Second'], 'inum': ['70F0'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['scimCustomSecond'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['generalizedTime'], 'jansMultivaluedAttr': ['true'], 'jansSAML1URI': ['urn:jans:dir:attribute-def:scimCustomSecond'], 'jansSAML2URI': ['urn:oid:scimCustomSecond'], 'jansAttrViewTyp': ['admin'], 'jansScimCustomAttr': ['true'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr']}
11:36:50 06/21/21 Querying LDAP for dn inum=653A,ou=attributes,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=653A,ou=attributes,o=jans entry:{'description': ['Scim Third custom attribute'], 'displayName': ['Scim Custom Third'], 'inum': ['653A'], 'jansAttrEditTyp': ['admin', 'user'], 'jansAttrName': ['scimCustomThird'], 'jansAttrOrigin': ['jansCustomPerson'], 'jansAttrTyp': ['numeric'], 'jansMultivaluedAttr': ['false'], 'jansSAML1URI': ['urn:jans:dir:attribute-def:scimCustomThird'], 'jansSAML2URI': ['urn:oid:scimCustomThird'], 'jansAttrViewTyp': ['admin'], 'jansScimCustomAttr': ['true'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansAttr']}
11:36:50 06/21/21 Importing entries from /opt/jans/jans-setup/output/test/jans-auth/data/oxauth-test-data-user.ldif
11:36:50 06/21/21 Querying LDAP for dn inum=7890,ou=groups,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=7890,ou=groups,o=jans entry:{'displayName': ['Jans Test Group 1'], 'inum': ['7890'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansGrp']}
11:36:50 06/21/21 Querying LDAP for dn inum=7891,ou=groups,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=7891,ou=groups,o=jans entry:{'displayName': ['Jans Test Group 2'], 'inum': ['7891'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansGrp']}
11:36:50 06/21/21 Querying LDAP for dn inum=B1F3-AEAE-B798,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=B1F3-AEAE-B798,ou=people,o=jans entry:{'birthdate': ['19830106010101.253Z'], 'c': ['US'], 'cn': ['Test User'], 'displayName': ['Jans Auth Test User'], 'emailVerified': ['true'], 'gender': ['Male'], 'givenName': ['Test'], 'inum': ['B1F3-AEAE-B798'], 'jansBackchannelDeviceRegistrationTkn': ['dv95B2zWvZBEGbcAf3byKO'], 'jansBackchannelUsrCode': ['59b335fb-a2df-4275-be43-1b8d3cc9a5c5'], 'jansPrefUsrName': ['user'], 'jansStatus': ['active'], 'l': ['Austin'], 'locale': ['en-US'], 'mail': ['test_user@test.org'], 'memberOf': ['inum=7890,ou=groups,o=jans', 'inum=7891,ou=groups,o=jans'], 'middleName': ['User'], 'mobile': ['(512) 516-2413'], 'nickname': ['user'], 'o': ['Test'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'phoneNumberVerified': ['true'], 'picture': ['http://www.jans.org/wp-content/uploads/2012/04/mike3.png'], 'preferredLanguage': ['en_US'], 'profile': ['http://www.mywebsite.com/profile'], 'sn': ['User'], 'st': ['Texas'], 'street': ['621 East 6th Street'], 'telephoneNumber': ['(512) 516-2413'], 'uid': ['test_user'], 'updatedAt': ['20170213135512.220Z'], 'userPassword': ['test_user_password'], 'website': ['http://www.jans.org'], 'zoneinfo': ['America/Chicago']}
11:36:50 06/21/21 Querying LDAP for dn inum=B1F3-AEAE-B799,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=B1F3-AEAE-B799,ou=people,o=jans entry:{'birthdate': ['19830106010101.253Z'], 'c': ['US'], 'cn': ['Test User2'], 'displayName': ['Jans Auth Test User2'], 'emailVerified': ['true'], 'gender': ['Male'], 'givenName': ['Test2'], 'inum': ['B1F3-AEAE-B799'], 'jansPrefUsrName': ['user2'], 'jansStatus': ['active'], 'l': ['Austin'], 'locale': ['en-US'], 'mail': ['test_user2@test.org'], 'memberOf': ['inum=7890,ou=groups,o=jans', 'inum=7891,ou=groups,o=jans'], 'middleName': ['User2'], 'mobile': ['(512) 516-2414'], 'nickname': ['user2'], 'o': ['Test'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'phoneNumberVerified': ['true'], 'picture': ['http://www.jans.org/wp-content/uploads/2012/04/mike3.png'], 'preferredLanguage': ['en_US'], 'profile': ['http://www.mywebsite.com/profile'], 'sn': ['User2'], 'st': ['Texas'], 'street': ['622 East 6th Street'], 'telephoneNumber': ['(512) 516-2414'], 'uid': ['test_user2'], 'updatedAt': ['20170213135512.220Z'], 'userPassword': ['test_user_password2'], 'website': ['http://www.jans.io'], 'zoneinfo': ['America/Chicago']}
11:36:50 06/21/21 LDAP modify add dn:inum=7890,ou=groups,o=jans entry:{'add': ['member'], 'changetype': ['modify'], 'member': ['inum=B1F3-AEAE-B798,ou=people,o=jans']}
11:36:50 06/21/21 LDAP modify add dn:inum=7891,ou=groups,o=jans entry:{'add': ['member'], 'changetype': ['modify'], 'member': ['inum=B1F3-AEAE-B798,ou=people,o=jans']}
11:36:50 06/21/21 Importing entries from /opt/jans/jans-setup/output/test/scim-client/data/scim-test-data-user.ldif
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.AAAA-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.AAAA-1111,ou=people,o=jans entry:{'birthdate': ['20140101000000Z'], 'displayName': ['Test Aaaa 1111'], 'jansEmail': ['{"value":"aaaa1111@test.email","type":"work","primary":false,"display":null}'], 'jansExtId': ['11000'], 'givenName': ['Aaaa 1111'], 'inum': ['XXXX.AAAA-1111'], 'jansStatus': ['active'], 'mail': ['aaaa1111@test.email'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['aaaa1111'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.AAAA-2222,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.AAAA-2222,ou=people,o=jans entry:{'birthdate': ['20140210000000Z'], 'displayName': ['Test Aaaa 2222'], 'jansAddres': ['{"type":"work","streetAddress":"621 East 6th Street Suite 200","locality":"Austin","region":"TX","postalCode":"78701","country":"US","formatted":"621 East 6th Street Suite 200  Austin, TX 78701 US","primary":false}'], 'jansPhotos': ['{"value":"http://some.gif/AAAA-2222_thumb.gif","display":"AAAA-2222 thumbnail","type":"thumbnail","primary":false}', '{"value":"http://some.gif/AAAA-2222.gif","display":"AAAA-2222","type":"photo","primary":true}'], 'jansExtId': ['12000'], 'givenName': ['Aaaa 2222'], 'inum': ['XXXX.AAAA-2222'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['aaaa2222'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.AAAA-3333,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.AAAA-3333,ou=people,o=jans entry:{'birthdate': ['20140307000000Z'], 'displayName': ['Test Aaaa 3333'], 'jansExtId': ['13000'], 'givenName': ['Aaaa 3333'], 'inum': ['XXXX.AAAA-3333'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['aaaa3333'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.AAAA-4444,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.AAAA-4444,ou=people,o=jans entry:{'birthdate': ['20140425000000Z'], 'displayName': ['Test Aaaa 4444'], 'jansExtId': ['14000'], 'givenName': ['Aaaa 4444'], 'inum': ['XXXX.AAAA-4444'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['aaaa4444'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.AAAA-5555,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.AAAA-5555,ou=people,o=jans entry:{'birthdate': ['20140518000000Z'], 'displayName': ['Test Aaaa 5555'], 'jansExtId': ['15000'], 'givenName': ['Aaaa 5555'], 'inum': ['XXXX.AAAA-5555'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['aaaa5555'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.BBBB-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.BBBB-1111,ou=people,o=jans entry:{'birthdate': ['20150108000000Z'], 'displayName': ['Test Bbbb 1111'], 'jansEmail': ['{"value":"bbbb1111@test.email","type":"home","primary":true,"display":null}'], 'jansExtId': ['21000'], 'givenName': ['Bbbb 1111'], 'inum': ['XXXX.BBBB-1111'], 'jansStatus': ['active'], 'mail': ['bbbb1111@test.email'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['bbbb1111'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.BBBB-2222,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.BBBB-2222,ou=people,o=jans entry:{'birthdate': ['20150214000000Z'], 'displayName': ['Test Bbbb 2222'], 'jansAddres': ['{"type":"home","streetAddress":"621 East 6th Street Suite 200","locality":"Austin","region":"TX","postalCode":"78701","country":"US","formatted":"621 East 6th Street Suite 200  Austin, TX 78701 US","primary":true}'], 'jansExtId': ['22000'], 'givenName': ['Bbbb 2222'], 'inum': ['XXXX.BBBB-2222'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['bbbb2222'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.BBBB-3333,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.BBBB-3333,ou=people,o=jans entry:{'birthdate': ['20150321000000Z'], 'displayName': ['Test Bbbb 3333'], 'jansExtId': ['23000'], 'givenName': ['Bbbb 3333'], 'inum': ['XXXX.BBBB-3333'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['bbbb3333'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.BBBB-4444,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.BBBB-4444,ou=people,o=jans entry:{'birthdate': ['20150420000000Z'], 'displayName': ['Test Bbbb 4444'], 'jansExtId': ['24000'], 'givenName': ['Bbbb 4444'], 'inum': ['XXXX.BBBB-4444'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['bbbb4444'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.BBBB-5555,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.BBBB-5555,ou=people,o=jans entry:{'birthdate': ['20150530000000Z'], 'displayName': ['Test Bbbb 5555'], 'jansExtId': ['25000'], 'givenName': ['Bbbb 5555'], 'inum': ['XXXX.BBBB-5555'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['bbbb5555'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.CCCC-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.CCCC-1111,ou=people,o=jans entry:{'birthdate': ['20160125000000Z'], 'displayName': ['Test Cccc 1111'], 'jansEmail': ['{"value":"cccc1111@test.email","type":"work","primary":true,"display":null}'], 'jansExtId': ['31000'], 'givenName': ['Cccc 1111'], 'inum': ['XXXX.CCCC-1111'], 'jansStatus': ['active'], 'mail': ['cccc1111@test.email'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['cccc1111'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.CCCC-2222,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.CCCC-2222,ou=people,o=jans entry:{'birthdate': ['20160119000000Z'], 'displayName': ['Test Cccc 2222'], 'jansAddres': ['{"type":"work","streetAddress":"621 East 6th Street Suite 200","locality":"Austin","region":"TX","postalCode":"78701","country":"US","formatted":"621 East 6th Street Suite 200  Austin, TX 78701 US","primary":true}'], 'jansExtId': ['32000'], 'givenName': ['Cccc 2222'], 'inum': ['XXXX.CCCC-2222'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['cccc2222'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.CCCC-3333,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.CCCC-3333,ou=people,o=jans entry:{'birthdate': ['20160229194603Z'], 'displayName': ['Test Cccc 3333'], 'jansExtId': ['33000'], 'givenName': ['Cccc 3333'], 'inum': ['XXXX.CCCC-3333'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['cccc3333'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.CCCC-4444,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.CCCC-4444,ou=people,o=jans entry:{'birthdate': ['20160315000000Z'], 'displayName': ['Test Cccc 4444'], 'jansExtId': ['34000'], 'givenName': ['Cccc 4444'], 'inum': ['XXXX.CCCC-4444'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['cccc4444'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.CCCC-5555,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.CCCC-5555,ou=people,o=jans entry:{'birthdate': ['20160413000000Z'], 'displayName': ['Test Cccc 5555'], 'jansExtId': ['35000'], 'givenName': ['Cccc 5555'], 'inum': ['XXXX.CCCC-5555'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['cccc5555'], 'userPassword': ['{SSHA}NuYCT1iY8F6GMogft08qWxitT5Pm5wjM']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.DDDD-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.DDDD-1111,ou=people,o=jans entry:{'displayName': ['Test Dddd 1111'], 'givenName': ['Dddd 1111'], 'inum': ['XXXX.DDDD-1111'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['dddd1111 *char']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.DDDD-2222,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.DDDD-2222,ou=people,o=jans entry:{'displayName': ['Test Dddd 2222'], 'givenName': ['Dddd 2222'], 'inum': ['XXXX.DDDD-2222'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['dddd2222 * \\ (char']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.DDDD-3333,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.DDDD-3333,ou=people,o=jans entry:{'displayName': ['Test Dddd 3333'], 'givenName': ['Dddd 3333'], 'inum': ['XXXX.DDDD-3333'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['dddd3333 * \\ (char) /']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.DDDD-4444,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.DDDD-4444,ou=people,o=jans entry:{'displayName': ['Test Dddd 4444'], 'givenName': ['(special chars\\)/*'], 'inum': ['XXXX.DDDD-4444'], 'jansStatus': ['active'], 'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'sn': ['FilterTest'], 'uid': ['dddd4444']}
11:36:50 06/21/21 Querying LDAP for dn inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['top', 'jansCustomPerson', 'jansPerson'], 'inum': ['XXXX.EEEE-1111'], 'uid': ['eeee1111'], 'jansStatus': ['active']}
11:36:50 06/21/21 Querying LDAP for dn ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['organizationalUnit', 'top'], 'ou': ['fido']}
11:36:50 06/21/21 Querying LDAP for dn jansId=1613218892033,ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=1613218892033,ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['top', 'jansDeviceRegistration'], 'creationDate': ['20210213122132.032Z'], 'del': ['false'], 'displayName': ['My U2F key'], 'jansApp': ['https://buster.gluu.info'], 'jansCounter': ['-1'], 'jansDeviceHashCode': ['31818'], 'jansDeviceKeyHandle': ['3kyqUkMx45FVmz3uZiCdMzUeOG-KhTcOaqSPmupG88fs-E2WKy8C3TCb9FpiLFVh16vZLSQUOWPnfkd2xmG5-Q'], 'jansDeviceRegistrationConf': ['{"publicKey":"BIcxc2bak_hrpV7faS0qBGeOnpNU9kSA25Uf1EBXKaaAIJju5C8a1Y6-61StKpG0LYhfnnVt4DqZdJB-AFwTBZs","attestationCert":"MIICSjCCATKgAwIBAgIEEkpy_jANBgkqhkiG9w0BAQsFADAuMSwwKgYDVQQDEyNZdWJpY28gVTJGIFJvb3QgQ0EgU2VyaWFsIDQ1NzIwMDYzMTAgFw0xNDA4MDEwMDAwMDBaGA8yMDUwMDkwNDAwMDAwMFowLDEqMCgGA1UEAwwhWXViaWNvIFUyRiBFRSBTZXJpYWwgMjQ5NDE0OTcyMTU4MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPYsbvS_L9ghuEHRxYBRoSEFTwcbTtLaKXoVebkB1fuIrzYmIvzvv183yHLC_XXoVDYRK_pgQPGxmB9n6rih8AqM7MDkwIgYJKwYBBAGCxAoCBBUxLjMuNi4xLjQuMS40MTQ4Mi4xLjEwEwYLKwYBBAGC5RwCAQEEBAMCBSAwDQYJKoZIhvcNAQELBQADggEBAKFPHuoAdva4R2oQor5y5g0CcbtGWy37_Hwb0S01GYmRcDJjHXldCX-jCiajJWNOhXIbwtAahjA_a8B15ZlzGeEiFIsElu7I0fT5TPQRDeYmwolEPR8PW7sjnKE-gdHVqp31r442EmR1v8I68GKDFXJSdi_2iHm88O9XjVXWf5UbTzK2PIrqWw-Zxn19gUp_9ab1Lfg-iUo6XZyLguf4vI2vTIAXX_iXL9p5Mz7EZdgG6syUjxurIgRalVWKSMICJtrAA9QfvJ4F6iimu14QpJ3gYKCk9qJnajTWjEq-jGGHQ1W5An6CjKngZLAC1i6NjPB0SSF1PTXjyHxdV3lFPnc"}'], 'jansId': ['1613218892033'], 'jansStatus': ['active'], 'personInum': ['XXXX.EEEE-1111']}
11:36:50 06/21/21 Querying LDAP for dn jansId=7613218892033,ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=7613218892033,ou=fido,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['top', 'jansDeviceRegistration'], 'creationDate': ['20210213122132.032Z'], 'del': ['false'], 'jansApp': ['https://buster.gluu.info'], 'jansCounter': ['-1'], 'jansDeviceHashCode': ['31818'], 'jansDeviceKeyHandle': ['3kyqUkMx45FVmz3uZiCdMzUeOG-KhTcOaqSPmupG88fs-E2WKy8C3TCb9FpiLFVh16vZLSQUOWPnfkd2xmG5-Q'], 'jansDeviceRegistrationConf': ['{"publicKey":"BIcxc2bak_hrpV7faS0qBGeOnpNU9kSA25Uf1EBXKaaAIJju5C8a1Y6-61StKpG0LYhfnnVt4DqZdJB-AFwTBZs","attestationCert":"MIICSjCCATKgAwIBAgIEEkpy_jANBgkqhkiG9w0BAQsFADAuMSwwKgYDVQQDEyNZdWJpY28gVTJGIFJvb3QgQ0EgU2VyaWFsIDQ1NzIwMDYzMTAgFw0xNDA4MDEwMDAwMDBaGA8yMDUwMDkwNDAwMDAwMFowLDEqMCgGA1UEAwwhWXViaWNvIFUyRiBFRSBTZXJpYWwgMjQ5NDE0OTcyMTU4MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPYsbvS_L9ghuEHRxYBRoSEFTwcbTtLaKXoVebkB1fuIrzYmIvzvv183yHLC_XXoVDYRK_pgQPGxmB9n6rih8AqM7MDkwIgYJKwYBBAGCxAoCBBUxLjMuNi4xLjQuMS40MTQ4Mi4xLjEwEwYLKwYBBAGC5RwCAQEEBAMCBSAwDQYJKoZIhvcNAQELBQADggEBAKFPHuoAdva4R2oQor5y5g0CcbtGWy37_Hwb0S01GYmRcDJjHXldCX-jCiajJWNOhXIbwtAahjA_a8B15ZlzGeEiFIsElu7I0fT5TPQRDeYmwolEPR8PW7sjnKE-gdHVqp31r442EmR1v8I68GKDFXJSdi_2iHm88O9XjVXWf5UbTzK2PIrqWw-Zxn19gUp_9ab1Lfg-iUo6XZyLguf4vI2vTIAXX_iXL9p5Mz7EZdgG6syUjxurIgRalVWKSMICJtrAA9QfvJ4F6iimu14QpJ3gYKCk9qJnajTWjEq-jGGHQ1W5An6CjKngZLAC1i6NjPB0SSF1PTXjyHxdV3lFPnc"}'], 'jansId': ['7613218892033'], 'jansStatus': ['active'], 'personInum': ['XXXX.EEEE-1111'], 'jansDeviceData': ['{"uuid":"12748db61-754f-3481-b2e5-5dc968deba6b","type":"normal","platform":"android","name":"iSM-J110M","os_name":"lollipop_mr1","os_version":"-5.1.1","custom_data":null,"push_token":null}']}
11:36:50 06/21/21 Querying LDAP for dn ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['organizationalUnit', 'top'], 'ou': ['fido2_register']}
11:36:50 06/21/21 Querying LDAP for dn jansId=61a53f4c-07d3-4d3e-84f0-488cdeef5fd2,ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=61a53f4c-07d3-4d3e-84f0-488cdeef5fd2,ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['top', 'jansFido2RegistrationEntry'], 'creationDate': ['20210213122333.811Z'], 'displayName': ['Black Fido2 key'], 'jansCodeChallenge': ['6PVFB1E_xkZJJoIJU2wB4ClOOjHQdwmWvpJSU1VFQLA'], 'jansCodeChallengeHash': ['76069'], 'jansCounter': ['0'], 'jansId': ['61a53f4c-07d3-4d3e-84f0-488cdeef5fd2'], 'jansPublicKeyId': ['Ohf3r7UJ8kKOSqV-GVNjToOIoDLz1izDrnPFlB9P1UlXp_zdCpLrvh6aa7ngZV6bywmEJ42kCk06zo0nfeCcMQ'], 'jansRegistrationData': ['{"createdDate":1613219013811,"updatedDate":1613219022408,"createdBy":"test","updatedBy":"test","username":"test","domain":"buster.gluu.info","userId":"XWt4NghuevFiawUdwMJnlOdkaCksuWhX25h1MANMFZM","challenge":"6PVFB1E_xkZJJoIJU2wB4ClOOjHQdwmWvpJSU1VFQLA","attenstationRequest":"{\\"attestation\\":\\"direct\\",\\"displayName\\":\\"test\\",\\"username\\":\\"test\\"}","attenstationResponse":"{\\"type\\":\\"public-key\\",\\"id\\":\\"Ohf3r7UJ8kKOSqV-GVNjToOIoDLz1izDrnPFlB9P1UlXp_zdCpLrvh6aa7ngZV6bywmEJ42kCk06zo0nfeCcMQ\\",\\"response\\":{\\"attestationObject\\":\\"o2NmbXRmcGFja2VkZ2F0dFN0bXSjY2FsZyZjc2lnWEgwRgIhAL7tjJTwzki4ZK3zxYIEab1MMpOjRaRG3-D3Wb_JSwLfAiEA7wsdZJKB30WELzjlTwCejPLv8FD4rVKBtZGUUz3fvk5jeDVjgVkCwTCCAr0wggGloAMCAQICBBisRsAwDQYJKoZIhvcNAQELBQAwLjEsMCoGA1UEAxMjWXViaWNvIFUyRiBSb290IENBIFNlcmlhbCA0NTcyMDA2MzEwIBcNMTQwODAxMDAwMDAwWhgPMjA1MDA5MDQwMDAwMDBaMG4xCzAJBgNVBAYTAlNFMRIwEAYDVQQKDAlZdWJpY28gQUIxIjAgBgNVBAsMGUF1dGhlbnRpY2F0b3IgQXR0ZXN0YXRpb24xJzAlBgNVBAMMHll1YmljbyBVMkYgRUUgU2VyaWFsIDQxMzk0MzQ4ODBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABHnqOyx8SXAQYiMM0j_rYOUpMXHUg_EAvoWdaw-DlwMBtUbN1G7PyuPj8w-B6e1ivSaNTB69N7O8vpKowq7rTjqjbDBqMCIGCSsGAQQBgsQKAgQVMS4zLjYuMS40LjEuNDE0ODIuMS43MBMGCysGAQQBguUcAgEBBAQDAgUgMCEGCysGAQQBguUcAQEEBBIEEMtpSB6P90A5k-wKJymhVKgwDAYDVR0TAQH_BAIwADANBgkqhkiG9w0BAQsFAAOCAQEAl50Dl9hg-C7hXTEceW66-yL6p-CE2bq0xhu7V_PmtMGKSDe4XDxO2-SDQ_TWpdmxztqK4f7UkSkhcwWOXuHL3WvawHVXxqDo02gluhWef7WtjNr4BIaM-Q6PH4rqF8AWtVwqetSXyJT7cddT15uaSEtsN21yO5mNLh1DBr8QM7Wu-Myly7JWi2kkIm0io1irfYfkrF8uCRqnFXnzpWkJSX1y9U4GusHDtEE7ul6vlMO2TzT566Qay2rig3dtNkZTeEj-6IS93fWxuleYVM_9zrrDRAWVJ-Vt1Zj49WZxWr5DAd0ZETDmufDGQDkSU-IpgD867ydL7b_eP8u9QurWeWhhdXRoRGF0YVjEHOj4_PrcJxw8Yk9maRxLYDamAqtUDLg96h2pK39v2ClBAAAARctpSB6P90A5k-wKJymhVKgAQDoX96-1CfJCjkqlfhlTY06DiKAy89Ysw65zxZQfT9VJV6f83QqS674emmu54GVem8sJhCeNpApNOs6NJ33gnDGlAQIDJiABIVggYbZ9FhWsyfBF6dPo7dJFWG27MbX_wWf1DBoKl0YupMkiWCCnG0g4QhZpzKMuYfK5No_00xqXmsmwtIcjt8-wN4yo4g\\",\\"clientDataJSON\\":\\"eyJjaGFsbGVuZ2UiOiI2UFZGQjFFX3hrWkpKb0lKVTJ3QjRDbE9PakhRZHdtV3ZwSlNVMVZGUUxBIiwiZXh0cmFfa2V5c19tYXlfYmVfYWRkZWRfaGVyZSI6ImRvIG5vdCBjb21wYXJlIGNsaWVudERhdGFKU09OIGFnYWluc3QgYSB0ZW1wbGF0ZS4gU2VlIGh0dHBzOi8vZ29vLmdsL3lhYlBleCIsIm9yaWdpbiI6Imh0dHBzOi8vYnVzdGVyLmdsdXUuaW5mbyIsInR5cGUiOiJ3ZWJhdXRobi5jcmVhdGUifQ\\"},\\"clientExtensionResults\\":{}}","uncompressedECPoint":"pQECAyYgASFYIGG2fRYVrMnwRenT6O3SRVhtuzG1_8Fn9QwaCpdGLqTJIlggpxtIOEIWacyjLmHyuTaP9NMal5rJsLSHI7fPsDeMqOI","publicKeyId":"Ohf3r7UJ8kKOSqV-GVNjToOIoDLz1izDrnPFlB9P1UlXp_zdCpLrvh6aa7ngZV6bywmEJ42kCk06zo0nfeCcMQ","type":"public-key","status":"registered","counter":0,"attestationType":"packed","signatureAlgorithm":-7,"applicationId":null}'], 'jansStatus': ['registered'], 'personInum': ['XXXX.EEEE-1111']}
11:36:50 06/21/21 Querying LDAP for dn jansId=0a3236fe-ec36-4308-80dc-9bf6319d780c,ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans
11:36:50 06/21/21 Adding LDAP dn:jansId=0a3236fe-ec36-4308-80dc-9bf6319d780c,ou=fido2_register,inum=XXXX.EEEE-1111,ou=people,o=jans entry:{'objectClass': ['top', 'jansFido2RegistrationEntry'], 'creationDate': ['20210213122402.477Z'], 'displayName': ['Blue Fido2 key'], 'jansCodeChallenge': ['mXhvHlh0_udGlTyHkoVXJoLmxlD7iSxHe73_sCY4Fr8'], 'jansCodeChallengeHash': ['77976'], 'jansCounter': ['0'], 'jansId': ['0a3236fe-ec36-4308-80dc-9bf6319d780c'], 'jansPublicKeyId': ['1ASsUz7Y5TIMJsy7NQ2h3qW4iyDj00W-GcpOpGOZXLpHgXx95nDjkwWqY9hJdmMqM1cTqtWA6REI8cL1af-Z4Q'], 'jansRegistrationData': ['{"createdDate":1613219042477,"updatedDate":1613219046555,"createdBy":"test","updatedBy":"test","username":"test","domain":"buster.gluu.info","userId":"KwZK_GDZMdCiPVfCuQjbCmp_ZVzDYinTRiTevsGrtZ4","challenge":"mXhvHlh0_udGlTyHkoVXJoLmxlD7iSxHe73_sCY4Fr8","attenstationRequest":"{\\"attestation\\":\\"direct\\",\\"displayName\\":\\"test\\",\\"username\\":\\"test\\"}","attenstationResponse":"{\\"type\\":\\"public-key\\",\\"id\\":\\"1ASsUz7Y5TIMJsy7NQ2h3qW4iyDj00W-GcpOpGOZXLpHgXx95nDjkwWqY9hJdmMqM1cTqtWA6REI8cL1af-Z4Q\\",\\"response\\":{\\"attestationObject\\":\\"o2NmbXRoZmlkby11MmZnYXR0U3RtdKJjc2lnWEgwRgIhALcCBL52gCn1C-1LiGrYM9hH2ixHI51bF5Bc606g3-PHAiEAoHdR5aFJ8LTUwOCRJmMW52NS4Z5vn8wfX-YHBR3eVc5jeDVjgVkCTjCCAkowggEyoAMCAQICBBJKcv4wDQYJKoZIhvcNAQELBQAwLjEsMCoGA1UEAxMjWXViaWNvIFUyRiBSb290IENBIFNlcmlhbCA0NTcyMDA2MzEwIBcNMTQwODAxMDAwMDAwWhgPMjA1MDA5MDQwMDAwMDBaMCwxKjAoBgNVBAMMIVl1YmljbyBVMkYgRUUgU2VyaWFsIDI0OTQxNDk3MjE1ODBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABD2LG70vy_YIbhB0cWAUaEhBU8HG07S2il6FXm5AdX7iK82JiL8779fN8hywv116FQ2ESv6YEDxsZgfZ-q4ofAKjOzA5MCIGCSsGAQQBgsQKAgQVMS4zLjYuMS40LjEuNDE0ODIuMS4xMBMGCysGAQQBguUcAgEBBAQDAgUgMA0GCSqGSIb3DQEBCwUAA4IBAQChTx7qAHb2uEdqEKK-cuYNAnG7Rlst-_x8G9EtNRmJkXAyYx15XQl_owomoyVjToVyG8LQGoYwP2vAdeWZcxnhIhSLBJbuyNH0-Uz0EQ3mJsKJRD0fD1u7I5yhPoHR1aqd9a-ONhJkdb_COvBigxVyUnYv9oh5vPDvV41V1n-VG08ytjyK6lsPmcZ9fYFKf_Wm9S34PolKOl2ci4Ln-LyNr0yAF1_4ly_aeTM-xGXYBurMlI8bqyIEWpVVikjCAibawAPUH7yeBeooprteEKSd4GCgpPaiZ2o01oxKvoxhh0NVuQJ-goyp4GSwAtYujYzwdEkhdT0148h8XVd5RT53aGF1dGhEYXRhWMQc6Pj8-twnHDxiT2ZpHEtgNqYCq1QMuD3qHakrf2_YKUEAAAAAAAAAAAAAAAAAAAAAAAAAAABA1ASsUz7Y5TIMJsy7NQ2h3qW4iyDj00W-GcpOpGOZXLpHgXx95nDjkwWqY9hJdmMqM1cTqtWA6REI8cL1af-Z4aUBAgMmIAEhWCBletrDQ8HIc6TAvpbaEvMHyxD9E5UHpPIC4_4WhKRkXCJYIAI8_FFWqvXfKXmsNWYryGEiAs5TKXZphEO9pZT3R3u2\\",\\"clientDataJSON\\":\\"eyJjaGFsbGVuZ2UiOiJtWGh2SGxoMF91ZEdsVHlIa29WWEpvTG14bEQ3aVN4SGU3M19zQ1k0RnI4Iiwib3JpZ2luIjoiaHR0cHM6Ly9idXN0ZXIuZ2x1dS5pbmZvIiwidHlwZSI6IndlYmF1dGhuLmNyZWF0ZSJ9\\"},\\"clientExtensionResults\\":{}}","uncompressedECPoint":"pQECAyYgASFYIGV62sNDwchzpMC-ltoS8wfLEP0TlQek8gLj_haEpGRcIlggAjz8UVaq9d8peaw1ZivIYSICzlMpdmmEQ72llPdHe7Y","publicKeyId":"1ASsUz7Y5TIMJsy7NQ2h3qW4iyDj00W-GcpOpGOZXLpHgXx95nDjkwWqY9hJdmMqM1cTqtWA6REI8cL1af-Z4Q","type":"public-key","status":"registered","counter":0,"attestationType":"fido-u2f","signatureAlgorithm":-7,"applicationId":null}'], 'jansStatus': ['registered'], 'personInum': ['XXXX.EEEE-1111']}
11:36:50 06/21/21 Downloading https://raw.githubusercontent.com/JanssenProject/jans-auth-server/master/client/src/test/resources/jans_test_client_keys.zip to /var/www/html/jans_test_client_keys.zip
11:36:51 06/21/21 Download size: 9043 bytes
11:36:51 06/21/21 Running: /usr/bin/unzip -o /var/www/html/jans_test_client_keys.zip -d /var/www/html/
11:36:51 06/21/21 Archive:  /var/www/html/jans_test_client_keys.zip
  inflating: /var/www/html/jans-auth-client/test/resources/jwks.json  

11:36:51 06/21/21 Running: /bin/rm -rf jans_test_client_keys.zip
11:36:51 06/21/21 Running: /bin/chown -R root:www-data /var/www/html/jans-auth-client
11:36:51 06/21/21 Copying file /opt/jans/jans-setup/output/test/jans-auth/schema/102-oxauth_test.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Copied /opt/jans/jans-setup/output/test/jans-auth/schema/102-oxauth_test.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Copying file /opt/jans/jans-setup/output/test/scim-client/schema/103-scim_test.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Copied /opt/jans/jans-setup/output/test/scim-client/schema/103-scim_test.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Running: cp -f /opt/opendj/config/schema/77-customAttributes.ldif /opt/opendj/config/schema/77-customAttributes.ldif.jans-1.0.0-1~
11:36:51 06/21/21 Copying file /tmp/77-customAttributes.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Copied /tmp/77-customAttributes.ldif to /opt/opendj/config/schema/
11:36:51 06/21/21 Making opndj listen all interfaces
11:36:51 06/21/21 Re-starting opendj
11:36:51 06/21/21 Running: /usr/bin/systemctl stop opendj
11:36:56 06/21/21 Run: /usr/bin/systemctl stop opendj with result code: 0
11:36:56 06/21/21 Running: /usr/bin/systemctl start opendj
11:37:02 06/21/21 Run: /usr/bin/systemctl start opendj with result code: 0
11:37:02 06/21/21 Re-binding opendj
11:37:07 06/21/21 Try binding 1 ...
11:37:07 06/21/21 Binding to opendj was successful
11:37:07 06/21/21 Creating Index ds-cfg-attribute=myCustomAttr1,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:37:07 06/21/21 Creating Index ds-cfg-attribute=myCustomAttr2,cn=Index,ds-cfg-backend-id=userRoot,cn=Backends,cn=config
11:37:07 06/21/21 Searching database for dn ou=configuration,o=jans with filter (&(jansDbAuth=*)(objectClass=jansAppConf))
11:37:07 06/21/21 Creating client_keystore.jks
11:37:07 06/21/21 Running: /opt/jre/bin/keytool -genkey -alias dummy -keystore /opt/jans/jans-setup/output/test/jans-auth/client/client_keystore.jks -storepass secret -keypass secret -dname 'CN=Jans Auth CA Certificates'
11:37:08 06/21/21 Running: /opt/jre/bin/java -Dlog4j.defaultInitOverride=true -cp /opt/dist/jans/jans-auth-client-jar-with-dependencies.jar io.jans.as.client.util.KeyGenerator -keystore /opt/jans/jans-setup/output/test/jans-auth/client/client_keystore.jks -keypasswd secret -sig_keys RS256 RS384 RS512 ES256 ES384 ES512 -enc_keys RS256 RS384 RS512 ES256 ES384 ES512 -dnname 'CN=Jans Auth CA Certificates' -expiration 365 > /opt/jans/jans-setup/output/test/jans-auth/client/keys_client_keystore.json
11:37:11 06/21/21 Copying file /opt/jans/jans-setup/output/test/jans-auth/client/client_keystore.jks to /opt/jans/jans-setup/output/test/jans-auth/server
11:37:11 06/21/21 Copied /opt/jans/jans-setup/output/test/jans-auth/client/client_keystore.jks to /opt/jans/jans-setup/output/test/jans-auth/server
11:37:11 06/21/21 Copying file /opt/jans/jans-setup/output/test/jans-auth/client/keys_client_keystore.json to /opt/jans/jans-setup/output/test/jans-auth/server
11:37:11 06/21/21 Copied /opt/jans/jans-setup/output/test/jans-auth/client/keys_client_keystore.json to /opt/jans/jans-setup/output/test/jans-auth/server
11:37:11 06/21/21 Running: a2dismod mod_token_binding
11:37:11 06/21/21 Running: /usr/bin/systemctl stop apache2
11:37:12 06/21/21 Run: /usr/bin/systemctl stop apache2 with result code: 0
11:37:12 06/21/21 Running: /usr/bin/systemctl start apache2
11:37:12 06/21/21 Run: /usr/bin/systemctl start apache2 with result code: 0
11:37:12 06/21/21 Running: /usr/bin/systemctl stop jans-auth
11:37:13 06/21/21 Run: /usr/bin/systemctl stop jans-auth with result code: 0
11:37:13 06/21/21 Running: /usr/bin/systemctl start jans-auth
11:37:25 06/21/21 Run: /usr/bin/systemctl start jans-auth with result code: 0
11:37:25 06/21/21 Running: /usr/bin/tar -zxf /opt/jans/jans-setup/static/eleven/jans-eleven-tokens.tar.gz -C /var/lib/softhsm/tokens/
11:37:25 06/21/21 Running: /usr/bin/systemctl stop jans-scim
11:37:26 06/21/21 Run: /usr/bin/systemctl stop jans-scim with result code: 0
11:37:26 06/21/21 Running: /usr/bin/systemctl start jans-scim
11:37:38 06/21/21 Run: /usr/bin/systemctl start jans-scim with result code: 0
11:37:38 06/21/21 Running: /usr/bin/systemctl stop jans-fido2
11:37:39 06/21/21 Run: /usr/bin/systemctl stop jans-fido2 with result code: 0
11:37:39 06/21/21 Running: /usr/bin/systemctl start jans-fido2
11:37:51 06/21/21 Run: /usr/bin/systemctl start jans-fido2 with result code: 0
11:37:51 06/21/21 Running: /usr/bin/systemctl stop jans-config-api
11:37:51 06/21/21 Run: /usr/bin/systemctl stop jans-config-api with result code: 0
11:37:51 06/21/21 Running: /usr/bin/systemctl start jans-config-api
11:37:51 06/21/21 Run: /usr/bin/systemctl start jans-config-api with result code: 0
11:37:51 06/21/21 Running: /usr/bin/systemctl stop jans-eleven
11:37:52 06/21/21 Run: /usr/bin/systemctl stop jans-eleven with result code: 0
11:37:52 06/21/21 Running: /usr/bin/systemctl start jans-eleven
11:38:00 06/21/21 Run: /usr/bin/systemctl start jans-eleven with result code: 0
